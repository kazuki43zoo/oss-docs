<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>15.&nbsp;Appendix</title><link rel="stylesheet" type="text/css" href="css/manual-multipage.css"><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><link rel="home" href="index.html" title="Spring Security Reference"><link rel="up" href="servlet-applications.html" title="Part&nbsp;II.&nbsp;Servlet Applications"><link rel="prev" href="data.html" title="14.&nbsp;Spring Data Integration"><link rel="next" href="reactive-applications.html" title="Part&nbsp;III.&nbsp;Reactive Applications"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">15.&nbsp;Appendix</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="data.html">Prev</a>&nbsp;</td><th width="60%" align="center">Part&nbsp;II.&nbsp;Servlet Applications</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="reactive-applications.html">Next</a></td></tr></table><hr></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a name="appendix" href="#appendix"></a>15.&nbsp;Appendix</h2></div></div></div>

<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="appendix-schema" href="#appendix-schema"></a>15.1&nbsp;Security Database Schema</h2></div></div></div>

<p>There are various database schema used by the framework and this appendix provides a single reference point to them all.
You only need to provide the tables for the areas of functionality you require.</p>
<p>DDL statements are given for the HSQLDB database.
You can use these as a guideline for defining the schema for the database you are using.</p>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="user-schema" href="#user-schema"></a>15.1.1&nbsp;User Schema</h3></div></div></div>

<p>The standard JDBC implementation of the <code class="literal">UserDetailsService</code> (<code class="literal">JdbcDaoImpl</code>) requires tables to load the password, account status (enabled or disabled) and a list of authorities (roles) for the user.
You will need to adjust this schema to match the database dialect you are using.</p>
<pre class="screen">create table users(
    username varchar_ignorecase(50) not null primary key,
    password varchar_ignorecase(50) not null,
    enabled boolean not null
);

create table authorities (
    username varchar_ignorecase(50) not null,
    authority varchar_ignorecase(50) not null,
    constraint fk_authorities_users foreign key(username) references users(username)
);
create unique index ix_auth_username on authorities (username,authority);</pre>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="for-oracle-database" href="#for-oracle-database"></a>For Oracle database</h4></div></div></div>

<pre class="screen">CREATE TABLE USERS (
    USERNAME NVARCHAR2(128) PRIMARY KEY,
    PASSWORD NVARCHAR2(128) NOT NULL,
    ENABLED CHAR(1) CHECK (ENABLED IN ('Y','N') ) NOT NULL
);


CREATE TABLE AUTHORITIES (
    USERNAME NVARCHAR2(128) NOT NULL,
    AUTHORITY NVARCHAR2(128) NOT NULL
);
ALTER TABLE AUTHORITIES ADD CONSTRAINT AUTHORITIES_UNIQUE UNIQUE (USERNAME, AUTHORITY);
ALTER TABLE AUTHORITIES ADD CONSTRAINT AUTHORITIES_FK1 FOREIGN KEY (USERNAME) REFERENCES USERS (USERNAME) ENABLE;</pre>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="group-authorities" href="#group-authorities"></a>Group Authorities</h4></div></div></div>

<p>Spring Security 2.0 introduced support for group authorities in <code class="literal">JdbcDaoImpl</code>.
The table structure if groups are enabled is as follows.
You will need to adjust this schema to match the database dialect you are using.</p>
<pre class="screen">create table groups (
    id bigint generated by default as identity(start with 0) primary key,
    group_name varchar_ignorecase(50) not null
);

create table group_authorities (
    group_id bigint not null,
    authority varchar(50) not null,
    constraint fk_group_authorities_group foreign key(group_id) references groups(id)
);

create table group_members (
    id bigint generated by default as identity(start with 0) primary key,
    username varchar(50) not null,
    group_id bigint not null,
    constraint fk_group_members_group foreign key(group_id) references groups(id)
);</pre>
<p>Remember that these tables are only required if you are using the provided JDBC <code class="literal">UserDetailsService</code> implementation.
If you write your own or choose to implement <code class="literal">AuthenticationProvider</code> without a <code class="literal">UserDetailsService</code>, then you have complete freedom over how you store the data, as long as the interface contract is satisfied.</p>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="persistent-login-remember-me-schema" href="#persistent-login-remember-me-schema"></a>15.1.2&nbsp;Persistent Login (Remember-Me) Schema</h3></div></div></div>

<p>This table is used to store data used by the more secure <a class="link" href="web-app-security.html#remember-me-persistent-token" title="10.5.3&nbsp;Persistent Token Approach">persistent token</a> remember-me implementation.
If you are using <code class="literal">JdbcTokenRepositoryImpl</code> either directly or through the namespace, then you will need this table.
Remember to adjust this schema to match the database dialect you are using.</p>
<pre class="screen">create table persistent_logins (
    username varchar(64) not null,
    series varchar(64) primary key,
    token varchar(64) not null,
    last_used timestamp not null
);</pre>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="dbschema-acl" href="#dbschema-acl"></a>15.1.3&nbsp;ACL Schema</h3></div></div></div>

<p>There are four tables used by the Spring Security <a class="link" href="advanced-topics.html#domain-acls" title="12.1&nbsp;Domain Object Security (ACLs)">ACL</a> implementation.</p>
<div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
<code class="literal">acl_sid</code> stores the security identities recognised by the ACL system.
These can be unique principals or authorities which may apply to multiple principals.
</li><li class="listitem">
<code class="literal">acl_class</code> defines the domain object types to which ACLs apply.
The <code class="literal">class</code> column stores the Java class name of the object.
</li><li class="listitem">
<code class="literal">acl_object_identity</code> stores the object identity definitions of specific domain objects.
</li><li class="listitem">
<code class="literal">acl_entry</code> stores the ACL permissions which apply to a specific object identity and security identity.
</li></ol></div>
<p>It is assumed that the database will auto-generate the primary keys for each of the identities.
The <code class="literal">JdbcMutableAclService</code> has to be able to retrieve these when it has created a new row in the <code class="literal">acl_sid</code> or <code class="literal">acl_class</code> tables.
It has two properties which define the SQL needed to retrieve these values <code class="literal">classIdentityQuery</code> and <code class="literal">sidIdentityQuery</code>.
Both of these default to <code class="literal">call identity()</code></p>
<p>The ACL artifact JAR contains files for creating the ACL schema in HyperSQL (HSQLDB), PostgreSQL, MySQL/MariaDB, Microsoft SQL Server, and Oracle Database.
These schemas are also demonstrated in the following sections.</p>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="hypersql" href="#hypersql"></a>HyperSQL</h4></div></div></div>

<p>The default schema works with the embedded HSQLDB database that is used in unit tests within the framework.</p>
<pre class="programlisting">create table acl_sid(
    id bigint generated by default as identity(start with 100) not null primary key,
    principal boolean not null,
    sid varchar_ignorecase(100) not null,
    constraint unique_uk_1 unique(sid,principal)
);

create table acl_class(
    id bigint generated by default as identity(start with 100) not null primary key,
    class varchar_ignorecase(100) not null,
    constraint unique_uk_2 unique(class)
);

create table acl_object_identity(
    id bigint generated by default as identity(start with 100) not null primary key,
    object_id_class bigint not null,
    object_id_identity varchar_ignorecase(36) not null,
    parent_object bigint,
    owner_sid bigint,
    entries_inheriting boolean not null,
    constraint unique_uk_3 unique(object_id_class,object_id_identity),
    constraint foreign_fk_1 foreign key(parent_object)references acl_object_identity(id),
    constraint foreign_fk_2 foreign key(object_id_class)references acl_class(id),
    constraint foreign_fk_3 foreign key(owner_sid)references acl_sid(id)
);

create table acl_entry(
    id bigint generated by default as identity(start with 100) not null primary key,
    acl_object_identity bigint not null,
    ace_order int not null,
    sid bigint not null,
    mask integer not null,
    granting boolean not null,
    audit_success boolean not null,
    audit_failure boolean not null,
    constraint unique_uk_4 unique(acl_object_identity,ace_order),
    constraint foreign_fk_4 foreign key(acl_object_identity) references acl_object_identity(id),
    constraint foreign_fk_5 foreign key(sid) references acl_sid(id)
);</pre>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="postgresql" href="#postgresql"></a>PostgreSQL</h4></div></div></div>

<pre class="programlisting">create table acl_sid(
    id bigserial not null primary key,
    principal boolean not null,
    sid varchar(100) not null,
    constraint unique_uk_1 unique(sid,principal)
);

create table acl_class(
    id bigserial not null primary key,
    class varchar(100) not null,
    constraint unique_uk_2 unique(class)
);

create table acl_object_identity(
    id bigserial primary key,
    object_id_class bigint not null,
    object_id_identity varchar(36) not null,
    parent_object bigint,
    owner_sid bigint,
    entries_inheriting boolean not null,
    constraint unique_uk_3 unique(object_id_class,object_id_identity),
    constraint foreign_fk_1 foreign key(parent_object)references acl_object_identity(id),
    constraint foreign_fk_2 foreign key(object_id_class)references acl_class(id),
    constraint foreign_fk_3 foreign key(owner_sid)references acl_sid(id)
);

create table acl_entry(
    id bigserial primary key,
    acl_object_identity bigint not null,
    ace_order int not null,
    sid bigint not null,
    mask integer not null,
    granting boolean not null,
    audit_success boolean not null,
    audit_failure boolean not null,
    constraint unique_uk_4 unique(acl_object_identity,ace_order),
    constraint foreign_fk_4 foreign key(acl_object_identity) references acl_object_identity(id),
    constraint foreign_fk_5 foreign key(sid) references acl_sid(id)
);</pre>
<p>You will have to set the <code class="literal">classIdentityQuery</code> and <code class="literal">sidIdentityQuery</code> properties of <code class="literal">JdbcMutableAclService</code> to the following values, respectively:</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<code class="literal">select currval(pg_get_serial_sequence('acl_class', 'id'))</code>
</li><li class="listitem">
<code class="literal">select currval(pg_get_serial_sequence('acl_sid', 'id'))</code>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-and-mariadb" href="#mysql-and-mariadb"></a>MySQL and MariaDB</h4></div></div></div>

<pre class="programlisting">CREATE TABLE acl_sid (
    id BIGINT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY,
    principal BOOLEAN NOT NULL,
    sid VARCHAR(100) NOT NULL,
    UNIQUE KEY unique_acl_sid (sid, principal)
) ENGINE=InnoDB;

CREATE TABLE acl_class (
    id BIGINT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY,
    class VARCHAR(100) NOT NULL,
    UNIQUE KEY uk_acl_class (class)
) ENGINE=InnoDB;

CREATE TABLE acl_object_identity (
    id BIGINT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY,
    object_id_class BIGINT UNSIGNED NOT NULL,
    object_id_identity VARCHAR(36) NOT NULL,
    parent_object BIGINT UNSIGNED,
    owner_sid BIGINT UNSIGNED,
    entries_inheriting BOOLEAN NOT NULL,
    UNIQUE KEY uk_acl_object_identity (object_id_class, object_id_identity),
    CONSTRAINT fk_acl_object_identity_parent FOREIGN KEY (parent_object) REFERENCES acl_object_identity (id),
    CONSTRAINT fk_acl_object_identity_class FOREIGN KEY (object_id_class) REFERENCES acl_class (id),
    CONSTRAINT fk_acl_object_identity_owner FOREIGN KEY (owner_sid) REFERENCES acl_sid (id)
) ENGINE=InnoDB;

CREATE TABLE acl_entry (
    id BIGINT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY,
    acl_object_identity BIGINT UNSIGNED NOT NULL,
    ace_order INTEGER NOT NULL,
    sid BIGINT UNSIGNED NOT NULL,
    mask INTEGER UNSIGNED NOT NULL,
    granting BOOLEAN NOT NULL,
    audit_success BOOLEAN NOT NULL,
    audit_failure BOOLEAN NOT NULL,
    UNIQUE KEY unique_acl_entry (acl_object_identity, ace_order),
    CONSTRAINT fk_acl_entry_object FOREIGN KEY (acl_object_identity) REFERENCES acl_object_identity (id),
    CONSTRAINT fk_acl_entry_acl FOREIGN KEY (sid) REFERENCES acl_sid (id)
) ENGINE=InnoDB;</pre>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="microsoft-sql-server" href="#microsoft-sql-server"></a>Microsoft SQL Server</h4></div></div></div>

<pre class="programlisting">CREATE TABLE acl_sid (
    id BIGINT NOT NULL IDENTITY PRIMARY KEY,
    principal BIT NOT NULL,
    sid VARCHAR(100) NOT NULL,
    CONSTRAINT unique_acl_sid UNIQUE (sid, principal)
);

CREATE TABLE acl_class (
    id BIGINT NOT NULL IDENTITY PRIMARY KEY,
    class VARCHAR(100) NOT NULL,
    CONSTRAINT uk_acl_class UNIQUE (class)
);

CREATE TABLE acl_object_identity (
    id BIGINT NOT NULL IDENTITY PRIMARY KEY,
    object_id_class BIGINT NOT NULL,
    object_id_identity VARCHAR(36) NOT NULL,
    parent_object BIGINT,
    owner_sid BIGINT,
    entries_inheriting BIT NOT NULL,
    CONSTRAINT uk_acl_object_identity UNIQUE (object_id_class, object_id_identity),
    CONSTRAINT fk_acl_object_identity_parent FOREIGN KEY (parent_object) REFERENCES acl_object_identity (id),
    CONSTRAINT fk_acl_object_identity_class FOREIGN KEY (object_id_class) REFERENCES acl_class (id),
    CONSTRAINT fk_acl_object_identity_owner FOREIGN KEY (owner_sid) REFERENCES acl_sid (id)
);

CREATE TABLE acl_entry (
    id BIGINT NOT NULL IDENTITY PRIMARY KEY,
    acl_object_identity BIGINT NOT NULL,
    ace_order INTEGER NOT NULL,
    sid BIGINT NOT NULL,
    mask INTEGER NOT NULL,
    granting BIT NOT NULL,
    audit_success BIT NOT NULL,
    audit_failure BIT NOT NULL,
    CONSTRAINT unique_acl_entry UNIQUE (acl_object_identity, ace_order),
    CONSTRAINT fk_acl_entry_object FOREIGN KEY (acl_object_identity) REFERENCES acl_object_identity (id),
    CONSTRAINT fk_acl_entry_acl FOREIGN KEY (sid) REFERENCES acl_sid (id)
);</pre>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="oracle-database" href="#oracle-database"></a>Oracle Database</h4></div></div></div>

<pre class="programlisting">CREATE TABLE ACL_SID (
    ID NUMBER(18) PRIMARY KEY,
    PRINCIPAL NUMBER(1) NOT NULL CHECK (PRINCIPAL IN (0, 1 )),
    SID NVARCHAR2(128) NOT NULL,
    CONSTRAINT ACL_SID_UNIQUE UNIQUE (SID, PRINCIPAL)
);
CREATE SEQUENCE ACL_SID_SQ START WITH 1 INCREMENT BY 1 NOMAXVALUE;
CREATE OR REPLACE TRIGGER ACL_SID_SQ_TR BEFORE INSERT ON ACL_SID FOR EACH ROW
BEGIN
    SELECT ACL_SID_SQ.NEXTVAL INTO :NEW.ID FROM DUAL;
END;


CREATE TABLE ACL_CLASS (
    ID NUMBER(18) PRIMARY KEY,
    CLASS NVARCHAR2(128) NOT NULL,
    CONSTRAINT ACL_CLASS_UNIQUE UNIQUE (CLASS)
);
CREATE SEQUENCE ACL_CLASS_SQ START WITH 1 INCREMENT BY 1 NOMAXVALUE;
CREATE OR REPLACE TRIGGER ACL_CLASS_ID_TR BEFORE INSERT ON ACL_CLASS FOR EACH ROW
BEGIN
    SELECT ACL_CLASS_SQ.NEXTVAL INTO :NEW.ID FROM DUAL;
END;


CREATE TABLE ACL_OBJECT_IDENTITY(
    ID NUMBER(18) PRIMARY KEY,
    OBJECT_ID_CLASS NUMBER(18) NOT NULL,
    OBJECT_ID_IDENTITY NVARCHAR2(64) NOT NULL,
    PARENT_OBJECT NUMBER(18),
    OWNER_SID NUMBER(18),
    ENTRIES_INHERITING NUMBER(1) NOT NULL CHECK (ENTRIES_INHERITING IN (0, 1)),
    CONSTRAINT ACL_OBJECT_IDENTITY_UNIQUE UNIQUE (OBJECT_ID_CLASS, OBJECT_ID_IDENTITY),
    CONSTRAINT ACL_OBJECT_IDENTITY_PARENT_FK FOREIGN KEY (PARENT_OBJECT) REFERENCES ACL_OBJECT_IDENTITY(ID),
    CONSTRAINT ACL_OBJECT_IDENTITY_CLASS_FK FOREIGN KEY (OBJECT_ID_CLASS) REFERENCES ACL_CLASS(ID),
    CONSTRAINT ACL_OBJECT_IDENTITY_OWNER_FK FOREIGN KEY (OWNER_SID) REFERENCES ACL_SID(ID)
);
CREATE SEQUENCE ACL_OBJECT_IDENTITY_SQ START WITH 1 INCREMENT BY 1 NOMAXVALUE;
CREATE OR REPLACE TRIGGER ACL_OBJECT_IDENTITY_ID_TR BEFORE INSERT ON ACL_OBJECT_IDENTITY FOR EACH ROW
BEGIN
    SELECT ACL_OBJECT_IDENTITY_SQ.NEXTVAL INTO :NEW.ID FROM DUAL;
END;


CREATE TABLE ACL_ENTRY (
    ID NUMBER(18) NOT NULL PRIMARY KEY,
    ACL_OBJECT_IDENTITY NUMBER(18) NOT NULL,
    ACE_ORDER INTEGER NOT NULL,
    SID NUMBER(18) NOT NULL,
    MASK INTEGER NOT NULL,
    GRANTING NUMBER(1) NOT NULL CHECK (GRANTING IN (0, 1)),
    AUDIT_SUCCESS NUMBER(1) NOT NULL CHECK (AUDIT_SUCCESS IN (0, 1)),
    AUDIT_FAILURE NUMBER(1) NOT NULL CHECK (AUDIT_FAILURE IN (0, 1)),
    CONSTRAINT ACL_ENTRY_UNIQUE UNIQUE (ACL_OBJECT_IDENTITY, ACE_ORDER),
    CONSTRAINT ACL_ENTRY_OBJECT_FK FOREIGN KEY (ACL_OBJECT_IDENTITY) REFERENCES ACL_OBJECT_IDENTITY (ID),
    CONSTRAINT ACL_ENTRY_ACL_FK FOREIGN KEY (SID) REFERENCES ACL_SID(ID)
);
CREATE SEQUENCE ACL_ENTRY_SQ START WITH 1 INCREMENT BY 1 NOMAXVALUE;
CREATE OR REPLACE TRIGGER ACL_ENTRY_ID_TRIGGER BEFORE INSERT ON ACL_ENTRY FOR EACH ROW
BEGIN
    SELECT ACL_ENTRY_SQ.NEXTVAL INTO :NEW.ID FROM DUAL;
END;</pre>
</div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="appendix-namespace" href="#appendix-namespace"></a>15.2&nbsp;The Security Namespace</h2></div></div></div>

<p>This appendix provides a reference to the elements available in the security namespace and information on the underlying beans they create (a knowledge of the individual classes and how they work together is assumed - you can find more information in the project Javadoc and elsewhere in this document).
If you haven&#8217;t used the namespace before, please read the <a class="link" href="ns-config.html" title="7.&nbsp;Security Namespace Configuration">introductory chapter</a> on namespace configuration, as this is intended as a supplement to the information there.
Using a good quality XML editor while editing a configuration based on the schema is recommended as this will provide contextual information on which elements and attributes are available as well as comments explaining their purpose.
The namespace is written in <a class="ulink" href="http://www.relaxng.org/" target="_top">RELAX NG</a> Compact format and later converted into an XSD schema.
If you are familiar with this format, you may wish to examine the <a class="ulink" href="https://raw.githubusercontent.com/spring-projects/spring-security/master/config/src/main/resources/org/springframework/security/config/spring-security-4.1.rnc" target="_top">schema file</a> directly.</p>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="nsa-web" href="#nsa-web"></a>15.2.1&nbsp;Web Application Security</h3></div></div></div>

<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-debug" href="#nsa-debug"></a>&lt;debug&gt;</h4></div></div></div>

<p>Enables Spring Security debugging infrastructure.
This will provide human-readable (multi-line) debugging information to monitor requests coming into the security filters.
This may include sensitive information, such as request parameters or headers, and should only be used in a development environment.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-http" href="#nsa-http"></a>&lt;http&gt;</h4></div></div></div>

<p>If you use an <code class="literal">&lt;http&gt;</code> element within your application, a <code class="literal">FilterChainProxy</code> bean named "springSecurityFilterChain" is created and the configuration within the element is used to build a filter chain within
<code class="literal">FilterChainProxy</code>.
As of Spring Security 3.1, additional <code class="literal">http</code> elements can be used to add extra filter chains <a href="#ftn.d5e7286" class="footnote" name="d5e7286"><sup class="footnote">[22]</sup></a>.
Some core filters are always created in a filter chain and others will be added to the stack depending on the attributes and child elements which are present.
The positions of the standard filters are fixed (see
<a class="link" href="ns-config.html#filter-stack" title="Table&nbsp;7.1.&nbsp;Standard Filter Aliases and Ordering">the filter order table</a> in the namespace introduction), removing a common source of errors with previous versions of the framework when users had to configure the filter chain explicitly in the
<code class="literal">FilterChainProxy</code> bean.
You can, of course, still do this if you need full control of the configuration.</p>
<p>All filters which require a reference to the <code class="literal">AuthenticationManager</code> will be automatically injected with the internal instance created by the namespace configuration (see the <a class="link" href="ns-config.html#ns-auth-manager" title="7.6&nbsp;The Authentication Manager and the Namespace">introductory chapter</a> for more on the <code class="literal">AuthenticationManager</code>).</p>
<p>Each <code class="literal">&lt;http&gt;</code> namespace block always creates an <code class="literal">SecurityContextPersistenceFilter</code>, an <code class="literal">ExceptionTranslationFilter</code> and a <code class="literal">FilterSecurityInterceptor</code>.
These are fixed and cannot be replaced with alternatives.</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-http-attributes" href="#nsa-http-attributes"></a>&lt;http&gt; Attributes</h5></div></div></div>

<p>The attributes on the <code class="literal">&lt;http&gt;</code> element control some of the properties on the core filters.</p>
<div class="itemizedlist"><a name="nsa-http-access-decision-manager-ref" href="#nsa-http-access-decision-manager-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>access-decision-manager-ref</strong></span>
Optional attribute specifying the ID of the <code class="literal">AccessDecisionManager</code> implementation which should be used for authorizing HTTP requests.
By default an <code class="literal">AffirmativeBased</code> implementation is used for with a <code class="literal">RoleVoter</code> and an <code class="literal">AuthenticatedVoter</code>.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-http-authentication-manager-ref" href="#nsa-http-authentication-manager-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>authentication-manager-ref</strong></span>
A reference to the <code class="literal">AuthenticationManager</code> used for the <code class="literal">FilterChain</code> created by this http element.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-http-auto-config" href="#nsa-http-auto-config"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>auto-config</strong></span>
Automatically registers a login form, BASIC authentication, logout services.
If set to "true", all of these capabilities are added (although you can still customize the configuration of each by providing the respective element).
If unspecified, defaults to "false".
Use of this attribute is not recommended.
Use explicit configuration elements instead to avoid confusion.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-http-create-session" href="#nsa-http-create-session"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<p class="simpara"><span class="strong"><strong>create-session</strong></span>
Controls the eagerness with which an HTTP session is created by Spring Security classes.
Options include:</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem">
<code class="literal">always</code> - Spring Security will proactively create a session if one does not exist.
</li><li class="listitem">
<code class="literal">ifRequired</code> - Spring Security will only create a session only if one is required (default value).
</li><li class="listitem">
<code class="literal">never</code> - Spring Security will never create a session, but will make use of one if the application does.
</li><li class="listitem">
<code class="literal">stateless</code> - Spring Security will not create a session and ignore the session for obtaining a Spring <code class="literal">Authentication</code>.
</li></ul></div>
</li></ul></div>
<div class="itemizedlist"><a name="nsa-http-disable-url-rewriting" href="#nsa-http-disable-url-rewriting"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>disable-url-rewriting</strong></span>
Prevents session IDs from being appended to URLs in the application.
Clients must use cookies if this attribute is set to <code class="literal">true</code>.
The default is <code class="literal">true</code>.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-http-entry-point-ref" href="#nsa-http-entry-point-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>entry-point-ref</strong></span>
Normally the <code class="literal">AuthenticationEntryPoint</code> used will be set depending on which authentication mechanisms have been configured.
This attribute allows this behaviour to be overridden by defining a customized <code class="literal">AuthenticationEntryPoint</code> bean which will start the authentication process.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-http-jaas-api-provision" href="#nsa-http-jaas-api-provision"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>jaas-api-provision</strong></span>
If available, runs the request as the <code class="literal">Subject</code> acquired from the <code class="literal">JaasAuthenticationToken</code> which is implemented by adding a <code class="literal">JaasApiIntegrationFilter</code> bean to the stack.
Defaults to <code class="literal">false</code>.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-http-name" href="#nsa-http-name"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>name</strong></span>
A bean identifier, used for referring to the bean elsewhere in the context.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-http-once-per-request" href="#nsa-http-once-per-request"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>once-per-request</strong></span>
Corresponds to the <code class="literal">observeOncePerRequest</code> property of <code class="literal">FilterSecurityInterceptor</code>.
Defaults to <code class="literal">true</code>.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-http-pattern" href="#nsa-http-pattern"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>pattern</strong></span>
Defining a pattern for the <a class="link" href="appendix.html#nsa-http" title="<http&gt;">http</a> element controls the requests which will be filtered through the list of filters which it defines.
The interpretation is dependent on the configured <a class="link" href="appendix.html#nsa-http-request-matcher">request-matcher</a>.
If no pattern is defined, all requests will be matched, so the most specific patterns should be declared first.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-http-realm" href="#nsa-http-realm"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>realm</strong></span>
Sets the realm name used for basic authentication (if enabled).
Corresponds to the <code class="literal">realmName</code> property on <code class="literal">BasicAuthenticationEntryPoint</code>.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-http-request-matcher" href="#nsa-http-request-matcher"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>request-matcher</strong></span>
Defines the <code class="literal">RequestMatcher</code> strategy used in the <code class="literal">FilterChainProxy</code> and the beans created by the <code class="literal">intercept-url</code> to match incoming requests.
Options are currently <code class="literal">mvc</code>, <code class="literal">ant</code>, <code class="literal">regex</code> and <code class="literal">ciRegex</code>, for Spring MVC, ant, regular-expression and case-insensitive regular-expression respectively.
A separate instance is created for each <a class="link" href="appendix.html#nsa-intercept-url" title="<intercept-url&gt;">intercept-url</a> element using its <a class="link" href="appendix.html#nsa-intercept-url-pattern">pattern</a>, <a class="link" href="appendix.html#nsa-intercept-url-method">method</a> and <a class="link" href="appendix.html#nsa-intercept-url-servlet-path">servlet-path</a> attributes.
Ant paths are matched using an <code class="literal">AntPathRequestMatcher</code>, regular expressions are matched using a <code class="literal">RegexRequestMatcher</code> and for Spring MVC path matching the <code class="literal">MvcRequestMatcher</code> is used.
See the Javadoc for these classes for more details on exactly how the matching is performed.
Ant paths are the default strategy.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-http-request-matcher-ref" href="#nsa-http-request-matcher-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>request-matcher-ref</strong></span>
A reference to a bean that implements <code class="literal">RequestMatcher</code> that will determine if this <code class="literal">FilterChain</code> should be used.
This is a more powerful alternative to <a class="link" href="appendix.html#nsa-http-pattern">pattern</a>.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-http-security" href="#nsa-http-security"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>security</strong></span>
A request pattern can be mapped to an empty filter chain, by setting this attribute to <code class="literal">none</code>.
No security will be applied and none of Spring Security&#8217;s features will be available.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-http-security-context-repository-ref" href="#nsa-http-security-context-repository-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>security-context-repository-ref</strong></span>
Allows injection of a custom <code class="literal">SecurityContextRepository</code> into the <code class="literal">SecurityContextPersistenceFilter</code>.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-http-servlet-api-provision" href="#nsa-http-servlet-api-provision"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>servlet-api-provision</strong></span>
Provides versions of <code class="literal">HttpServletRequest</code> security methods such as <code class="literal">isUserInRole()</code> and <code class="literal">getPrincipal()</code> which are implemented by adding a <code class="literal">SecurityContextHolderAwareRequestFilter</code> bean to the stack.
Defaults to <code class="literal">true</code>.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-http-use-expressions" href="#nsa-http-use-expressions"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>use-expressions</strong></span>
Enables EL-expressions in the <code class="literal">access</code> attribute, as described in the chapter on <a class="link" href="authorization.html#el-access-web" title="11.3.2&nbsp;Web Security Expressions">expression-based access-control</a>.
The default value is true.
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-http-children" href="#nsa-http-children"></a>Child Elements of &lt;http&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-access-denied-handler" title="<access-denied-handler&gt;">access-denied-handler</a>
</li><li class="listitem">
<a class="link" href="appendix.html#nsa-anonymous" title="<anonymous&gt;">anonymous</a>
</li><li class="listitem">
<a class="link" href="appendix.html#nsa-cors" title="<cors&gt;">cors</a>
</li><li class="listitem">
<a class="link" href="appendix.html#nsa-csrf" title="<csrf&gt;">csrf</a>
</li><li class="listitem">
<a class="link" href="appendix.html#nsa-custom-filter" title="<custom-filter&gt;">custom-filter</a>
</li><li class="listitem">
<a class="link" href="appendix.html#nsa-expression-handler" title="<expression-handler&gt;">expression-handler</a>
</li><li class="listitem">
<a class="link" href="appendix.html#nsa-form-login" title="<form-login&gt;">form-login</a>
</li><li class="listitem">
<a class="link" href="appendix.html#nsa-headers" title="<headers&gt;">headers</a>
</li><li class="listitem">
<a class="link" href="appendix.html#nsa-http-basic" title="<http-basic&gt;">http-basic</a>
</li><li class="listitem">
<a class="link" href="appendix.html#nsa-intercept-url" title="<intercept-url&gt;">intercept-url</a>
</li><li class="listitem">
<a class="link" href="appendix.html#nsa-jee" title="<jee&gt;">jee</a>
</li><li class="listitem">
<a class="link" href="appendix.html#nsa-logout" title="<logout&gt;">logout</a>
</li><li class="listitem">
<a class="link" href="appendix.html#nsa-openid-login" title="<openid-login&gt;">openid-login</a>
</li><li class="listitem">
<a class="link" href="appendix.html#nsa-port-mappings" title="<port-mappings&gt;">port-mappings</a>
</li><li class="listitem">
<a class="link" href="appendix.html#nsa-remember-me" title="<remember-me&gt;">remember-me</a>
</li><li class="listitem">
<a class="link" href="appendix.html#nsa-request-cache" title="<request-cache&gt; Element">request-cache</a>
</li><li class="listitem">
<a class="link" href="appendix.html#nsa-session-management" title="<session-management&gt;">session-management</a>
</li><li class="listitem">
<a class="link" href="appendix.html#nsa-x509" title="<x509&gt;">x509</a>
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-access-denied-handler" href="#nsa-access-denied-handler"></a>&lt;access-denied-handler&gt;</h4></div></div></div>

<p>This element allows you to set the <code class="literal">errorPage</code> property for the default <code class="literal">AccessDeniedHandler</code> used by the <code class="literal">ExceptionTranslationFilter</code>, using the <a class="link" href="appendix.html#nsa-access-denied-handler-error-page">error-page</a> attribute, or to supply your own implementation using the<a class="link" href="appendix.html#nsa-access-denied-handler-ref">ref</a> attribute.
This is discussed in more detail in the section on the <a class="link" href="web-app-security.html#access-denied-handler" title="AccessDeniedHandler">ExceptionTranslationFilter</a>.</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-access-denied-handler-parents" href="#nsa-access-denied-handler-parents"></a>Parent Elements of &lt;access-denied-handler&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-http" title="<http&gt;">http</a>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-access-denied-handler-attributes" href="#nsa-access-denied-handler-attributes"></a>&lt;access-denied-handler&gt; Attributes</h5></div></div></div>

<div class="itemizedlist"><a name="nsa-access-denied-handler-error-page" href="#nsa-access-denied-handler-error-page"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>error-page</strong></span>
The access denied page that an authenticated user will be redirected to if they request a page which they don&#8217;t have the authority to access.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-access-denied-handler-ref" href="#nsa-access-denied-handler-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>ref</strong></span>
Defines a reference to a Spring bean of type <code class="literal">AccessDeniedHandler</code>.
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-cors" href="#nsa-cors"></a>&lt;cors&gt;</h4></div></div></div>

<p>This element allows for configuring a <code class="literal">CorsFilter</code>.
If no <code class="literal">CorsFilter</code> or <code class="literal">CorsConfigurationSource</code> is specified and Spring MVC is on the classpath, a <code class="literal">HandlerMappingIntrospector</code> is used as the <code class="literal">CorsConfigurationSource</code>.</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-cors-attributes" href="#nsa-cors-attributes"></a>&lt;cors&gt; Attributes</h5></div></div></div>

<p>The attributes on the <code class="literal">&lt;cors&gt;</code> element control the headers element.</p>
<div class="itemizedlist"><a name="nsa-cors-ref" href="#nsa-cors-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>ref</strong></span>
Optional attribute that specifies the bean name of a <code class="literal">CorsFilter</code>.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-cors-configuration-source-ref" href="#nsa-cors-configuration-source-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>cors-configuration-source-ref</strong></span>
Optional attribute that specifies the bean name of a <code class="literal">CorsConfigurationSource</code> to be injected into a <code class="literal">CorsFilter</code> created by the XML namespace.
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-cors-parents" href="#nsa-cors-parents"></a>Parent Elements of &lt;cors&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-http" title="<http&gt;">http</a>
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-headers" href="#nsa-headers"></a>&lt;headers&gt;</h4></div></div></div>

<p>This element allows for configuring additional (security) headers to be send with the response.
It enables easy configuration for several headers and also allows for setting custom headers through the <a class="link" href="appendix.html#nsa-header" title="<header&gt;">header</a> element.
Additional information, can be found in the <a class="link" href="web-app-security.html#headers" title="10.8&nbsp;Security HTTP Response Headers">Security Headers</a> section of the reference.</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<code class="literal">Cache-Control</code>, <code class="literal">Pragma</code>, and <code class="literal">Expires</code> - Can be set using the <a class="link" href="appendix.html#nsa-cache-control" title="<cache-control&gt;">cache-control</a> element.
This ensures that the browser does not cache your secured pages.
</li><li class="listitem">
<code class="literal">Strict-Transport-Security</code> - Can be set using the <a class="link" href="appendix.html#nsa-hsts" title="<hsts&gt;">hsts</a> element.
This ensures that the browser automatically requests HTTPS for future requests.
</li><li class="listitem">
<code class="literal">X-Frame-Options</code> - Can be set using the <a class="link" href="appendix.html#nsa-frame-options" title="<frame-options&gt;">frame-options</a> element.
The <a class="ulink" href="http://en.wikipedia.org/wiki/Clickjacking#X-Frame-Options" target="_top">X-Frame-Options</a> header can be used to prevent clickjacking attacks.
</li><li class="listitem">
<code class="literal">X-XSS-Protection</code> - Can be set using the <a class="link" href="appendix.html#nsa-xss-protection" title="<xss-protection&gt;">xss-protection</a> element.
The <a class="ulink" href="http://en.wikipedia.org/wiki/Cross-site_scripting" target="_top">X-XSS-Protection </a> header can be used by browser to do basic control.
</li><li class="listitem">
<code class="literal">X-Content-Type-Options</code> - Can be set using the <a class="link" href="appendix.html#nsa-content-type-options" title="<content-type-options&gt;">content-type-options</a> element.
The <a class="ulink" href="http://blogs.msdn.com/b/ie/archive/2008/09/02/ie8-security-part-vi-beta-2-update.aspx" target="_top">X-Content-Type-Options</a> header prevents Internet Explorer from MIME-sniffing a response away from the declared content-type.
This also applies to Google Chrome, when downloading extensions.
</li><li class="listitem">
<code class="literal">Public-Key-Pinning</code> or <code class="literal">Public-Key-Pinning-Report-Only</code> - Can be set using the <a class="link" href="appendix.html#nsa-hpkp" title="<hpkp&gt;">hpkp</a> element.
This allows HTTPS websites to resist impersonation by attackers using mis-issued or otherwise fraudulent certificates.
</li><li class="listitem">
<code class="literal">Content-Security-Policy</code> or <code class="literal">Content-Security-Policy-Report-Only</code> - Can be set using the <a class="link" href="appendix.html#nsa-content-security-policy" title="<content-security-policy&gt;">content-security-policy</a> element.
<a class="ulink" href="https://www.w3.org/TR/CSP2/" target="_top">Content Security Policy (CSP)</a> is a mechanism that web applications can leverage to mitigate content injection vulnerabilities, such as cross-site scripting (XSS).
</li><li class="listitem">
<code class="literal">Referrer-Policy</code> - Can be set using the <a class="link" href="appendix.html#nsa-referrer-policy" title="<referrer-policy&gt;">referrer-policy</a> element, <a class="ulink" href="https://www.w3.org/TR/referrer-policy/" target="_top">Referrer-Policy</a> is a mechanism that web applications can leverage to manage the referrer field, which contains the last page the user was on.
</li><li class="listitem">
<code class="literal">Feature-Policy</code> - Can be set using the <a class="link" href="appendix.html#nsa-feature-policy" title="<feature-policy&gt;">feature-policy</a> element, <a class="ulink" href="https://wicg.github.io/feature-policy/" target="_top">Feature-Policy</a> is a mechanism that allows web developers to selectively enable, disable, and modify the behavior of certain APIs and web features in the browser.
</li></ul></div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-headers-attributes" href="#nsa-headers-attributes"></a>&lt;headers&gt; Attributes</h5></div></div></div>

<p>The attributes on the <code class="literal">&lt;headers&gt;</code> element control the headers element.</p>
<div class="itemizedlist"><a name="nsa-headers-defaults-disabled" href="#nsa-headers-defaults-disabled"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>defaults-disabled</strong></span>
Optional attribute that specifies to disable the default Spring Security&#8217;s HTTP response headers.
The default is false (the default headers are included).
</li></ul></div>
<div class="itemizedlist"><a name="nsa-headers-disabled" href="#nsa-headers-disabled"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>disabled</strong></span>
Optional attribute that specifies to disable Spring Security&#8217;s HTTP response headers.
The default is false (the headers are enabled).
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-headers-parents" href="#nsa-headers-parents"></a>Parent Elements of &lt;headers&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-http" title="<http&gt;">http</a>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-headers-children" href="#nsa-headers-children"></a>Child Elements of &lt;headers&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-cache-control" title="<cache-control&gt;">cache-control</a>
</li><li class="listitem">
<a class="link" href="appendix.html#nsa-content-security-policy" title="<content-security-policy&gt;">content-security-policy</a>
</li><li class="listitem">
<a class="link" href="appendix.html#nsa-content-type-options" title="<content-type-options&gt;">content-type-options</a>
</li><li class="listitem">
<a class="link" href="appendix.html#nsa-feature-policy" title="<feature-policy&gt;">feature-policy</a>
</li><li class="listitem">
<a class="link" href="appendix.html#nsa-frame-options" title="<frame-options&gt;">frame-options</a>
</li><li class="listitem">
<a class="link" href="appendix.html#nsa-header" title="<header&gt;">header</a>
</li><li class="listitem">
<a class="link" href="appendix.html#nsa-hpkp" title="<hpkp&gt;">hpkp</a>
</li><li class="listitem">
<a class="link" href="appendix.html#nsa-hsts" title="<hsts&gt;">hsts</a>
</li><li class="listitem">
<a class="link" href="appendix.html#nsa-referrer-policy" title="<referrer-policy&gt;">referrer-policy</a>
</li><li class="listitem">
<a class="link" href="appendix.html#nsa-xss-protection" title="<xss-protection&gt;">xss-protection</a>
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-cache-control" href="#nsa-cache-control"></a>&lt;cache-control&gt;</h4></div></div></div>

<p>Adds <code class="literal">Cache-Control</code>, <code class="literal">Pragma</code>, and <code class="literal">Expires</code> headers to ensure that the browser does not cache your secured pages.</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-cache-control-attributes" href="#nsa-cache-control-attributes"></a>&lt;cache-control&gt; Attributes</h5></div></div></div>

<div class="itemizedlist"><a name="nsa-cache-control-disabled" href="#nsa-cache-control-disabled"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>disabled</strong></span>
Specifies if Cache Control should be disabled.
Default false.
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-cache-control-parents" href="#nsa-cache-control-parents"></a>Parent Elements of &lt;cache-control&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-headers" title="<headers&gt;">headers</a>
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-hsts" href="#nsa-hsts"></a>&lt;hsts&gt;</h4></div></div></div>

<p>When enabled adds the <a class="ulink" href="http://tools.ietf.org/html/rfc6797" target="_top">Strict-Transport-Security</a> header to the response for any secure request.
This allows the server to instruct browsers to automatically use HTTPS for future requests.</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-hsts-attributes" href="#nsa-hsts-attributes"></a>&lt;hsts&gt; Attributes</h5></div></div></div>

<div class="itemizedlist"><a name="nsa-hsts-disabled" href="#nsa-hsts-disabled"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>disabled</strong></span>
Specifies if Strict-Transport-Security should be disabled.
Default false.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-hsts-include-subdomains" href="#nsa-hsts-include-subdomains"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>include-sub-domains</strong></span>
Specifies if subdomains should be included.
Default true.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-hsts-max-age-seconds" href="#nsa-hsts-max-age-seconds"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>max-age-seconds</strong></span>
Specifies the maximum amount of time the host should be considered a Known HSTS Host.
Default one year.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-hsts-request-matcher-ref" href="#nsa-hsts-request-matcher-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>request-matcher-ref</strong></span>
The RequestMatcher instance to be used to determine if the header should be set.
Default is if HttpServletRequest.isSecure() is true.
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-hsts-parents" href="#nsa-hsts-parents"></a>Parent Elements of &lt;hsts&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-headers" title="<headers&gt;">headers</a>
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-hpkp" href="#nsa-hpkp"></a>&lt;hpkp&gt;</h4></div></div></div>

<p>When enabled adds the <a class="ulink" href="https://tools.ietf.org/html/rfc7469" target="_top">Public Key Pinning Extension for HTTP</a> header to the response for any secure request.
This allows HTTPS websites to resist impersonation by attackers using mis-issued or otherwise fraudulent certificates.</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-hpkp-attributes" href="#nsa-hpkp-attributes"></a>&lt;hpkp&gt; Attributes</h5></div></div></div>

<div class="itemizedlist"><a name="nsa-hpkp-disabled" href="#nsa-hpkp-disabled"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>disabled</strong></span>
Specifies if HTTP Public Key Pinning (HPKP) should be disabled.
Default true.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-hpkp-include-subdomains" href="#nsa-hpkp-include-subdomains"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>include-sub-domains</strong></span>
Specifies if subdomains should be included.
Default false.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-hpkp-max-age-seconds" href="#nsa-hpkp-max-age-seconds"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>max-age-seconds</strong></span>
Sets the value for the max-age directive of the Public-Key-Pins header.
Default 60 days.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-hpkp-report-only" href="#nsa-hpkp-report-only"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>report-only</strong></span>
Specifies if the browser should only report pin validation failures.
Default true.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-hpkp-report-uri" href="#nsa-hpkp-report-uri"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>report-uri</strong></span>
Specifies the URI to which the browser should report pin validation failures.
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-hpkp-parents" href="#nsa-hpkp-parents"></a>Parent Elements of &lt;hpkp&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-headers" title="<headers&gt;">headers</a>
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-pins" href="#nsa-pins"></a>&lt;pins&gt;</h4></div></div></div>

<p>The list of pins</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-pins-children" href="#nsa-pins-children"></a>Child Elements of &lt;pins&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-pin" title="<pin&gt;">pin</a>
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-pin" href="#nsa-pin"></a>&lt;pin&gt;</h4></div></div></div>

<p>A pin is specified using the base64-encoded SPKI fingerprint as value and the cryptographic hash algorithm as attribute</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-pin-attributes" href="#nsa-pin-attributes"></a>&lt;pin&gt; Attributes</h5></div></div></div>

<div class="itemizedlist"><a name="nsa-pin-algorithm" href="#nsa-pin-algorithm"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>algorithm</strong></span>
The cryptographic hash algorithm.
Default is SHA256.
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-pin-parents" href="#nsa-pin-parents"></a>Parent Elements of &lt;pin&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-pins" title="<pins&gt;">pins</a>
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-content-security-policy" href="#nsa-content-security-policy"></a>&lt;content-security-policy&gt;</h4></div></div></div>

<p>When enabled adds the <a class="ulink" href="https://www.w3.org/TR/CSP2/" target="_top">Content Security Policy (CSP)</a> header to the response.
CSP is a mechanism that web applications can leverage to mitigate content injection vulnerabilities, such as cross-site scripting (XSS).</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-content-security-policy-attributes" href="#nsa-content-security-policy-attributes"></a>&lt;content-security-policy&gt; Attributes</h5></div></div></div>

<div class="itemizedlist"><a name="nsa-content-security-policy-policy-directives" href="#nsa-content-security-policy-policy-directives"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>policy-directives</strong></span>
The security policy directive(s) for the Content-Security-Policy header or if report-only is set to true, then the Content-Security-Policy-Report-Only header is used.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-content-security-policy-report-only" href="#nsa-content-security-policy-report-only"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>report-only</strong></span>
Set to true, to enable the Content-Security-Policy-Report-Only header for reporting policy violations only.
Defaults to false.
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-content-security-policy-parents" href="#nsa-content-security-policy-parents"></a>Parent Elements of &lt;content-security-policy&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-headers" title="<headers&gt;">headers</a>
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-referrer-policy" href="#nsa-referrer-policy"></a>&lt;referrer-policy&gt;</h4></div></div></div>

<p>When enabled adds the <a class="ulink" href="https://www.w3.org/TR/referrer-policy/" target="_top">Referrer Policy</a> header to the response.</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-referrer-policy-attributes" href="#nsa-referrer-policy-attributes"></a>&lt;referrer-policy&gt; Attributes</h5></div></div></div>

<div class="itemizedlist"><a name="nsa-referrer-policy-policy" href="#nsa-referrer-policy-policy"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>policy</strong></span>
The policy for the Referrer-Policy header.
Default "no-referrer".
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-referrer-policy-parents" href="#nsa-referrer-policy-parents"></a>Parent Elements of &lt;referrer-policy&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-headers" title="<headers&gt;">headers</a>
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-feature-policy" href="#nsa-feature-policy"></a>&lt;feature-policy&gt;</h4></div></div></div>

<p>When enabled adds the <a class="ulink" href="https://wicg.github.io/feature-policy/" target="_top">Feature Policy</a> header to the response.</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-feature-policy-attributes" href="#nsa-feature-policy-attributes"></a>&lt;feature-policy&gt; Attributes</h5></div></div></div>

<div class="itemizedlist"><a name="nsa-feature-policy-policy-directives" href="#nsa-feature-policy-policy-directives"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>policy-directives</strong></span>
The security policy directive(s) for the Feature-Policy header.
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-feature-policy-parents" href="#nsa-feature-policy-parents"></a>Parent Elements of &lt;feature-policy&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-headers" title="<headers&gt;">headers</a>
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-frame-options" href="#nsa-frame-options"></a>&lt;frame-options&gt;</h4></div></div></div>

<p>When enabled adds the <a class="ulink" href="http://tools.ietf.org/html/draft-ietf-websec-x-frame-options" target="_top">X-Frame-Options header</a> to the response, this allows newer browsers to do some security checks and prevent <a class="ulink" href="http://en.wikipedia.org/wiki/Clickjacking" target="_top">clickjacking</a> attacks.</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-frame-options-attributes" href="#nsa-frame-options-attributes"></a>&lt;frame-options&gt; Attributes</h5></div></div></div>

<div class="itemizedlist"><a name="nsa-frame-options-disabled" href="#nsa-frame-options-disabled"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>disabled</strong></span>
If disabled, the X-Frame-Options header will not be included.
Default false.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-frame-options-policy" href="#nsa-frame-options-policy"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<p class="simpara"><span class="strong"><strong>policy</strong></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem">
<code class="literal">DENY</code> The page cannot be displayed in a frame, regardless of the site attempting to do so.
This is the default when frame-options-policy is specified.
</li><li class="listitem">
<code class="literal">SAMEORIGIN</code> The page can only be displayed in a frame on the same origin as the page itself
</li><li class="listitem">
<code class="literal">ALLOW-FROM origin</code> The page can only be displayed in a frame on the specified origin.
</li></ul></div>
<p class="simpara">In other words, if you specify DENY, not only will attempts to load the page in a frame fail when loaded from other sites, attempts to do so will fail when loaded from the same site.
On the other hand, if you specify SAMEORIGIN, you can still use the page in a frame as long as the site including it in a frame it is the same as the one serving the page.</p>
</li></ul></div>
<div class="itemizedlist"><a name="nsa-frame-options-strategy" href="#nsa-frame-options-strategy"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<p class="simpara"><span class="strong"><strong>strategy</strong></span>
Select the <code class="literal">AllowFromStrategy</code> to use when using the ALLOW-FROM policy.</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem">
<code class="literal">static</code> Use a single static ALLOW-FROM value.
The value can be set through the <a class="link" href="appendix.html#nsa-frame-options-value">value</a> attribute.
</li><li class="listitem">
<code class="literal">regexp</code> Use a regelur expression to validate incoming requests and if they are allowed.
The regular expression can be set through the <a class="link" href="appendix.html#nsa-frame-options-value">value</a> attribute.
The request parameter used to retrieve the value to validate can be specified using the <a class="link" href="appendix.html#nsa-frame-options-from-parameter">from-parameter</a>.
</li><li class="listitem">
<code class="literal">whitelist</code> A comma-seperated list containing the allowed domains.
The comma-seperated list can be set through the <a class="link" href="appendix.html#nsa-frame-options-value">value</a> attribute.
The request parameter used to retrieve the value to validate can be specified using the <a class="link" href="appendix.html#nsa-frame-options-from-parameter">from-parameter</a>.
</li></ul></div>
</li></ul></div>
<div class="itemizedlist"><a name="nsa-frame-options-ref" href="#nsa-frame-options-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>ref</strong></span>
Instead of using one of the predefined strategies it is also possible to use a custom <code class="literal">AllowFromStrategy</code>.
The reference to this bean can be specified through this ref attribute.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-frame-options-value" href="#nsa-frame-options-value"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>value</strong></span>
The value to use when ALLOW-FROM is used a <a class="link" href="appendix.html#nsa-frame-options-strategy">strategy</a>.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-frame-options-from-parameter" href="#nsa-frame-options-from-parameter"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>from-parameter</strong></span>
Specify the name of the request parameter to use when using regexp or whitelist for the ALLOW-FROM strategy.
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-frame-options-parents" href="#nsa-frame-options-parents"></a>Parent Elements of &lt;frame-options&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-headers" title="<headers&gt;">headers</a>
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-xss-protection" href="#nsa-xss-protection"></a>&lt;xss-protection&gt;</h4></div></div></div>

<p>Adds the <a class="ulink" href="http://blogs.msdn.com/b/ie/archive/2008/07/02/ie8-security-part-iv-the-xss-filter.aspx" target="_top">X-XSS-Protection header</a> to the response to assist in protecting against <a class="ulink" href="http://en.wikipedia.org/wiki/Cross-site_scripting#Non-Persistent" target="_top">reflected / Type-1 Cross-Site Scripting (XSS)</a> attacks.
This is in no-way a full protection to XSS attacks!</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-xss-protection-attributes" href="#nsa-xss-protection-attributes"></a>&lt;xss-protection&gt; Attributes</h5></div></div></div>

<div class="itemizedlist"><a name="nsa-xss-protection-disabled" href="#nsa-xss-protection-disabled"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>xss-protection-disabled</strong></span>
Do not include the header for <a class="ulink" href="http://en.wikipedia.org/wiki/Cross-site_scripting#Non-Persistent" target="_top">reflected / Type-1 Cross-Site Scripting (XSS)</a> protection.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-xss-protection-enabled" href="#nsa-xss-protection-enabled"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>xss-protection-enabled</strong></span>
Explicitly enable or disable <a class="ulink" href="http://en.wikipedia.org/wiki/Cross-site_scripting#Non-Persistent" target="_top">reflected / Type-1 Cross-Site Scripting (XSS)</a> protection.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-xss-protection-block" href="#nsa-xss-protection-block"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>xss-protection-block</strong></span>
When true and xss-protection-enabled is true, adds mode=block to the header.
This indicates to the browser that the page should not be loaded at all.
When false and xss-protection-enabled is true, the page will still be rendered when an reflected attack is detected but the response will be modified to protect against the attack.
Note that there are sometimes ways of bypassing this mode which can often times make blocking the page more desirable.
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-xss-protection-parents" href="#nsa-xss-protection-parents"></a>Parent Elements of &lt;xss-protection&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-headers" title="<headers&gt;">headers</a>
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-content-type-options" href="#nsa-content-type-options"></a>&lt;content-type-options&gt;</h4></div></div></div>

<p>Add the X-Content-Type-Options header with the value of nosniff to the response.
This <a class="ulink" href="http://blogs.msdn.com/b/ie/archive/2008/09/02/ie8-security-part-vi-beta-2-update.aspx" target="_top">disables MIME-sniffing</a> for IE8+ and Chrome extensions.</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-content-type-options-attributes" href="#nsa-content-type-options-attributes"></a>&lt;content-type-options&gt; Attributes</h5></div></div></div>

<div class="itemizedlist"><a name="nsa-content-type-options-disabled" href="#nsa-content-type-options-disabled"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>disabled</strong></span>
Specifies if Content Type Options should be disabled.
Default false.
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-content-type-options-parents" href="#nsa-content-type-options-parents"></a>Parent Elements of &lt;content-type-options&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-headers" title="<headers&gt;">headers</a>
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-header" href="#nsa-header"></a>&lt;header&gt;</h4></div></div></div>

<p>Add additional headers to the response, both the name and value need to be specified.</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-header-attributes" href="#nsa-header-attributes"></a>&lt;header-attributes&gt; Attributes</h5></div></div></div>

<div class="itemizedlist"><a name="nsa-header-name" href="#nsa-header-name"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>header-name</strong></span>
The <code class="literal">name</code> of the header.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-header-value" href="#nsa-header-value"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>value</strong></span>
The <code class="literal">value</code> of the header to add.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-header-ref" href="#nsa-header-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>ref</strong></span>
Reference to a custom implementation of the <code class="literal">HeaderWriter</code> interface.
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-header-parents" href="#nsa-header-parents"></a>Parent Elements of &lt;header&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-headers" title="<headers&gt;">headers</a>
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-anonymous" href="#nsa-anonymous"></a>&lt;anonymous&gt;</h4></div></div></div>

<p>Adds an <code class="literal">AnonymousAuthenticationFilter</code> to the stack and an <code class="literal">AnonymousAuthenticationProvider</code>.
Required if you are using the <code class="literal">IS_AUTHENTICATED_ANONYMOUSLY</code> attribute.</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-anonymous-parents" href="#nsa-anonymous-parents"></a>Parent Elements of &lt;anonymous&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-http" title="<http&gt;">http</a>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-anonymous-attributes" href="#nsa-anonymous-attributes"></a>&lt;anonymous&gt; Attributes</h5></div></div></div>

<div class="itemizedlist"><a name="nsa-anonymous-enabled" href="#nsa-anonymous-enabled"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>enabled</strong></span>
With the default namespace setup, the anonymous "authentication" facility is automatically enabled.
You can disable it using this property.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-anonymous-granted-authority" href="#nsa-anonymous-granted-authority"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>granted-authority</strong></span>
The granted authority that should be assigned to the anonymous request.
Commonly this is used to assign the anonymous request particular roles, which can subsequently be used in authorization decisions.
If unset, defaults to <code class="literal">ROLE_ANONYMOUS</code>.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-anonymous-key" href="#nsa-anonymous-key"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>key</strong></span>
The key shared between the provider and filter.
This generally does not need to be set.
If unset, it will default to a secure randomly generated value.
This means setting this value can improve startup time when using the anonymous functionality since secure random values can take a while to be generated.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-anonymous-username" href="#nsa-anonymous-username"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>username</strong></span>
The username that should be assigned to the anonymous request.
This allows the principal to be identified, which may be important for logging and auditing.
if unset, defaults to <code class="literal">anonymousUser</code>.
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-csrf" href="#nsa-csrf"></a>&lt;csrf&gt;</h4></div></div></div>

<p>This element will add <a class="ulink" href="http://en.wikipedia.org/wiki/Cross-site_request_forgery" target="_top">Cross Site Request Forger (CSRF)</a> protection to the application.
It also updates the default RequestCache to only replay "GET" requests upon successful authentication.
Additional information can be found in the <a class="link" href="web-app-security.html#csrf" title="10.6&nbsp;Cross Site Request Forgery (CSRF)">Cross Site Request Forgery (CSRF)</a> section of the reference.</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-csrf-parents" href="#nsa-csrf-parents"></a>Parent Elements of &lt;csrf&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-http" title="<http&gt;">http</a>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-csrf-attributes" href="#nsa-csrf-attributes"></a>&lt;csrf&gt; Attributes</h5></div></div></div>

<div class="itemizedlist"><a name="nsa-csrf-disabled" href="#nsa-csrf-disabled"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>disabled</strong></span>
Optional attribute that specifies to disable Spring Security&#8217;s CSRF protection.
The default is false (CSRF protection is enabled).
It is highly recommended to leave CSRF protection enabled.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-csrf-token-repository-ref" href="#nsa-csrf-token-repository-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>token-repository-ref</strong></span>
The CsrfTokenRepository to use.
The default is <code class="literal">HttpSessionCsrfTokenRepository</code>.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-csrf-request-matcher-ref" href="#nsa-csrf-request-matcher-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>request-matcher-ref</strong></span>
The RequestMatcher instance to be used to determine if CSRF should be applied.
Default is any HTTP method except "GET", "TRACE", "HEAD", "OPTIONS".
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-custom-filter" href="#nsa-custom-filter"></a>&lt;custom-filter&gt;</h4></div></div></div>

<p>This element is used to add a filter to the filter chain.
It doesn&#8217;t create any additional beans but is used to select a bean of type <code class="literal">javax.servlet.Filter</code> which is already defined in the application context and add that at a particular position in the filter chain maintained by Spring Security.
Full details can be found in the <a class="link" href="ns-config.html#ns-custom-filters" title="7.3.6&nbsp;Adding in Your Own Filters">namespace chapter</a>.</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-custom-filter-parents" href="#nsa-custom-filter-parents"></a>Parent Elements of &lt;custom-filter&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-http" title="<http&gt;">http</a>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-custom-filter-attributes" href="#nsa-custom-filter-attributes"></a>&lt;custom-filter&gt; Attributes</h5></div></div></div>

<div class="itemizedlist"><a name="nsa-custom-filter-after" href="#nsa-custom-filter-after"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>after</strong></span>
The filter immediately after which the custom-filter should be placed in the chain.
This feature will only be needed by advanced users who wish to mix their own filters into the security filter chain and have some knowledge of the standard Spring Security filters.
The filter names map to specific Spring Security implementation filters.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-custom-filter-before" href="#nsa-custom-filter-before"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>before</strong></span>
The filter immediately before which the custom-filter should be placed in the chain
</li></ul></div>
<div class="itemizedlist"><a name="nsa-custom-filter-position" href="#nsa-custom-filter-position"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>position</strong></span>
The explicit position at which the custom-filter should be placed in the chain.
Use if you are replacing a standard filter.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-custom-filter-ref" href="#nsa-custom-filter-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>ref</strong></span>
Defines a reference to a Spring bean that implements <code class="literal">Filter</code>.
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-expression-handler" href="#nsa-expression-handler"></a>&lt;expression-handler&gt;</h4></div></div></div>

<p>Defines the <code class="literal">SecurityExpressionHandler</code> instance which will be used if expression-based access-control is enabled.
A default implementation (with no ACL support) will be used if not supplied.</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-expression-handler-parents" href="#nsa-expression-handler-parents"></a>Parent Elements of &lt;expression-handler&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-global-method-security" title="<global-method-security&gt;">global-method-security</a>
</li><li class="listitem">
<a class="link" href="appendix.html#nsa-http" title="<http&gt;">http</a>
</li><li class="listitem">
<a class="link" href="appendix.html#nsa-websocket-message-broker" title="<websocket-message-broker&gt;">websocket-message-broker</a>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-expression-handler-attributes" href="#nsa-expression-handler-attributes"></a>&lt;expression-handler&gt; Attributes</h5></div></div></div>

<div class="itemizedlist"><a name="nsa-expression-handler-ref" href="#nsa-expression-handler-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>ref</strong></span>
Defines a reference to a Spring bean that implements <code class="literal">SecurityExpressionHandler</code>.
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-form-login" href="#nsa-form-login"></a>&lt;form-login&gt;</h4></div></div></div>

<p>Used to add an <code class="literal">UsernamePasswordAuthenticationFilter</code> to the filter stack and an <code class="literal">LoginUrlAuthenticationEntryPoint</code> to the application context to provide authentication on demand.
This will always take precedence over other namespace-created entry points.
If no attributes are supplied, a login page will be generated automatically at the URL "/login" <a href="#ftn.d5e8055" class="footnote" name="d5e8055"><sup class="footnote">[23]</sup></a> The behaviour can be customized using the <a class="link" href="appendix.html#nsa-form-login-attributes" title="<form-login&gt; Attributes"><code class="literal">&lt;form-login&gt;</code> Attributes</a>.</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-form-login-parents" href="#nsa-form-login-parents"></a>Parent Elements of &lt;form-login&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-http" title="<http&gt;">http</a>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-form-login-attributes" href="#nsa-form-login-attributes"></a>&lt;form-login&gt; Attributes</h5></div></div></div>

<div class="itemizedlist"><a name="nsa-form-login-always-use-default-target" href="#nsa-form-login-always-use-default-target"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>always-use-default-target</strong></span>
If set to <code class="literal">true</code>, the user will always start at the value given by <a class="link" href="appendix.html#nsa-form-login-default-target-url">default-target-url</a>, regardless of how they arrived at the login page.
Maps to the <code class="literal">alwaysUseDefaultTargetUrl</code> property of <code class="literal">UsernamePasswordAuthenticationFilter</code>.
Default value is <code class="literal">false</code>.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-form-login-authentication-details-source-ref" href="#nsa-form-login-authentication-details-source-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>authentication-details-source-ref</strong></span>
Reference to an <code class="literal">AuthenticationDetailsSource</code> which will be used by the authentication filter
</li></ul></div>
<div class="itemizedlist"><a name="nsa-form-login-authentication-failure-handler-ref" href="#nsa-form-login-authentication-failure-handler-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>authentication-failure-handler-ref</strong></span>
Can be used as an alternative to <a class="link" href="appendix.html#nsa-form-login-authentication-failure-url">authentication-failure-url</a>, giving you full control over the navigation flow after an authentication failure.
The value should be the name of an <code class="literal">AuthenticationFailureHandler</code> bean in the application context.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-form-login-authentication-failure-url" href="#nsa-form-login-authentication-failure-url"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>authentication-failure-url</strong></span>
Maps to the <code class="literal">authenticationFailureUrl</code> property of <code class="literal">UsernamePasswordAuthenticationFilter</code>.
Defines the URL the browser will be redirected to on login failure.
Defaults to <code class="literal">/login?error</code>, which will be automatically handled by the automatic login page generator, re-rendering the login page with an error message.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-form-login-authentication-success-handler-ref" href="#nsa-form-login-authentication-success-handler-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>authentication-success-handler-ref</strong></span>
This can be used as an alternative to <a class="link" href="appendix.html#nsa-form-login-default-target-url">default-target-url</a> and <a class="link" href="appendix.html#nsa-form-login-always-use-default-target">always-use-default-target</a>, giving you full control over the navigation flow after a successful authentication.
The value should be the name of an <code class="literal">AuthenticationSuccessHandler</code> bean in the application context.
By default, an implementation of <code class="literal">SavedRequestAwareAuthenticationSuccessHandler</code> is used and injected with the <a class="link" href="appendix.html#nsa-form-login-default-target-url">default-target-url</a>.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-form-login-default-target-url" href="#nsa-form-login-default-target-url"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>default-target-url</strong></span>
Maps to the <code class="literal">defaultTargetUrl</code> property of <code class="literal">UsernamePasswordAuthenticationFilter</code>.
If not set, the default value is "/" (the application root).
A user will be taken to this URL after logging in, provided they were not asked to login while attempting to access a secured resource, when they will be taken to the originally requested URL.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-form-login-login-page" href="#nsa-form-login-login-page"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>login-page</strong></span>
The URL that should be used to render the login page.
Maps to the <code class="literal">loginFormUrl</code> property of the <code class="literal">LoginUrlAuthenticationEntryPoint</code>.
Defaults to "/login".
</li></ul></div>
<div class="itemizedlist"><a name="nsa-form-login-login-processing-url" href="#nsa-form-login-login-processing-url"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>login-processing-url</strong></span>
Maps to the <code class="literal">filterProcessesUrl</code> property of <code class="literal">UsernamePasswordAuthenticationFilter</code>.
The default value is "/login".
</li></ul></div>
<div class="itemizedlist"><a name="nsa-form-login-password-parameter" href="#nsa-form-login-password-parameter"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>password-parameter</strong></span>
The name of the request parameter which contains the password.
Defaults to "password".
</li></ul></div>
<div class="itemizedlist"><a name="nsa-form-login-username-parameter" href="#nsa-form-login-username-parameter"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>username-parameter</strong></span>
The name of the request parameter which contains the username.
Defaults to "username".
</li></ul></div>
<div class="itemizedlist"><a name="nsa-form-login-authentication-success-forward-url" href="#nsa-form-login-authentication-success-forward-url"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>authentication-success-forward-url</strong></span>
Maps a <code class="literal">ForwardAuthenticationSuccessHandler</code> to <code class="literal">authenticationSuccessHandler</code> property of <code class="literal">UsernamePasswordAuthenticationFilter</code>.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-form-login-authentication-failure-forward-url" href="#nsa-form-login-authentication-failure-forward-url"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>authentication-failure-forward-url</strong></span>
Maps a <code class="literal">ForwardAuthenticationFailureHandler</code> to <code class="literal">authenticationFailureHandler</code> property of <code class="literal">UsernamePasswordAuthenticationFilter</code>.
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-http-basic" href="#nsa-http-basic"></a>&lt;http-basic&gt;</h4></div></div></div>

<p>Adds a <code class="literal">BasicAuthenticationFilter</code> and <code class="literal">BasicAuthenticationEntryPoint</code> to the configuration.
The latter will only be used as the configuration entry point if form-based login is not enabled.</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-http-basic-parents" href="#nsa-http-basic-parents"></a>Parent Elements of &lt;http-basic&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-http" title="<http&gt;">http</a>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-http-basic-attributes" href="#nsa-http-basic-attributes"></a>&lt;http-basic&gt; Attributes</h5></div></div></div>

<div class="itemizedlist"><a name="nsa-http-basic-authentication-details-source-ref" href="#nsa-http-basic-authentication-details-source-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>authentication-details-source-ref</strong></span>
Reference to an <code class="literal">AuthenticationDetailsSource</code> which will be used by the authentication filter
</li></ul></div>
<div class="itemizedlist"><a name="nsa-http-basic-entry-point-ref" href="#nsa-http-basic-entry-point-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>entry-point-ref</strong></span>
Sets the <code class="literal">AuthenticationEntryPoint</code> which is used by the <code class="literal">BasicAuthenticationFilter</code>.
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-http-firewall" href="#nsa-http-firewall"></a>&lt;http-firewall&gt; Element</h4></div></div></div>

<p>This is a top-level element which can be used to inject a custom implementation of <code class="literal">HttpFirewall</code> into the <code class="literal">FilterChainProxy</code> created by the namespace.
The default implementation should be suitable for most applications.</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-http-firewall-attributes" href="#nsa-http-firewall-attributes"></a>&lt;http-firewall&gt; Attributes</h5></div></div></div>

<div class="itemizedlist"><a name="nsa-http-firewall-ref" href="#nsa-http-firewall-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>ref</strong></span>
Defines a reference to a Spring bean that implements <code class="literal">HttpFirewall</code>.
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-intercept-url" href="#nsa-intercept-url"></a>&lt;intercept-url&gt;</h4></div></div></div>

<p>This element is used to define the set of URL patterns that the application is interested in and to configure how they should be handled.
It is used to construct the <code class="literal">FilterInvocationSecurityMetadataSource</code> used by the <code class="literal">FilterSecurityInterceptor</code>.
It is also responsible for configuring a <code class="literal">ChannelProcessingFilter</code> if particular URLs need to be accessed by HTTPS, for example.
When matching the specified patterns against an incoming request, the matching is done in the order in which the elements are declared.
So the most specific patterns should come first and the most general should come last.</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-intercept-url-parents" href="#nsa-intercept-url-parents"></a>Parent Elements of &lt;intercept-url&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-filter-security-metadata-source" title="<filter-security-metadata-source&gt;">filter-security-metadata-source</a>
</li><li class="listitem">
<a class="link" href="appendix.html#nsa-http" title="<http&gt;">http</a>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-intercept-url-attributes" href="#nsa-intercept-url-attributes"></a>&lt;intercept-url&gt; Attributes</h5></div></div></div>

<div class="itemizedlist"><a name="nsa-intercept-url-access" href="#nsa-intercept-url-access"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>access</strong></span>
Lists the access attributes which will be stored in the <code class="literal">FilterInvocationSecurityMetadataSource</code> for the defined URL pattern/method combination.
This should be a comma-separated list of the security configuration attributes (such as role names).
</li></ul></div>
<div class="itemizedlist"><a name="nsa-intercept-url-filters" href="#nsa-intercept-url-filters"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>filters</strong></span>
Can only take the value "none".
This will cause any matching request to bypass the Spring Security filter chain entirely.
None of the rest of the <code class="literal">&lt;http&gt;</code> configuration will have any effect on the request and there will be no security context available for its duration.
Access to secured methods during the request will fail.
</li></ul></div>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
<p>This property is invalid for <a class="link" href="appendix.html#nsa-filter-security-metadata-source" title="<filter-security-metadata-source&gt;">filter-security-metadata-source</a></p>
</td></tr></table></div>
<div class="itemizedlist"><a name="nsa-intercept-url-method" href="#nsa-intercept-url-method"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>method</strong></span>
The HTTP Method which will be used in combination with the pattern and servlet path (optional) to match an incoming request.
If omitted, any method will match.
If an identical pattern is specified with and without a method, the method-specific match will take precedence.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-intercept-url-pattern" href="#nsa-intercept-url-pattern"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>pattern</strong></span>
The pattern which defines the URL path.
The content will depend on the <code class="literal">request-matcher</code> attribute from the containing http element, so will default to ant path syntax.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-intercept-url-request-matcher-ref" href="#nsa-intercept-url-request-matcher-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>request-matcher-ref</strong></span>
A reference to a <code class="literal">RequestMatcher</code> that will be used to determine if this <code class="literal">&lt;intercept-url&gt;</code> is used.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-intercept-url-requires-channel" href="#nsa-intercept-url-requires-channel"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>requires-channel</strong></span>
Can be "http" or "https" depending on whether a particular URL pattern should be accessed over HTTP or HTTPS respectively.
Alternatively the value "any" can be used when there is no preference.
If this attribute is present on any <code class="literal">&lt;intercept-url&gt;</code> element, then a <code class="literal">ChannelProcessingFilter</code> will be added to the filter stack and its additional dependencies added to the application context.
</li></ul></div>
<p>If a <code class="literal">&lt;port-mappings&gt;</code> configuration is added, this will be used to by the <code class="literal">SecureChannelProcessor</code> and <code class="literal">InsecureChannelProcessor</code> beans to determine the ports used for redirecting to HTTP/HTTPS.</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
<p>This property is invalid for <a class="link" href="appendix.html#nsa-filter-security-metadata-source" title="<filter-security-metadata-source&gt;">filter-security-metadata-source</a></p>
</td></tr></table></div>
<div class="itemizedlist"><a name="nsa-intercept-url-servlet-path" href="#nsa-intercept-url-servlet-path"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>servlet-path</strong></span>
The servlet path which will be used in combination with the pattern and HTTP method to match an incoming request.
This attribute is only applicable when <a class="link" href="appendix.html#nsa-http-request-matcher">request-matcher</a> is 'mvc'.
In addition, the value is only required in the following 2 use cases: 1) There are 2 or more <code class="literal">HttpServlet</code> 's registered in the <code class="literal">ServletContext</code> that have mappings starting with <code class="literal">'/'</code> and are different; 2) The pattern starts with the same value of a registered <code class="literal">HttpServlet</code> path, excluding the default (root) <code class="literal">HttpServlet</code> <code class="literal">'/'</code>.
</li></ul></div>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
<p>This property is invalid for <a class="link" href="appendix.html#nsa-filter-security-metadata-source" title="<filter-security-metadata-source&gt;">filter-security-metadata-source</a></p>
</td></tr></table></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-jee" href="#nsa-jee"></a>&lt;jee&gt;</h4></div></div></div>

<p>Adds a J2eePreAuthenticatedProcessingFilter to the filter chain to provide integration with container authentication.</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-jee-parents" href="#nsa-jee-parents"></a>Parent Elements of &lt;jee&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-http" title="<http&gt;">http</a>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-jee-attributes" href="#nsa-jee-attributes"></a>&lt;jee&gt; Attributes</h5></div></div></div>

<div class="itemizedlist"><a name="nsa-jee-mappable-roles" href="#nsa-jee-mappable-roles"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>mappable-roles</strong></span>
A comma-separate list of roles to look for in the incoming HttpServletRequest.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-jee-user-service-ref" href="#nsa-jee-user-service-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>user-service-ref</strong></span>
A reference to a user-service (or UserDetailsService bean) Id
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-logout" href="#nsa-logout"></a>&lt;logout&gt;</h4></div></div></div>

<p>Adds a <code class="literal">LogoutFilter</code> to the filter stack.
This is configured with a <code class="literal">SecurityContextLogoutHandler</code>.</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-logout-parents" href="#nsa-logout-parents"></a>Parent Elements of &lt;logout&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-http" title="<http&gt;">http</a>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-logout-attributes" href="#nsa-logout-attributes"></a>&lt;logout&gt; Attributes</h5></div></div></div>

<div class="itemizedlist"><a name="nsa-logout-delete-cookies" href="#nsa-logout-delete-cookies"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>delete-cookies</strong></span>
A comma-separated list of the names of cookies which should be deleted when the user logs out.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-logout-invalidate-session" href="#nsa-logout-invalidate-session"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>invalidate-session</strong></span>
Maps to the <code class="literal">invalidateHttpSession</code> of the <code class="literal">SecurityContextLogoutHandler</code>.
Defaults to "true", so the session will be invalidated on logout.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-logout-logout-success-url" href="#nsa-logout-logout-success-url"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<p class="simpara"><span class="strong"><strong>logout-success-url</strong></span>
The destination URL which the user will be taken to after logging out.
Defaults to &lt;form-login-login-page&gt;/?logout (i.e. /login?logout)</p>
<p class="simpara">Setting this attribute will inject the <code class="literal">SessionManagementFilter</code> with a <code class="literal">SimpleRedirectInvalidSessionStrategy</code> configured with the attribute value.
When an invalid session ID is submitted, the strategy will be invoked, redirecting to the configured URL.</p>
</li></ul></div>
<div class="itemizedlist"><a name="nsa-logout-logout-url" href="#nsa-logout-logout-url"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>logout-url</strong></span>
The URL which will cause a logout (i.e. which will be processed by the filter).
Defaults to "/logout".
</li></ul></div>
<div class="itemizedlist"><a name="nsa-logout-success-handler-ref" href="#nsa-logout-success-handler-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>success-handler-ref</strong></span>
May be used to supply an instance of <code class="literal">LogoutSuccessHandler</code> which will be invoked to control the navigation after logging out.
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-openid-login" href="#nsa-openid-login"></a>&lt;openid-login&gt;</h4></div></div></div>

<p>Similar to <code class="literal">&lt;form-login&gt;</code> and has the same attributes.
The default value for <code class="literal">login-processing-url</code> is "/login/openid".
An <code class="literal">OpenIDAuthenticationFilter</code> and <code class="literal">OpenIDAuthenticationProvider</code> will be registered.
The latter requires a reference to a <code class="literal">UserDetailsService</code>.
Again, this can be specified by <code class="literal">id</code>, using the <code class="literal">user-service-ref</code> attribute, or will be located automatically in the application context.</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-openid-login-parents" href="#nsa-openid-login-parents"></a>Parent Elements of &lt;openid-login&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-http" title="<http&gt;">http</a>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-openid-login-attributes" href="#nsa-openid-login-attributes"></a>&lt;openid-login&gt; Attributes</h5></div></div></div>

<div class="itemizedlist"><a name="nsa-openid-login-always-use-default-target" href="#nsa-openid-login-always-use-default-target"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>always-use-default-target</strong></span>
Whether the user should always be redirected to the default-target-url after login.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-openid-login-authentication-details-source-ref" href="#nsa-openid-login-authentication-details-source-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>authentication-details-source-ref</strong></span>
Reference to an AuthenticationDetailsSource which will be used by the authentication filter
</li></ul></div>
<div class="itemizedlist"><a name="nsa-openid-login-authentication-failure-handler-ref" href="#nsa-openid-login-authentication-failure-handler-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>authentication-failure-handler-ref</strong></span>
Reference to an AuthenticationFailureHandler bean which should be used to handle a failed authentication request.
Should not be used in combination with authentication-failure-url as the implementation should always deal with navigation to the subsequent destination
</li></ul></div>
<div class="itemizedlist"><a name="nsa-openid-login-authentication-failure-url" href="#nsa-openid-login-authentication-failure-url"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>authentication-failure-url</strong></span>
The URL for the login failure page.
If no login failure URL is specified, Spring Security will automatically create a failure login URL at /login?login_error and a corresponding filter to render that login failure URL when requested.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-openid-login-authentication-success-forward-url" href="#nsa-openid-login-authentication-success-forward-url"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>authentication-success-forward-url</strong></span>
Maps a <code class="literal">ForwardAuthenticationSuccessHandler</code> to <code class="literal">authenticationSuccessHandler</code> property of <code class="literal">UsernamePasswordAuthenticationFilter</code>.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-openid-login-authentication-failure-forward-url" href="#nsa-openid-login-authentication-failure-forward-url"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>authentication-failure-forward-url</strong></span>
Maps a <code class="literal">ForwardAuthenticationFailureHandler</code> to <code class="literal">authenticationFailureHandler</code> property of <code class="literal">UsernamePasswordAuthenticationFilter</code>.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-openid-login-authentication-success-handler-ref" href="#nsa-openid-login-authentication-success-handler-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>authentication-success-handler-ref</strong></span>
Reference to an AuthenticationSuccessHandler bean which should be used to handle a successful authentication request.
Should not be used in combination with <a class="link" href="appendix.html#nsa-openid-login-default-target-url">default-target-url</a> (or <a class="link" href="appendix.html#nsa-openid-login-always-use-default-target">always-use-default-target</a>) as the implementation should always deal with navigation to the subsequent destination
</li></ul></div>
<div class="itemizedlist"><a name="nsa-openid-login-default-target-url" href="#nsa-openid-login-default-target-url"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>default-target-url</strong></span>
The URL that will be redirected to after successful authentication, if the user&#8217;s previous action could not be resumed.
This generally happens if the user visits a login page without having first requested a secured operation that triggers authentication.
If unspecified, defaults to the root of the application.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-openid-login-login-page" href="#nsa-openid-login-login-page"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>login-page</strong></span>
The URL for the login page.
If no login URL is specified, Spring Security will automatically create a login URL at /login and a corresponding filter to render that login URL when requested.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-openid-login-login-processing-url" href="#nsa-openid-login-login-processing-url"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>login-processing-url</strong></span>
The URL that the login form is posted to.
If unspecified, it defaults to /login.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-openid-login-password-parameter" href="#nsa-openid-login-password-parameter"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>password-parameter</strong></span>
The name of the request parameter which contains the password.
Defaults to "password".
</li></ul></div>
<div class="itemizedlist"><a name="nsa-openid-login-user-service-ref" href="#nsa-openid-login-user-service-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>user-service-ref</strong></span>
A reference to a user-service (or UserDetailsService bean) Id
</li></ul></div>
<div class="itemizedlist"><a name="nsa-openid-login-username-parameter" href="#nsa-openid-login-username-parameter"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>username-parameter</strong></span>
The name of the request parameter which contains the username.
Defaults to "username".
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-openid-login-children" href="#nsa-openid-login-children"></a>Child Elements of &lt;openid-login&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-attribute-exchange" title="<attribute-exchange&gt;">attribute-exchange</a>
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-attribute-exchange" href="#nsa-attribute-exchange"></a>&lt;attribute-exchange&gt;</h4></div></div></div>

<p>The <code class="literal">attribute-exchange</code> element defines the list of attributes which should be requested from the identity provider.
An example can be found in the <a class="link" href="ns-config.html#ns-openid" title="7.3.4&nbsp;OpenID Support">OpenID Support</a> section of the namespace configuration chapter.
More than one can be used, in which case each must have an <code class="literal">identifier-match</code> attribute, containing a regular expression which is matched against the supplied OpenID identifier.
This allows different attribute lists to be fetched from different providers (Google, Yahoo etc).</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-attribute-exchange-parents" href="#nsa-attribute-exchange-parents"></a>Parent Elements of &lt;attribute-exchange&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-openid-login" title="<openid-login&gt;">openid-login</a>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-attribute-exchange-attributes" href="#nsa-attribute-exchange-attributes"></a>&lt;attribute-exchange&gt; Attributes</h5></div></div></div>

<div class="itemizedlist"><a name="nsa-attribute-exchange-identifier-match" href="#nsa-attribute-exchange-identifier-match"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>identifier-match</strong></span>
A regular expression which will be compared against the claimed identity, when deciding which attribute-exchange configuration to use during authentication.
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-attribute-exchange-children" href="#nsa-attribute-exchange-children"></a>Child Elements of &lt;attribute-exchange&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-openid-attribute" title="<openid-attribute&gt;">openid-attribute</a>
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-openid-attribute" href="#nsa-openid-attribute"></a>&lt;openid-attribute&gt;</h4></div></div></div>

<p>Attributes used when making an OpenID AX <a class="ulink" href="http://openid.net/specs/openid-attribute-exchange-1_0.html#fetch_request" target="_top"> Fetch Request</a></p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-openid-attribute-parents" href="#nsa-openid-attribute-parents"></a>Parent Elements of &lt;openid-attribute&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-attribute-exchange" title="<attribute-exchange&gt;">attribute-exchange</a>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-openid-attribute-attributes" href="#nsa-openid-attribute-attributes"></a>&lt;openid-attribute&gt; Attributes</h5></div></div></div>

<div class="itemizedlist"><a name="nsa-openid-attribute-count" href="#nsa-openid-attribute-count"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>count</strong></span>
Specifies the number of attributes that you wish to get back.
For example, return 3 emails.
The default value is 1.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-openid-attribute-name" href="#nsa-openid-attribute-name"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>name</strong></span>
Specifies the name of the attribute that you wish to get back.
For example, email.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-openid-attribute-required" href="#nsa-openid-attribute-required"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>required</strong></span>
Specifies if this attribute is required to the OP, but does not error out if the OP does not return the attribute.
Default is false.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-openid-attribute-type" href="#nsa-openid-attribute-type"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>type</strong></span>
Specifies the attribute type.
For example, <a class="ulink" href="http://axschema.org/contact/email" target="_top">http://axschema.org/contact/email</a>.
See your OP&#8217;s documentation for valid attribute types.
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-port-mappings" href="#nsa-port-mappings"></a>&lt;port-mappings&gt;</h4></div></div></div>

<p>By default, an instance of <code class="literal">PortMapperImpl</code> will be added to the configuration for use in redirecting to secure and insecure URLs.
This element can optionally be used to override the default mappings which that class defines.
Each child <code class="literal">&lt;port-mapping&gt;</code> element defines a pair of HTTP:HTTPS ports.
The default mappings are 80:443 and 8080:8443.
An example of overriding these can be found in the <a class="link" href="ns-config.html#ns-requires-channel" title="7.3.2&nbsp;Adding HTTP/HTTPS Channel Security">namespace introduction</a>.</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-port-mappings-parents" href="#nsa-port-mappings-parents"></a>Parent Elements of &lt;port-mappings&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-http" title="<http&gt;">http</a>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-port-mappings-children" href="#nsa-port-mappings-children"></a>Child Elements of &lt;port-mappings&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-port-mapping" title="<port-mapping&gt;">port-mapping</a>
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-port-mapping" href="#nsa-port-mapping"></a>&lt;port-mapping&gt;</h4></div></div></div>

<p>Provides a method to map http ports to https ports when forcing a redirect.</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-port-mapping-parents" href="#nsa-port-mapping-parents"></a>Parent Elements of &lt;port-mapping&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-port-mappings" title="<port-mappings&gt;">port-mappings</a>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-port-mapping-attributes" href="#nsa-port-mapping-attributes"></a>&lt;port-mapping&gt; Attributes</h5></div></div></div>

<div class="itemizedlist"><a name="nsa-port-mapping-http" href="#nsa-port-mapping-http"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>http</strong></span>
The http port to use.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-port-mapping-https" href="#nsa-port-mapping-https"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>https</strong></span>
The https port to use.
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-remember-me" href="#nsa-remember-me"></a>&lt;remember-me&gt;</h4></div></div></div>

<p>Adds the <code class="literal">RememberMeAuthenticationFilter</code> to the stack.
This in turn will be configured with either a <code class="literal">TokenBasedRememberMeServices</code>, a <code class="literal">PersistentTokenBasedRememberMeServices</code> or a user-specified bean implementing <code class="literal">RememberMeServices</code> depending on the attribute settings.</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-remember-me-parents" href="#nsa-remember-me-parents"></a>Parent Elements of &lt;remember-me&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-http" title="<http&gt;">http</a>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-remember-me-attributes" href="#nsa-remember-me-attributes"></a>&lt;remember-me&gt; Attributes</h5></div></div></div>

<div class="itemizedlist"><a name="nsa-remember-me-authentication-success-handler-ref" href="#nsa-remember-me-authentication-success-handler-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>authentication-success-handler-ref</strong></span>
Sets the <code class="literal">authenticationSuccessHandler</code> property on the <code class="literal">RememberMeAuthenticationFilter</code> if custom navigation is required.
The value should be the name of a <code class="literal">AuthenticationSuccessHandler</code> bean in the application context.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-remember-me-data-source-ref" href="#nsa-remember-me-data-source-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>data-source-ref</strong></span>
A reference to a <code class="literal">DataSource</code> bean.
If this is set, <code class="literal">PersistentTokenBasedRememberMeServices</code> will be used and configured with a <code class="literal">JdbcTokenRepositoryImpl</code> instance.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-remember-me-remember-me-parameter" href="#nsa-remember-me-remember-me-parameter"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>remember-me-parameter</strong></span>
The name of the request parameter which toggles remember-me authentication.
Defaults to "remember-me".
Maps to the "parameter" property of <code class="literal">AbstractRememberMeServices</code>.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-remember-me-remember-me-cookie" href="#nsa-remember-me-remember-me-cookie"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>remember-me-cookie</strong></span>
The name of cookie which store the token for remember-me authentication.
Defaults to "remember-me".
Maps to the "cookieName" property of <code class="literal">AbstractRememberMeServices</code>.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-remember-me-key" href="#nsa-remember-me-key"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>key</strong></span>
Maps to the "key" property of <code class="literal">AbstractRememberMeServices</code>.
Should be set to a unique value to ensure that remember-me cookies are only valid within the one application <a href="#ftn.d5e8528" class="footnote" name="d5e8528"><sup class="footnote">[24]</sup></a>.
If this is not set a secure random value will be generated.
Since generating secure random values can take a while, setting this value explicitly can help improve startup times when using the remember-me functionality.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-remember-me-services-alias" href="#nsa-remember-me-services-alias"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>services-alias</strong></span>
Exports the internally defined <code class="literal">RememberMeServices</code> as a bean alias, allowing it to be used by other beans in the application context.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-remember-me-services-ref" href="#nsa-remember-me-services-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>services-ref</strong></span>
Allows complete control of the <code class="literal">RememberMeServices</code> implementation that will be used by the filter.
The value should be the <code class="literal">id</code> of a bean in the application context which implements this interface.
Should also implement <code class="literal">LogoutHandler</code> if a logout filter is in use.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-remember-me-token-repository-ref" href="#nsa-remember-me-token-repository-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>token-repository-ref</strong></span>
Configures a <code class="literal">PersistentTokenBasedRememberMeServices</code> but allows the use of a custom <code class="literal">PersistentTokenRepository</code> bean.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-remember-me-token-validity-seconds" href="#nsa-remember-me-token-validity-seconds"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>token-validity-seconds</strong></span>
Maps to the <code class="literal">tokenValiditySeconds</code> property of <code class="literal">AbstractRememberMeServices</code>.
Specifies the period in seconds for which the remember-me cookie should be valid.
By default it will be valid for 14 days.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-remember-me-use-secure-cookie" href="#nsa-remember-me-use-secure-cookie"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>use-secure-cookie</strong></span>
It is recommended that remember-me cookies are only submitted over HTTPS and thus should be flagged as "secure".
By default, a secure cookie will be used if the connection over which the login request is made is secure (as it should be).
If you set this property to <code class="literal">false</code>, secure cookies will not be used.
Setting it to <code class="literal">true</code> will always set the secure flag on the cookie.
This attribute maps to the <code class="literal">useSecureCookie</code> property of <code class="literal">AbstractRememberMeServices</code>.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-remember-me-user-service-ref" href="#nsa-remember-me-user-service-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>user-service-ref</strong></span>
The remember-me services implementations require access to a <code class="literal">UserDetailsService</code>, so there has to be one defined in the application context.
If there is only one, it will be selected and used automatically by the namespace configuration.
If there are multiple instances, you can specify a bean <code class="literal">id</code> explicitly using this attribute.
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-request-cache" href="#nsa-request-cache"></a>&lt;request-cache&gt; Element</h4></div></div></div>

<p>Sets the <code class="literal">RequestCache</code> instance which will be used by the <code class="literal">ExceptionTranslationFilter</code> to store request information before invoking an <code class="literal">AuthenticationEntryPoint</code>.</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-request-cache-parents" href="#nsa-request-cache-parents"></a>Parent Elements of &lt;request-cache&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-http" title="<http&gt;">http</a>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-request-cache-attributes" href="#nsa-request-cache-attributes"></a>&lt;request-cache&gt; Attributes</h5></div></div></div>

<div class="itemizedlist"><a name="nsa-request-cache-ref" href="#nsa-request-cache-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>ref</strong></span>
Defines a reference to a Spring bean that is a <code class="literal">RequestCache</code>.
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-session-management" href="#nsa-session-management"></a>&lt;session-management&gt;</h4></div></div></div>

<p>Session-management related functionality is implemented by the addition of a <code class="literal">SessionManagementFilter</code> to the filter stack.</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-session-management-parents" href="#nsa-session-management-parents"></a>Parent Elements of &lt;session-management&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-http" title="<http&gt;">http</a>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-session-management-attributes" href="#nsa-session-management-attributes"></a>&lt;session-management&gt; Attributes</h5></div></div></div>

<div class="itemizedlist"><a name="nsa-session-management-invalid-session-url" href="#nsa-session-management-invalid-session-url"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>invalid-session-url</strong></span>
Setting this attribute will inject the <code class="literal">SessionManagementFilter</code> with a <code class="literal">SimpleRedirectInvalidSessionStrategy</code> configured with the attribute value.
When an invalid session ID is submitted, the strategy will be invoked, redirecting to the configured URL.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-session-management-invalid-session-strategy-ref" href="#nsa-session-management-invalid-session-strategy-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>invalid-session-url</strong></span>
Allows injection of the InvalidSessionStrategy instance used by the SessionManagementFilter.
Use either this or the <code class="literal">invalid-session-url</code> attribute but not both.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-session-management-session-authentication-error-url" href="#nsa-session-management-session-authentication-error-url"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>session-authentication-error-url</strong></span>
Defines the URL of the error page which should be shown when the SessionAuthenticationStrategy raises an exception.
If not set, an unauthorized (401) error code will be returned to the client.
Note that this attribute doesn&#8217;t apply if the error occurs during a form-based login, where the URL for authentication failure will take precedence.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-session-management-session-authentication-strategy-ref" href="#nsa-session-management-session-authentication-strategy-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>session-authentication-strategy-ref</strong></span>
Allows injection of the SessionAuthenticationStrategy instance used by the SessionManagementFilter
</li></ul></div>
<div class="itemizedlist"><a name="nsa-session-management-session-fixation-protection" href="#nsa-session-management-session-fixation-protection"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<p class="simpara"><span class="strong"><strong>session-fixation-protection</strong></span>
Indicates how session fixation protection will be applied when a user authenticates.
If set to "none", no protection will be applied.
"newSession" will create a new empty session, with only Spring Security-related attributes migrated.
"migrateSession" will create a new session and copy all session attributes to the new session.
In Servlet 3.1 (Java EE 7) and newer containers, specifying "changeSessionId" will keep the existing session and use the container-supplied session fixation protection (HttpServletRequest#changeSessionId()).
Defaults to "changeSessionId" in Servlet 3.1 and newer containers, "migrateSession" in older containers.
Throws an exception if "changeSessionId" is used in older containers.</p>
<p class="simpara">If session fixation protection is enabled, the <code class="literal">SessionManagementFilter</code> is injected with an appropriately configured <code class="literal">DefaultSessionAuthenticationStrategy</code>.
See the Javadoc for this class for more details.</p>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-session-management-children" href="#nsa-session-management-children"></a>Child Elements of &lt;session-management&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-concurrency-control" title="<concurrency-control&gt;">concurrency-control</a>
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-concurrency-control" href="#nsa-concurrency-control"></a>&lt;concurrency-control&gt;</h4></div></div></div>

<p>Adds support for concurrent session control, allowing limits to be placed on the number of active sessions a user can have.
A <code class="literal">ConcurrentSessionFilter</code> will be created, and a <code class="literal">ConcurrentSessionControlAuthenticationStrategy</code> will be used with the <code class="literal">SessionManagementFilter</code>.
If a <code class="literal">form-login</code> element has been declared, the strategy object will also be injected into the created authentication filter.
An instance of <code class="literal">SessionRegistry</code> (a <code class="literal">SessionRegistryImpl</code> instance unless the user wishes to use a custom bean) will be created for use by the strategy.</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-concurrency-control-parents" href="#nsa-concurrency-control-parents"></a>Parent Elements of &lt;concurrency-control&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-session-management" title="<session-management&gt;">session-management</a>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-concurrency-control-attributes" href="#nsa-concurrency-control-attributes"></a>&lt;concurrency-control&gt; Attributes</h5></div></div></div>

<div class="itemizedlist"><a name="nsa-concurrency-control-error-if-maximum-exceeded" href="#nsa-concurrency-control-error-if-maximum-exceeded"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>error-if-maximum-exceeded</strong></span>
If set to "true" a <code class="literal">SessionAuthenticationException</code> will be raised when a user attempts to exceed the maximum allowed number of sessions.
The default behaviour is to expire the original session.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-concurrency-control-expired-url" href="#nsa-concurrency-control-expired-url"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>expired-url</strong></span>
The URL a user will be redirected to if they attempt to use a session which has been "expired" by the concurrent session controller because the user has exceeded the number of allowed sessions and has logged in again elsewhere.
Should be set unless <code class="literal">exception-if-maximum-exceeded</code> is set.
If no value is supplied, an expiry message will just be written directly back to the response.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-concurrency-control-expired-session-strategy-ref" href="#nsa-concurrency-control-expired-session-strategy-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>expired-url</strong></span>
Allows injection of the ExpiredSessionStrategy instance used by the ConcurrentSessionFilter
</li></ul></div>
<div class="itemizedlist"><a name="nsa-concurrency-control-max-sessions" href="#nsa-concurrency-control-max-sessions"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>max-sessions</strong></span>
Maps to the <code class="literal">maximumSessions</code> property of <code class="literal">ConcurrentSessionControlAuthenticationStrategy</code>.
Specify <code class="literal">-1</code> as the value to support unlimited sessions.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-concurrency-control-session-registry-alias" href="#nsa-concurrency-control-session-registry-alias"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>session-registry-alias</strong></span>
It can also be useful to have a reference to the internal session registry for use in your own beans or an admin interface.
You can expose the internal bean using the <code class="literal">session-registry-alias</code> attribute, giving it a name that you can use elsewhere in your configuration.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-concurrency-control-session-registry-ref" href="#nsa-concurrency-control-session-registry-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>session-registry-ref</strong></span>
The user can supply their own <code class="literal">SessionRegistry</code> implementation using the <code class="literal">session-registry-ref</code> attribute.
The other concurrent session control beans will be wired up to use it.
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-x509" href="#nsa-x509"></a>&lt;x509&gt;</h4></div></div></div>

<p>Adds support for X.509 authentication.
An <code class="literal">X509AuthenticationFilter</code> will be added to the stack and an <code class="literal">Http403ForbiddenEntryPoint</code> bean will be created.
The latter will only be used if no other authentication mechanisms are in use (its only functionality is to return an HTTP 403 error code).
A <code class="literal">PreAuthenticatedAuthenticationProvider</code> will also be created which delegates the loading of user authorities to a <code class="literal">UserDetailsService</code>.</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-x509-parents" href="#nsa-x509-parents"></a>Parent Elements of &lt;x509&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-http" title="<http&gt;">http</a>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-x509-attributes" href="#nsa-x509-attributes"></a>&lt;x509&gt; Attributes</h5></div></div></div>

<div class="itemizedlist"><a name="nsa-x509-authentication-details-source-ref" href="#nsa-x509-authentication-details-source-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>authentication-details-source-ref</strong></span>
A reference to an <code class="literal">AuthenticationDetailsSource</code>
</li></ul></div>
<div class="itemizedlist"><a name="nsa-x509-subject-principal-regex" href="#nsa-x509-subject-principal-regex"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>subject-principal-regex</strong></span>
Defines a regular expression which will be used to extract the username from the certificate (for use with the <code class="literal">UserDetailsService</code>).
</li></ul></div>
<div class="itemizedlist"><a name="nsa-x509-user-service-ref" href="#nsa-x509-user-service-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>user-service-ref</strong></span>
Allows a specific <code class="literal">UserDetailsService</code> to be used with X.509 in the case where multiple instances are configured.
If not set, an attempt will be made to locate a suitable instance automatically and use that.
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-filter-chain-map" href="#nsa-filter-chain-map"></a>&lt;filter-chain-map&gt;</h4></div></div></div>

<p>Used to explicitly configure a FilterChainProxy instance with a FilterChainMap</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-filter-chain-map-attributes" href="#nsa-filter-chain-map-attributes"></a>&lt;filter-chain-map&gt; Attributes</h5></div></div></div>

<div class="itemizedlist"><a name="nsa-filter-chain-map-request-matcher" href="#nsa-filter-chain-map-request-matcher"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>request-matcher</strong></span>
Defines the strategy to use for matching incoming requests.
Currently the options are 'ant' (for ant path patterns), 'regex' for regular expressions and 'ciRegex' for case-insensitive regular expressions.
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-filter-chain-map-children" href="#nsa-filter-chain-map-children"></a>Child Elements of &lt;filter-chain-map&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-filter-chain" title="<filter-chain&gt;">filter-chain</a>
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-filter-chain" href="#nsa-filter-chain"></a>&lt;filter-chain&gt;</h4></div></div></div>

<p>Used within to define a specific URL pattern and the list of filters which apply to the URLs matching that pattern.
When multiple filter-chain elements are assembled in a list in order to configure a FilterChainProxy, the most specific patterns must be placed at the top of the list, with most general ones at the bottom.</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-filter-chain-parents" href="#nsa-filter-chain-parents"></a>Parent Elements of &lt;filter-chain&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-filter-chain-map" title="<filter-chain-map&gt;">filter-chain-map</a>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-filter-chain-attributes" href="#nsa-filter-chain-attributes"></a>&lt;filter-chain&gt; Attributes</h5></div></div></div>

<div class="itemizedlist"><a name="nsa-filter-chain-filters" href="#nsa-filter-chain-filters"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>filters</strong></span>
A comma separated list of references to Spring beans that implement <code class="literal">Filter</code>.
The value "none" means that no <code class="literal">Filter</code> should be used for this <code class="literal">FilterChain</code>.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-filter-chain-pattern" href="#nsa-filter-chain-pattern"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>pattern</strong></span>
A pattern that creates RequestMatcher in combination with the <a class="link" href="appendix.html#nsa-filter-chain-map-request-matcher">request-matcher</a>
</li></ul></div>
<div class="itemizedlist"><a name="nsa-filter-chain-request-matcher-ref" href="#nsa-filter-chain-request-matcher-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>request-matcher-ref</strong></span>
A reference to a <code class="literal">RequestMatcher</code> that will be used to determine if any <code class="literal">Filter</code> from the <code class="literal">filters</code> attribute should be invoked.
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-filter-security-metadata-source" href="#nsa-filter-security-metadata-source"></a>&lt;filter-security-metadata-source&gt;</h4></div></div></div>

<p>Used to explicitly configure a FilterSecurityMetadataSource bean for use with a FilterSecurityInterceptor.
Usually only needed if you are configuring a FilterChainProxy explicitly, rather than using the&lt;http&gt; element.
The intercept-url elements used should only contain pattern, method and access attributes.
Any others will result in a configuration error.</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-filter-security-metadata-source-attributes" href="#nsa-filter-security-metadata-source-attributes"></a>&lt;filter-security-metadata-source&gt; Attributes</h5></div></div></div>

<div class="itemizedlist"><a name="nsa-filter-security-metadata-source-id" href="#nsa-filter-security-metadata-source-id"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>id</strong></span>
A bean identifier, used for referring to the bean elsewhere in the context.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-filter-security-metadata-source-request-matcher" href="#nsa-filter-security-metadata-source-request-matcher"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>request-matcher</strong></span>
Defines the strategy use for matching incoming requests.
Currently the options are 'ant' (for ant path patterns), 'regex' for regular expressions and 'ciRegex' for case-insensitive regular expressions.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-filter-security-metadata-source-use-expressions" href="#nsa-filter-security-metadata-source-use-expressions"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>use-expressions</strong></span>
Enables the use of expressions in the 'access' attributes in &lt;intercept-url&gt; elements rather than the traditional list of configuration attributes.
Defaults to 'true'.
If enabled, each attribute should contain a single Boolean expression.
If the expression evaluates to 'true', access will be granted.
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-filter-security-metadata-source-children" href="#nsa-filter-security-metadata-source-children"></a>Child Elements of &lt;filter-security-metadata-source&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-intercept-url" title="<intercept-url&gt;">intercept-url</a>
</li></ul></div>
</div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="nsa-websocket-security" href="#nsa-websocket-security"></a>15.2.2&nbsp;WebSocket Security</h3></div></div></div>

<p>Spring Security 4.0+ provides support for authorizing messages.
One concrete example of where this is useful is to provide authorization in WebSocket based applications.</p>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-websocket-message-broker" href="#nsa-websocket-message-broker"></a>&lt;websocket-message-broker&gt;</h4></div></div></div>

<p>The websocket-message-broker element has two different modes.
If the <a class="link" href="appendix.html#nsa-websocket-message-broker-id">websocket-message-broker@id</a> is not specified, then it will do the following things:</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
Ensure that any SimpAnnotationMethodMessageHandler has the AuthenticationPrincipalArgumentResolver registered as a custom argument resolver.
This allows the use of <code class="literal">@AuthenticationPrincipal</code> to resolve the principal of the current <code class="literal">Authentication</code>
</li><li class="listitem">
Ensures that the SecurityContextChannelInterceptor is automatically registered for the clientInboundChannel.
This populates the SecurityContextHolder with the user that is found in the Message
</li><li class="listitem">
Ensures that a ChannelSecurityInterceptor is registered with the clientInboundChannel.
This allows authorization rules to be specified for a message.
</li><li class="listitem">
Ensures that a CsrfChannelInterceptor is registered with the clientInboundChannel.
This ensures that only requests from the original domain are enabled.
</li><li class="listitem">
Ensures that a CsrfTokenHandshakeInterceptor is registered with WebSocketHttpRequestHandler, TransportHandlingSockJsService, or DefaultSockJsService.
This ensures that the expected CsrfToken from the HttpServletRequest is copied into the WebSocket Session attributes.
</li></ul></div>
<p>If additional control is necessary, the id can be specified and a ChannelSecurityInterceptor will be assigned to the specified id.
All the wiring with Spring&#8217;s messaging infrastructure can then be done manually.
This is more cumbersome, but provides greater control over the configuration.</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-websocket-message-broker-attributes" href="#nsa-websocket-message-broker-attributes"></a>&lt;websocket-message-broker&gt; Attributes</h5></div></div></div>

<div class="itemizedlist"><a name="nsa-websocket-message-broker-id" href="#nsa-websocket-message-broker-id"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>id</strong></span> A bean identifier, used for referring to the ChannelSecurityInterceptor bean elsewhere in the context.
If specified, Spring Security requires explicit configuration within Spring Messaging.
If not specified, Spring Security will automatically integrate with the messaging infrastructure as described in <a class="xref" href="appendix.html#nsa-websocket-message-broker" title="<websocket-message-broker&gt;">the section called &#8220;&lt;websocket-message-broker&gt;&#8221;</a>
</li></ul></div>
<div class="itemizedlist"><a name="nsa-websocket-message-broker-same-origin-disabled" href="#nsa-websocket-message-broker-same-origin-disabled"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>same-origin-disabled</strong></span> Disables the requirement for CSRF token to be present in the Stomp headers (default false).
Changing the default is useful if it is necessary to allow other origins to make SockJS connections.
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-websocket-message-broker-children" href="#nsa-websocket-message-broker-children"></a>Child Elements of &lt;websocket-message-broker&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-expression-handler" title="<expression-handler&gt;">expression-handler</a>
</li><li class="listitem">
<a class="link" href="appendix.html#nsa-intercept-message" title="<intercept-message&gt;">intercept-message</a>
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-intercept-message" href="#nsa-intercept-message"></a>&lt;intercept-message&gt;</h4></div></div></div>

<p>Defines an authorization rule for a message.</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-intercept-message-parents" href="#nsa-intercept-message-parents"></a>Parent Elements of &lt;intercept-message&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-websocket-message-broker" title="<websocket-message-broker&gt;">websocket-message-broker</a>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-intercept-message-attributes" href="#nsa-intercept-message-attributes"></a>&lt;intercept-message&gt; Attributes</h5></div></div></div>

<div class="itemizedlist"><a name="nsa-intercept-message-pattern" href="#nsa-intercept-message-pattern"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>pattern</strong></span> An ant based pattern that matches on the Message destination.
For example, "/<span class="strong"><strong>" matches any Message with a destination; "/admin/</strong></span>" matches any Message that has a destination that starts with "/admin/**".
</li></ul></div>
<div class="itemizedlist"><a name="nsa-intercept-message-type" href="#nsa-intercept-message-type"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>type</strong></span> The type of message to match on.
Valid values are defined in SimpMessageType (i.e. CONNECT, CONNECT_ACK, HEARTBEAT, MESSAGE, SUBSCRIBE, UNSUBSCRIBE, DISCONNECT, DISCONNECT_ACK, OTHER).
</li></ul></div>
<div class="itemizedlist"><a name="nsa-intercept-message-access" href="#nsa-intercept-message-access"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>access</strong></span> The expression used to secure the Message.
For example, "denyAll" will deny access to all of the matching Messages; "permitAll" will grant access to all of the matching Messages; "hasRole('ADMIN') requires the current user to have the role 'ROLE_ADMIN' for the matching Messages.
</li></ul></div>
</div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="nsa-authentication" href="#nsa-authentication"></a>15.2.3&nbsp;Authentication Services</h3></div></div></div>

<p>Before Spring Security 3.0, an <code class="literal">AuthenticationManager</code> was automatically registered internally.
Now you must register one explicitly using the <code class="literal">&lt;authentication-manager&gt;</code> element.
This creates an instance of Spring Security&#8217;s <code class="literal">ProviderManager</code> class, which needs to be configured with a list of one or more <code class="literal">AuthenticationProvider</code> instances.
These can either be created using syntax elements provided by the namespace, or they can be standard bean definitions, marked for addition to the list using the <code class="literal">authentication-provider</code> element.</p>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-authentication-manager" href="#nsa-authentication-manager"></a>&lt;authentication-manager&gt;</h4></div></div></div>

<p>Every Spring Security application which uses the namespace must have include this element somewhere.
It is responsible for registering the <code class="literal">AuthenticationManager</code> which provides authentication services to the application.
All elements which create <code class="literal">AuthenticationProvider</code> instances should be children of this element.</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-authentication-manager-attributes" href="#nsa-authentication-manager-attributes"></a>&lt;authentication-manager&gt; Attributes</h5></div></div></div>

<div class="itemizedlist"><a name="nsa-authentication-manager-alias" href="#nsa-authentication-manager-alias"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>alias</strong></span>
This attribute allows you to define an alias name for the internal instance for use in your own configuration.
Its use is described in the<a class="link" href="ns-config.html#ns-auth-manager" title="7.6&nbsp;The Authentication Manager and the Namespace">namespace introduction</a>.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-authentication-manager-erase-credentials" href="#nsa-authentication-manager-erase-credentials"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>erase-credentials</strong></span>
If set to true, the AuthenticationManager will attempt to clear any credentials data in the returned Authentication object, once the user has been authenticated.
Literally it maps to the <code class="literal">eraseCredentialsAfterAuthentication</code> property of the <code class="literal">ProviderManager</code>.
This is discussed in the <a class="link" href="overall-architecture.html#core-services-erasing-credentials" title="Erasing Credentials on Successful Authentication">Core Services</a> chapter.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-authentication-manager-id" href="#nsa-authentication-manager-id"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>id</strong></span>
This attribute allows you to define an id for the internal instance for use in your own configuration.
It is the same as the alias element, but provides a more consistent experience with elements that use the id attribute.
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-authentication-manager-children" href="#nsa-authentication-manager-children"></a>Child Elements of &lt;authentication-manager&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-authentication-provider" title="<authentication-provider&gt;">authentication-provider</a>
</li><li class="listitem">
<a class="link" href="appendix.html#nsa-ldap-authentication-provider" title="<ldap-authentication-provider&gt;">ldap-authentication-provider</a>
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-authentication-provider" href="#nsa-authentication-provider"></a>&lt;authentication-provider&gt;</h4></div></div></div>

<p>Unless used with a <code class="literal">ref</code> attribute, this element is shorthand for configuring a <a class="link" href="overall-architecture.html#core-services-dao-provider" title="DaoAuthenticationProvider">DaoAuthenticationProvider</a>.
<code class="literal">DaoAuthenticationProvider</code> loads user information from a <code class="literal">UserDetailsService</code> and compares the username/password combination with the values supplied at login.
The <code class="literal">UserDetailsService</code> instance can be defined either by using an available namespace element (<code class="literal">jdbc-user-service</code> or by using the <code class="literal">user-service-ref</code> attribute to point to a bean defined elsewhere in the application context).
You can find examples of these variations in the <a class="link" href="ns-config.html#ns-auth-providers" title="7.2.5&nbsp;Using other Authentication Providers">namespace introduction</a>.</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-authentication-provider-parents" href="#nsa-authentication-provider-parents"></a>Parent Elements of &lt;authentication-provider&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-authentication-manager" title="<authentication-manager&gt;">authentication-manager</a>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-authentication-provider-attributes" href="#nsa-authentication-provider-attributes"></a>&lt;authentication-provider&gt; Attributes</h5></div></div></div>

<div class="itemizedlist"><a name="nsa-authentication-provider-ref" href="#nsa-authentication-provider-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>ref</strong></span>
Defines a reference to a Spring bean that implements <code class="literal">AuthenticationProvider</code>.
</li></ul></div>
<p>If you have written your own <code class="literal">AuthenticationProvider</code> implementation (or want to configure one of Spring Security&#8217;s own implementations as a traditional bean for some reason, then you can use the following syntax to add it to the internal list of <code class="literal">ProviderManager</code>:</p>
<pre class="programlisting"><span class="hl-tag">&lt;security:authentication-manager&gt;</span>
<span class="hl-tag">&lt;security:authentication-provider</span> <span class="hl-attribute">ref</span>=<span class="hl-value">"myAuthenticationProvider"</span><span class="hl-tag"> /&gt;</span>
<span class="hl-tag">&lt;/security:authentication-manager&gt;</span>
<span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"myAuthenticationProvider"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"com.something.MyAuthenticationProvider"</span><span class="hl-tag">/&gt;</span></pre>
<div class="itemizedlist"><a name="nsa-authentication-provider-user-service-ref" href="#nsa-authentication-provider-user-service-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>user-service-ref</strong></span>
A reference to a bean that implements UserDetailsService that may be created using the standard bean element or the custom user-service element.
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-authentication-provider-children" href="#nsa-authentication-provider-children"></a>Child Elements of &lt;authentication-provider&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-jdbc-user-service" title="<jdbc-user-service&gt;">jdbc-user-service</a>
</li><li class="listitem">
<a class="link" href="appendix.html#nsa-ldap-user-service" title="<ldap-user-service&gt;">ldap-user-service</a>
</li><li class="listitem">
<a class="link" href="appendix.html#nsa-password-encoder" title="<password-encoder&gt;">password-encoder</a>
</li><li class="listitem">
<a class="link" href="appendix.html#nsa-user-service" title="<user-service&gt;">user-service</a>
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-jdbc-user-service" href="#nsa-jdbc-user-service"></a>&lt;jdbc-user-service&gt;</h4></div></div></div>

<p>Causes creation of a JDBC-based UserDetailsService.</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-jdbc-user-service-attributes" href="#nsa-jdbc-user-service-attributes"></a>&lt;jdbc-user-service&gt; Attributes</h5></div></div></div>

<div class="itemizedlist"><a name="nsa-jdbc-user-service-authorities-by-username-query" href="#nsa-jdbc-user-service-authorities-by-username-query"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>authorities-by-username-query</strong></span>
An SQL statement to query for a user&#8217;s granted authorities given a username.
</li></ul></div>
<p>The default is</p>
<pre class="screen">select username, authority from authorities where username = ?</pre>
<div class="itemizedlist"><a name="nsa-jdbc-user-service-cache-ref" href="#nsa-jdbc-user-service-cache-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>cache-ref</strong></span>
Defines a reference to a cache for use with a UserDetailsService.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-jdbc-user-service-data-source-ref" href="#nsa-jdbc-user-service-data-source-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>data-source-ref</strong></span>
The bean ID of the DataSource which provides the required tables.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-jdbc-user-service-group-authorities-by-username-query" href="#nsa-jdbc-user-service-group-authorities-by-username-query"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<p class="simpara"><span class="strong"><strong>group-authorities-by-username-query</strong></span>
An SQL statement to query user&#8217;s group authorities given a username.
The default is</p>
<pre class="screen">select
g.id, g.group_name, ga.authority
from
groups g, group_members gm, group_authorities ga
where
gm.username = ? and g.id = ga.group_id and g.id = gm.group_id</pre>
</li></ul></div>
<div class="itemizedlist"><a name="nsa-jdbc-user-service-id" href="#nsa-jdbc-user-service-id"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>id</strong></span>
A bean identifier, used for referring to the bean elsewhere in the context.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-jdbc-user-service-role-prefix" href="#nsa-jdbc-user-service-role-prefix"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>role-prefix</strong></span>
A non-empty string prefix that will be added to role strings loaded from persistent storage (default is "ROLE_").
Use the value "none" for no prefix in cases where the default is non-empty.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-jdbc-user-service-users-by-username-query" href="#nsa-jdbc-user-service-users-by-username-query"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<p class="simpara"><span class="strong"><strong>users-by-username-query</strong></span>
An SQL statement to query a username, password, and enabled status given a username.
The default is</p>
<pre class="screen">select username, password, enabled from users where username = ?</pre>
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-password-encoder" href="#nsa-password-encoder"></a>&lt;password-encoder&gt;</h4></div></div></div>

<p>Authentication providers can optionally be configured to use a password encoder as described in the <a class="link" href="ns-config.html#ns-password-encoder" title="Adding a Password Encoder">namespace introduction</a>.
This will result in the bean being injected with the appropriate <code class="literal">PasswordEncoder</code> instance.</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-password-encoder-parents" href="#nsa-password-encoder-parents"></a>Parent Elements of &lt;password-encoder&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-authentication-provider" title="<authentication-provider&gt;">authentication-provider</a>
</li><li class="listitem">
<a class="link" href="appendix.html#nsa-password-compare" title="<password-compare&gt;">password-compare</a>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-password-encoder-attributes" href="#nsa-password-encoder-attributes"></a>&lt;password-encoder&gt; Attributes</h5></div></div></div>

<div class="itemizedlist"><a name="nsa-password-encoder-hash" href="#nsa-password-encoder-hash"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>hash</strong></span>
Defines the hashing algorithm used on user passwords.
We recommend strongly against using MD4, as it is a very weak hashing algorithm.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-password-encoder-ref" href="#nsa-password-encoder-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>ref</strong></span>
Defines a reference to a Spring bean that implements <code class="literal">PasswordEncoder</code>.
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-user-service" href="#nsa-user-service"></a>&lt;user-service&gt;</h4></div></div></div>

<p>Creates an in-memory UserDetailsService from a properties file or a list of "user" child elements.
Usernames are converted to lower-case internally to allow for case-insensitive lookups, so this should not be used if case-sensitivity is required.</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-user-service-attributes" href="#nsa-user-service-attributes"></a>&lt;user-service&gt; Attributes</h5></div></div></div>

<div class="itemizedlist"><a name="nsa-user-service-id" href="#nsa-user-service-id"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>id</strong></span>
A bean identifier, used for referring to the bean elsewhere in the context.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-user-service-properties" href="#nsa-user-service-properties"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<p class="simpara"><span class="strong"><strong>properties</strong></span>
The location of a Properties file where each line is in the format of</p>
<pre class="screen">username=password,grantedAuthority[,grantedAuthority][,enabled|disabled]</pre>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-user-service-children" href="#nsa-user-service-children"></a>Child Elements of &lt;user-service&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-user" title="<user&gt;">user</a>
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-user" href="#nsa-user"></a>&lt;user&gt;</h4></div></div></div>

<p>Represents a user in the application.</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-user-parents" href="#nsa-user-parents"></a>Parent Elements of &lt;user&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-user-service" title="<user-service&gt;">user-service</a>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-user-attributes" href="#nsa-user-attributes"></a>&lt;user&gt; Attributes</h5></div></div></div>

<div class="itemizedlist"><a name="nsa-user-authorities" href="#nsa-user-authorities"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>authorities</strong></span>
One of more authorities granted to the user.
Separate authorities with a comma (but no space).
For example, "ROLE_USER,ROLE_ADMINISTRATOR"
</li></ul></div>
<div class="itemizedlist"><a name="nsa-user-disabled" href="#nsa-user-disabled"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>disabled</strong></span>
Can be set to "true" to mark an account as disabled and unusable.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-user-locked" href="#nsa-user-locked"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>locked</strong></span>
Can be set to "true" to mark an account as locked and unusable.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-user-name" href="#nsa-user-name"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>name</strong></span>
The username assigned to the user.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-user-password" href="#nsa-user-password"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>password</strong></span>
The password assigned to the user.
This may be hashed if the corresponding authentication provider supports hashing (remember to set the "hash" attribute of the "user-service" element).
This attribute be omitted in the case where the data will not be used for authentication, but only for accessing authorities.
If omitted, the namespace will generate a random value, preventing its accidental use for authentication.
Cannot be empty.
</li></ul></div>
</div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="nsa-method-security" href="#nsa-method-security"></a>15.2.4&nbsp;Method Security</h3></div></div></div>

<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-global-method-security" href="#nsa-global-method-security"></a>&lt;global-method-security&gt;</h4></div></div></div>

<p>This element is the primary means of adding support for securing methods on Spring Security beans.
Methods can be secured by the use of annotations (defined at the interface or class level) or by defining a set of pointcuts as child elements, using AspectJ syntax.</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-global-method-security-attributes" href="#nsa-global-method-security-attributes"></a>&lt;global-method-security&gt; Attributes</h5></div></div></div>

<div class="itemizedlist"><a name="nsa-global-method-security-access-decision-manager-ref" href="#nsa-global-method-security-access-decision-manager-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>access-decision-manager-ref</strong></span>
Method security uses the same <code class="literal">AccessDecisionManager</code> configuration as web security, but this can be overridden using this attribute.
By default an AffirmativeBased implementation is used for with a RoleVoter and an AuthenticatedVoter.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-global-method-security-authentication-manager-ref" href="#nsa-global-method-security-authentication-manager-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>authentication-manager-ref</strong></span>
A reference to an <code class="literal">AuthenticationManager</code> that should be used for method security.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-global-method-security-jsr250-annotations" href="#nsa-global-method-security-jsr250-annotations"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>jsr250-annotations</strong></span>
Specifies whether JSR-250 style attributes are to be used (for example "RolesAllowed").
This will require the javax.annotation.security classes on the classpath.
Setting this to true also adds a <code class="literal">Jsr250Voter</code> to the <code class="literal">AccessDecisionManager</code>, so you need to make sure you do this if you are using a custom implementation and want to use these annotations.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-global-method-security-metadata-source-ref" href="#nsa-global-method-security-metadata-source-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>metadata-source-ref</strong></span>
An external <code class="literal">MethodSecurityMetadataSource</code> instance can be supplied which will take priority over other sources (such as the default annotations).
</li></ul></div>
<div class="itemizedlist"><a name="nsa-global-method-security-mode" href="#nsa-global-method-security-mode"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>mode</strong></span>
This attribute can be set to "aspectj" to specify that AspectJ should be used instead of the default Spring AOP.
Secured methods must be woven with the <code class="literal">AnnotationSecurityAspect</code> from the <code class="literal">spring-security-aspects</code> module.
</li></ul></div>
<p>It is important to note that AspectJ follows Java&#8217;s rule that annotations on interfaces are not inherited.
This means that methods that define the Security annotations on the interface will not be secured.
Instead, you must place the Security annotation on the class when using AspectJ.</p>
<div class="itemizedlist"><a name="nsa-global-method-security-order" href="#nsa-global-method-security-order"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>order</strong></span>
Allows the advice "order" to be set for the method security interceptor.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-global-method-security-pre-post-annotations" href="#nsa-global-method-security-pre-post-annotations"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>pre-post-annotations</strong></span>
Specifies whether the use of Spring Security&#8217;s pre and post invocation annotations (@PreFilter, @PreAuthorize, @PostFilter, @PostAuthorize) should be enabled for this application context.
Defaults to "disabled".
</li></ul></div>
<div class="itemizedlist"><a name="nsa-global-method-security-proxy-target-class" href="#nsa-global-method-security-proxy-target-class"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>proxy-target-class</strong></span>
If true, class based proxying will be used instead of interface based proxying.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-global-method-security-run-as-manager-ref" href="#nsa-global-method-security-run-as-manager-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>run-as-manager-ref</strong></span>
A reference to an optional <code class="literal">RunAsManager</code> implementation which will be used by the configured <code class="literal">MethodSecurityInterceptor</code>
</li></ul></div>
<div class="itemizedlist"><a name="nsa-global-method-security-secured-annotations" href="#nsa-global-method-security-secured-annotations"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>secured-annotations</strong></span>
Specifies whether the use of Spring Security&#8217;s @Secured annotations should be enabled for this application context.
Defaults to "disabled".
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-global-method-security-children" href="#nsa-global-method-security-children"></a>Child Elements of &lt;global-method-security&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-after-invocation-provider" title="<after-invocation-provider&gt;">after-invocation-provider</a>
</li><li class="listitem">
<a class="link" href="appendix.html#nsa-expression-handler" title="<expression-handler&gt;">expression-handler</a>
</li><li class="listitem">
<a class="link" href="appendix.html#nsa-pre-post-annotation-handling" title="<pre-post-annotation-handling&gt;">pre-post-annotation-handling</a>
</li><li class="listitem">
<a class="link" href="appendix.html#nsa-protect-pointcut" title="Securing Methods using">protect-pointcut</a>
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-after-invocation-provider" href="#nsa-after-invocation-provider"></a>&lt;after-invocation-provider&gt;</h4></div></div></div>

<p>This element can be used to decorate an <code class="literal">AfterInvocationProvider</code> for use by the security interceptor maintained by the <code class="literal">&lt;global-method-security&gt;</code> namespace.
You can define zero or more of these within the <code class="literal">global-method-security</code> element, each with a <code class="literal">ref</code> attribute pointing to an <code class="literal">AfterInvocationProvider</code> bean instance within your application context.</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-after-invocation-provider-parents" href="#nsa-after-invocation-provider-parents"></a>Parent Elements of &lt;after-invocation-provider&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-global-method-security" title="<global-method-security&gt;">global-method-security</a>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-after-invocation-provider-attributes" href="#nsa-after-invocation-provider-attributes"></a>&lt;after-invocation-provider&gt; Attributes</h5></div></div></div>

<div class="itemizedlist"><a name="nsa-after-invocation-provider-ref" href="#nsa-after-invocation-provider-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>ref</strong></span>
Defines a reference to a Spring bean that implements <code class="literal">AfterInvocationProvider</code>.
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-pre-post-annotation-handling" href="#nsa-pre-post-annotation-handling"></a>&lt;pre-post-annotation-handling&gt;</h4></div></div></div>

<p>Allows the default expression-based mechanism for handling Spring Security&#8217;s pre and post invocation annotations (@PreFilter, @PreAuthorize, @PostFilter, @PostAuthorize) to be replaced entirely.
Only applies if these annotations are enabled.</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-pre-post-annotation-handling-parents" href="#nsa-pre-post-annotation-handling-parents"></a>Parent Elements of &lt;pre-post-annotation-handling&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-global-method-security" title="<global-method-security&gt;">global-method-security</a>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-pre-post-annotation-handling-children" href="#nsa-pre-post-annotation-handling-children"></a>Child Elements of &lt;pre-post-annotation-handling&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-invocation-attribute-factory" title="<invocation-attribute-factory&gt;">invocation-attribute-factory</a>
</li><li class="listitem">
<a class="link" href="appendix.html#nsa-post-invocation-advice" title="<post-invocation-advice&gt;">post-invocation-advice</a>
</li><li class="listitem">
<a class="link" href="appendix.html#nsa-pre-invocation-advice" title="<pre-invocation-advice&gt;">pre-invocation-advice</a>
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-invocation-attribute-factory" href="#nsa-invocation-attribute-factory"></a>&lt;invocation-attribute-factory&gt;</h4></div></div></div>

<p>Defines the PrePostInvocationAttributeFactory instance which is used to generate pre and post invocation metadata from the annotated methods.</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-invocation-attribute-factory-parents" href="#nsa-invocation-attribute-factory-parents"></a>Parent Elements of &lt;invocation-attribute-factory&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-pre-post-annotation-handling" title="<pre-post-annotation-handling&gt;">pre-post-annotation-handling</a>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-invocation-attribute-factory-attributes" href="#nsa-invocation-attribute-factory-attributes"></a>&lt;invocation-attribute-factory&gt; Attributes</h5></div></div></div>

<div class="itemizedlist"><a name="nsa-invocation-attribute-factory-ref" href="#nsa-invocation-attribute-factory-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>ref</strong></span>
Defines a reference to a Spring bean Id.
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-post-invocation-advice" href="#nsa-post-invocation-advice"></a>&lt;post-invocation-advice&gt;</h4></div></div></div>

<p>Customizes the <code class="literal">PostInvocationAdviceProvider</code> with the ref as the <code class="literal">PostInvocationAuthorizationAdvice</code> for the &lt;pre-post-annotation-handling&gt; element.</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-post-invocation-advice-parents" href="#nsa-post-invocation-advice-parents"></a>Parent Elements of &lt;post-invocation-advice&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-pre-post-annotation-handling" title="<pre-post-annotation-handling&gt;">pre-post-annotation-handling</a>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-post-invocation-advice-attributes" href="#nsa-post-invocation-advice-attributes"></a>&lt;post-invocation-advice&gt; Attributes</h5></div></div></div>

<div class="itemizedlist"><a name="nsa-post-invocation-advice-ref" href="#nsa-post-invocation-advice-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>ref</strong></span>
Defines a reference to a Spring bean Id.
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-pre-invocation-advice" href="#nsa-pre-invocation-advice"></a>&lt;pre-invocation-advice&gt;</h4></div></div></div>

<p>Customizes the <code class="literal">PreInvocationAuthorizationAdviceVoter</code> with the ref as the <code class="literal">PreInvocationAuthorizationAdviceVoter</code> for the &lt;pre-post-annotation-handling&gt; element.</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-pre-invocation-advice-parents" href="#nsa-pre-invocation-advice-parents"></a>Parent Elements of &lt;pre-invocation-advice&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-pre-post-annotation-handling" title="<pre-post-annotation-handling&gt;">pre-post-annotation-handling</a>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-pre-invocation-advice-attributes" href="#nsa-pre-invocation-advice-attributes"></a>&lt;pre-invocation-advice&gt; Attributes</h5></div></div></div>

<div class="itemizedlist"><a name="nsa-pre-invocation-advice-ref" href="#nsa-pre-invocation-advice-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>ref</strong></span>
Defines a reference to a Spring bean Id.
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-protect-pointcut" href="#nsa-protect-pointcut"></a>Securing Methods using</h4></div></div></div>

<p><code class="literal">&lt;protect-pointcut&gt;</code>
Rather than defining security attributes on an individual method or class basis using the <code class="literal">@Secured</code> annotation, you can define cross-cutting security constraints across whole sets of methods and interfaces in your service layer using the <code class="literal">&lt;protect-pointcut&gt;</code> element.
You can find an example in the <a class="link" href="ns-config.html#ns-protect-pointcut" title="Adding Security Pointcuts using protect-pointcut">namespace introduction</a>.</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-protect-pointcut-parents" href="#nsa-protect-pointcut-parents"></a>Parent Elements of &lt;protect-pointcut&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-global-method-security" title="<global-method-security&gt;">global-method-security</a>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-protect-pointcut-attributes" href="#nsa-protect-pointcut-attributes"></a>&lt;protect-pointcut&gt; Attributes</h5></div></div></div>

<div class="itemizedlist"><a name="nsa-protect-pointcut-access" href="#nsa-protect-pointcut-access"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>access</strong></span>
Access configuration attributes list that applies to all methods matching the pointcut, e.g.
"ROLE_A,ROLE_B"
</li></ul></div>
<div class="itemizedlist"><a name="nsa-protect-pointcut-expression" href="#nsa-protect-pointcut-expression"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>expression</strong></span>
An AspectJ expression, including the 'execution' keyword.
For example, 'execution(int com.foo.TargetObject.countLength(String))' (without the quotes).
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-intercept-methods" href="#nsa-intercept-methods"></a>&lt;intercept-methods&gt;</h4></div></div></div>

<p>Can be used inside a bean definition to add a security interceptor to the bean and set up access configuration attributes for the bean&#8217;s methods</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-intercept-methods-attributes" href="#nsa-intercept-methods-attributes"></a>&lt;intercept-methods&gt; Attributes</h5></div></div></div>

<div class="itemizedlist"><a name="nsa-intercept-methods-access-decision-manager-ref" href="#nsa-intercept-methods-access-decision-manager-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>access-decision-manager-ref</strong></span>
Optional AccessDecisionManager bean ID to be used by the created method security interceptor.
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-intercept-methods-children" href="#nsa-intercept-methods-children"></a>Child Elements of &lt;intercept-methods&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-protect" title="<protect&gt;">protect</a>
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-method-security-metadata-source" href="#nsa-method-security-metadata-source"></a>&lt;method-security-metadata-source&gt;</h4></div></div></div>

<p>Creates a MethodSecurityMetadataSource instance</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-method-security-metadata-source-attributes" href="#nsa-method-security-metadata-source-attributes"></a>&lt;method-security-metadata-source&gt; Attributes</h5></div></div></div>

<div class="itemizedlist"><a name="nsa-method-security-metadata-source-id" href="#nsa-method-security-metadata-source-id"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>id</strong></span>
A bean identifier, used for referring to the bean elsewhere in the context.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-method-security-metadata-source-use-expressions" href="#nsa-method-security-metadata-source-use-expressions"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>use-expressions</strong></span>
Enables the use of expressions in the 'access' attributes in &lt;intercept-url&gt; elements rather than the traditional list of configuration attributes.
Defaults to 'false'.
If enabled, each attribute should contain a single Boolean expression.
If the expression evaluates to 'true', access will be granted.
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-method-security-metadata-source-children" href="#nsa-method-security-metadata-source-children"></a>Child Elements of &lt;method-security-metadata-source&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-protect" title="<protect&gt;">protect</a>
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-protect" href="#nsa-protect"></a>&lt;protect&gt;</h4></div></div></div>

<p>Defines a protected method and the access control configuration attributes that apply to it.
We strongly advise you NOT to mix "protect" declarations with any services provided "global-method-security".</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-protect-parents" href="#nsa-protect-parents"></a>Parent Elements of &lt;protect&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-intercept-methods" title="<intercept-methods&gt;">intercept-methods</a>
</li><li class="listitem">
<a class="link" href="appendix.html#nsa-method-security-metadata-source" title="<method-security-metadata-source&gt;">method-security-metadata-source</a>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-protect-attributes" href="#nsa-protect-attributes"></a>&lt;protect&gt; Attributes</h5></div></div></div>

<div class="itemizedlist"><a name="nsa-protect-access" href="#nsa-protect-access"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>access</strong></span>
Access configuration attributes list that applies to the method, e.g.
"ROLE_A,ROLE_B".
</li></ul></div>
<div class="itemizedlist"><a name="nsa-protect-method" href="#nsa-protect-method"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>method</strong></span>
A method name
</li></ul></div>
</div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="nsa-ldap" href="#nsa-ldap"></a>15.2.5&nbsp;LDAP Namespace Options</h3></div></div></div>

<p>LDAP is covered in some details in <a class="link" href="advanced-topics.html#ldap" title="12.3&nbsp;LDAP Authentication">its own chapter</a>.
We will expand on that here with some explanation of how the namespace options map to Spring beans.
The LDAP implementation uses Spring LDAP extensively, so some familiarity with that project&#8217;s API may be useful.</p>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-ldap-server" href="#nsa-ldap-server"></a>Defining the LDAP Server using the</h4></div></div></div>

<p><code class="literal">&lt;ldap-server&gt;</code> Element
This element sets up a Spring LDAP <code class="literal">ContextSource</code> for use by the other LDAP beans, defining the location of the LDAP server and other information (such as a username and password, if it doesn&#8217;t allow anonymous access) for connecting to it.
It can also be used to create an embedded server for testing.
Details of the syntax for both options are covered in the <a class="link" href="advanced-topics.html#ldap-server" title="12.3.3&nbsp;Configuring an LDAP Server">LDAP chapter</a>.
The actual <code class="literal">ContextSource</code> implementation is <code class="literal">DefaultSpringSecurityContextSource</code> which extends Spring LDAP&#8217;s <code class="literal">LdapContextSource</code> class.
The <code class="literal">manager-dn</code> and <code class="literal">manager-password</code> attributes map to the latter&#8217;s <code class="literal">userDn</code> and <code class="literal">password</code> properties respectively.</p>
<p>If you only have one server defined in your application context, the other LDAP namespace-defined beans will use it automatically.
Otherwise, you can give the element an "id" attribute and refer to it from other namespace beans using the <code class="literal">server-ref</code> attribute.
This is actually the bean <code class="literal">id</code> of the <code class="literal">ContextSource</code> instance, if you want to use it in other traditional Spring beans.</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-ldap-server-attributes" href="#nsa-ldap-server-attributes"></a>&lt;ldap-server&gt; Attributes</h5></div></div></div>

<div class="itemizedlist"><a name="nsa-ldap-server-id" href="#nsa-ldap-server-id"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>id</strong></span>
A bean identifier, used for referring to the bean elsewhere in the context.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-ldap-server-ldif" href="#nsa-ldap-server-ldif"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>ldif</strong></span>
Explicitly specifies an ldif file resource to load into an embedded LDAP server.
The ldiff is should be a Spring resource pattern (i.e. classpath:init.ldiff).
The default is classpath*:*.ldiff
</li></ul></div>
<div class="itemizedlist"><a name="nsa-ldap-server-manager-dn" href="#nsa-ldap-server-manager-dn"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>manager-dn</strong></span>
Username (DN) of the "manager" user identity which will be used to authenticate to a (non-embedded) LDAP server.
If omitted, anonymous access will be used.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-ldap-server-manager-password" href="#nsa-ldap-server-manager-password"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>manager-password</strong></span>
The password for the manager DN.
This is required if the manager-dn is specified.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-ldap-server-port" href="#nsa-ldap-server-port"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>port</strong></span>
Specifies an IP port number.
Used to configure an embedded LDAP server, for example.
The default value is 33389.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-ldap-server-root" href="#nsa-ldap-server-root"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>root</strong></span>
Optional root suffix for the embedded LDAP server.
Default is "dc=springframework,dc=org"
</li></ul></div>
<div class="itemizedlist"><a name="nsa-ldap-server-url" href="#nsa-ldap-server-url"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>url</strong></span>
Specifies the ldap server URL when not using the embedded LDAP server.
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-ldap-authentication-provider" href="#nsa-ldap-authentication-provider"></a>&lt;ldap-authentication-provider&gt;</h4></div></div></div>

<p>This element is shorthand for the creation of an <code class="literal">LdapAuthenticationProvider</code> instance.
By default this will be configured with a <code class="literal">BindAuthenticator</code> instance and a <code class="literal">DefaultAuthoritiesPopulator</code>.
As with all namespace authentication providers, it must be included as a child of the <code class="literal">authentication-provider</code> element.</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-ldap-authentication-provider-parents" href="#nsa-ldap-authentication-provider-parents"></a>Parent Elements of &lt;ldap-authentication-provider&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-authentication-manager" title="<authentication-manager&gt;">authentication-manager</a>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-ldap-authentication-provider-attributes" href="#nsa-ldap-authentication-provider-attributes"></a>&lt;ldap-authentication-provider&gt; Attributes</h5></div></div></div>

<div class="itemizedlist"><a name="nsa-ldap-authentication-provider-group-role-attribute" href="#nsa-ldap-authentication-provider-group-role-attribute"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>group-role-attribute</strong></span>
The LDAP attribute name which contains the role name which will be used within Spring Security.
Maps to the <code class="literal">DefaultLdapAuthoritiesPopulator</code>'s <code class="literal">groupRoleAttribute</code> property.
Defaults to "cn".
</li></ul></div>
<div class="itemizedlist"><a name="nsa-ldap-authentication-provider-group-search-base" href="#nsa-ldap-authentication-provider-group-search-base"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>group-search-base</strong></span>
Search base for group membership searches.
Maps to the <code class="literal">DefaultLdapAuthoritiesPopulator</code>'s <code class="literal">groupSearchBase</code> constructor argument.
Defaults to "" (searching from the root).
</li></ul></div>
<div class="itemizedlist"><a name="nsa-ldap-authentication-provider-group-search-filter" href="#nsa-ldap-authentication-provider-group-search-filter"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>group-search-filter</strong></span>
Group search filter.
Maps to the <code class="literal">DefaultLdapAuthoritiesPopulator</code>'s <code class="literal">groupSearchFilter</code> property.
Defaults to (uniqueMember={0}).
The substituted parameter is the DN of the user.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-ldap-authentication-provider-role-prefix" href="#nsa-ldap-authentication-provider-role-prefix"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>role-prefix</strong></span>
A non-empty string prefix that will be added to role strings loaded from persistent.
Maps to the <code class="literal">DefaultLdapAuthoritiesPopulator</code>'s <code class="literal">rolePrefix</code> property.
Defaults to "ROLE_".
Use the value "none" for no prefix in cases where the default is non-empty.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-ldap-authentication-provider-server-ref" href="#nsa-ldap-authentication-provider-server-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>server-ref</strong></span>
The optional server to use.
If omitted, and a default LDAP server is registered (using &lt;ldap-server&gt; with no Id), that server will be used.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-ldap-authentication-provider-user-context-mapper-ref" href="#nsa-ldap-authentication-provider-user-context-mapper-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>user-context-mapper-ref</strong></span>
Allows explicit customization of the loaded user object by specifying a UserDetailsContextMapper bean which will be called with the context information from the user&#8217;s directory entry
</li></ul></div>
<div class="itemizedlist"><a name="nsa-ldap-authentication-provider-user-details-class" href="#nsa-ldap-authentication-provider-user-details-class"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>user-details-class</strong></span>
Allows the objectClass of the user entry to be specified.
If set, the framework will attempt to load standard attributes for the defined class into the returned UserDetails object
</li></ul></div>
<div class="itemizedlist"><a name="nsa-ldap-authentication-provider-user-dn-pattern" href="#nsa-ldap-authentication-provider-user-dn-pattern"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>user-dn-pattern</strong></span>
If your users are at a fixed location in the directory (i.e. you can work out the DN directly from the username without doing a directory search), you can use this attribute to map directly to the DN.
It maps directly to the <code class="literal">userDnPatterns</code> property of <code class="literal">AbstractLdapAuthenticator</code>.
The value is a specific pattern used to build the user&#8217;s DN, for example "uid={0},ou=people".
The key "{0}" must be present and will be substituted with the username.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-ldap-authentication-provider-user-search-base" href="#nsa-ldap-authentication-provider-user-search-base"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<p class="simpara"><span class="strong"><strong>user-search-base</strong></span>
Search base for user searches.
Defaults to "".
Only used with a 'user-search-filter'.</p>
<p class="simpara">If you need to perform a search to locate the user in the directory, then you can set these attributes to control the search.
The <code class="literal">BindAuthenticator</code> will be configured with a <code class="literal">FilterBasedLdapUserSearch</code> and the attribute values map directly to the first two arguments of that bean&#8217;s constructor.
If these attributes aren&#8217;t set and no <code class="literal">user-dn-pattern</code> has been supplied as an alternative, then the default search values of <code class="literal">user-search-filter="(uid={0})"</code> and <code class="literal">user-search-base=""</code> will be used.</p>
</li></ul></div>
<div class="itemizedlist"><a name="nsa-ldap-authentication-provider-user-search-filter" href="#nsa-ldap-authentication-provider-user-search-filter"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<p class="simpara"><span class="strong"><strong>user-search-filter</strong></span>
The LDAP filter used to search for users (optional).
For example "(uid={0})".
The substituted parameter is the user&#8217;s login name.</p>
<p class="simpara">If you need to perform a search to locate the user in the directory, then you can set these attributes to control the search.
The <code class="literal">BindAuthenticator</code> will be configured with a <code class="literal">FilterBasedLdapUserSearch</code> and the attribute values map directly to the first two arguments of that bean&#8217;s constructor.
If these attributes aren&#8217;t set and no <code class="literal">user-dn-pattern</code> has been supplied as an alternative, then the default search values of <code class="literal">user-search-filter="(uid={0})"</code> and <code class="literal">user-search-base=""</code> will be used.</p>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-ldap-authentication-provider-children" href="#nsa-ldap-authentication-provider-children"></a>Child Elements of &lt;ldap-authentication-provider&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-password-compare" title="<password-compare&gt;">password-compare</a>
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-password-compare" href="#nsa-password-compare"></a>&lt;password-compare&gt;</h4></div></div></div>

<p>This is used as child element to <code class="literal">&lt;ldap-provider&gt;</code> and switches the authentication strategy from <code class="literal">BindAuthenticator</code> to <code class="literal">PasswordComparisonAuthenticator</code>.</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-password-compare-parents" href="#nsa-password-compare-parents"></a>Parent Elements of &lt;password-compare&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-ldap-authentication-provider" title="<ldap-authentication-provider&gt;">ldap-authentication-provider</a>
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-password-compare-attributes" href="#nsa-password-compare-attributes"></a>&lt;password-compare&gt; Attributes</h5></div></div></div>

<div class="itemizedlist"><a name="nsa-password-compare-hash" href="#nsa-password-compare-hash"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>hash</strong></span>
Defines the hashing algorithm used on user passwords.
We recommend strongly against using MD4, as it is a very weak hashing algorithm.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-password-compare-password-attribute" href="#nsa-password-compare-password-attribute"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>password-attribute</strong></span>
The attribute in the directory which contains the user password.
Defaults to "userPassword".
</li></ul></div>
</div>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-password-compare-children" href="#nsa-password-compare-children"></a>Child Elements of &lt;password-compare&gt;</h5></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="appendix.html#nsa-password-encoder" title="<password-encoder&gt;">password-encoder</a>
</li></ul></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="nsa-ldap-user-service" href="#nsa-ldap-user-service"></a>&lt;ldap-user-service&gt;</h4></div></div></div>

<p>This element configures an LDAP <code class="literal">UserDetailsService</code>.
The class used is <code class="literal">LdapUserDetailsService</code> which is a combination of a <code class="literal">FilterBasedLdapUserSearch</code> and a <code class="literal">DefaultLdapAuthoritiesPopulator</code>.
The attributes it supports have the same usage as in <code class="literal">&lt;ldap-provider&gt;</code>.</p>
<div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="nsa-ldap-user-service-attributes" href="#nsa-ldap-user-service-attributes"></a>&lt;ldap-user-service&gt; Attributes</h5></div></div></div>

<div class="itemizedlist"><a name="nsa-ldap-user-service-cache-ref" href="#nsa-ldap-user-service-cache-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>cache-ref</strong></span>
Defines a reference to a cache for use with a UserDetailsService.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-ldap-user-service-group-role-attribute" href="#nsa-ldap-user-service-group-role-attribute"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>group-role-attribute</strong></span>
The LDAP attribute name which contains the role name which will be used within Spring Security.
Defaults to "cn".
</li></ul></div>
<div class="itemizedlist"><a name="nsa-ldap-user-service-group-search-base" href="#nsa-ldap-user-service-group-search-base"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>group-search-base</strong></span>
Search base for group membership searches.
Defaults to "" (searching from the root).
</li></ul></div>
<div class="itemizedlist"><a name="nsa-ldap-user-service-group-search-filter" href="#nsa-ldap-user-service-group-search-filter"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>group-search-filter</strong></span>
Group search filter.
Defaults to (uniqueMember={0}).
The substituted parameter is the DN of the user.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-ldap-user-service-id" href="#nsa-ldap-user-service-id"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>id</strong></span>
A bean identifier, used for referring to the bean elsewhere in the context.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-ldap-user-service-role-prefix" href="#nsa-ldap-user-service-role-prefix"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>role-prefix</strong></span>
A non-empty string prefix that will be added to role strings loaded from persistent storage (e.g.
"ROLE_").
Use the value "none" for no prefix in cases where the default is non-empty.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-ldap-user-service-server-ref" href="#nsa-ldap-user-service-server-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>server-ref</strong></span>
The optional server to use.
If omitted, and a default LDAP server is registered (using &lt;ldap-server&gt; with no Id), that server will be used.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-ldap-user-service-user-context-mapper-ref" href="#nsa-ldap-user-service-user-context-mapper-ref"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>user-context-mapper-ref</strong></span>
Allows explicit customization of the loaded user object by specifying a UserDetailsContextMapper bean which will be called with the context information from the user&#8217;s directory entry
</li></ul></div>
<div class="itemizedlist"><a name="nsa-ldap-user-service-user-details-class" href="#nsa-ldap-user-service-user-details-class"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>user-details-class</strong></span>
Allows the objectClass of the user entry to be specified.
If set, the framework will attempt to load standard attributes for the defined class into the returned UserDetails object
</li></ul></div>
<div class="itemizedlist"><a name="nsa-ldap-user-service-user-search-base" href="#nsa-ldap-user-service-user-search-base"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>user-search-base</strong></span>
Search base for user searches.
Defaults to "".
Only used with a 'user-search-filter'.
</li></ul></div>
<div class="itemizedlist"><a name="nsa-ldap-user-service-user-search-filter" href="#nsa-ldap-user-service-user-search-filter"></a><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>user-search-filter</strong></span>
The LDAP filter used to search for users (optional).
For example "(uid={0})".
The substituted parameter is the user&#8217;s login name.
</li></ul></div>
</div>
</div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="appendix-dependencies" href="#appendix-dependencies"></a>15.3&nbsp;Spring Security Dependencies</h2></div></div></div>

<p>This appendix provides a reference of the modules in Spring Security and the additional dependencies that they require in order to function in a running application.
We don&#8217;t include dependencies that are only used when building or testing Spring Security itself.
Nor do we include transitive dependencies which are required by external dependencies.</p>
<p>The version of Spring required is listed on the project website, so the specific versions are omitted for Spring dependencies below.
Note that some of the dependencies listed as "optional" below may still be required for other non-security functionality in a Spring application.
Also dependencies listed as "optional" may not actually be marked as such in the project&#8217;s Maven POM files if they are used in most applications.
They are "optional" only in the sense that you don&#8217;t need them unless you are using the specified functionality.</p>
<p>Where a module depends on another Spring Security module, the non-optional dependencies of the module it depends on are also assumed to be required and are not listed separately.</p>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="spring-security-core-2" href="#spring-security-core-2"></a>15.3.1&nbsp;spring-security-core</h3></div></div></div>

<p>The core module must be included in any project using Spring Security.</p>
<div class="table"><a name="d5e9510" href="#d5e9510"></a><p class="title"><b>Table&nbsp;15.1.&nbsp;Core Dependencies</b></p><div class="table-contents">

<table summary="Core Dependencies" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="col_1"><col class="col_2"><col class="col_3"></colgroup><thead><tr><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">Dependency</th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">Version</th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top">Description</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>ehcache</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>1.6.2</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Required if the Ehcache-based user cache implementation is used (optional).</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>spring-aop</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Method security is based on Spring AOP</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>spring-beans</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Required for Spring configuration</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>spring-expression</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Required for expression-based method security (optional)</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>spring-jdbc</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Required if using a database to store user data (optional).</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>spring-tx</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Required if using a database to store user data (optional).</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>aspectjrt</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>1.6.10</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Required if using AspectJ support (optional).</p></td></tr><tr><td style="border-right: 0.5pt solid ; " align="left" valign="top"><p>jsr250-api</p></td><td style="border-right: 0.5pt solid ; " align="left" valign="top"><p>1.0</p></td><td style="" align="left" valign="top"><p>Required if you are using JSR-250 method-security annotations (optional).</p></td></tr></tbody></table>
</div></div><br class="table-break">
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="spring-security-remoting-2" href="#spring-security-remoting-2"></a>15.3.2&nbsp;spring-security-remoting</h3></div></div></div>

<p>This module is typically required in web applications which use the Servlet API.</p>
<div class="table"><a name="d5e9576" href="#d5e9576"></a><p class="title"><b>Table&nbsp;15.2.&nbsp;Remoting Dependencies</b></p><div class="table-contents">

<table summary="Remoting Dependencies" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="col_1"><col class="col_2"><col class="col_3"></colgroup><thead><tr><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">Dependency</th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">Version</th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top">Description</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>spring-security-core</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; " align="left" valign="top"><p>spring-web</p></td><td style="border-right: 0.5pt solid ; " align="left" valign="top">&nbsp;</td><td style="" align="left" valign="top"><p>Required for clients which use HTTP remoting support.</p></td></tr></tbody></table>
</div></div><br class="table-break">
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="spring-security-web-2" href="#spring-security-web-2"></a>15.3.3&nbsp;spring-security-web</h3></div></div></div>

<p>This module is typically required in web applications which use the Servlet API.</p>
<div class="table"><a name="d5e9602" href="#d5e9602"></a><p class="title"><b>Table&nbsp;15.3.&nbsp;Web Dependencies</b></p><div class="table-contents">

<table summary="Web Dependencies" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="col_1"><col class="col_2"><col class="col_3"></colgroup><thead><tr><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">Dependency</th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">Version</th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top">Description</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>spring-security-core</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>spring-web</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Spring web support classes are used extensively.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>spring-jdbc</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Required for JDBC-based persistent remember-me token repository (optional).</p></td></tr><tr><td style="border-right: 0.5pt solid ; " align="left" valign="top"><p>spring-tx</p></td><td style="border-right: 0.5pt solid ; " align="left" valign="top">&nbsp;</td><td style="" align="left" valign="top"><p>Required by remember-me persistent token repository implementations (optional).</p></td></tr></tbody></table>
</div></div><br class="table-break">
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="spring-security-ldap-2" href="#spring-security-ldap-2"></a>15.3.4&nbsp;spring-security-ldap</h3></div></div></div>

<p>This module is only required if you are using LDAP authentication.</p>
<div class="table"><a name="d5e9640" href="#d5e9640"></a><p class="title"><b>Table&nbsp;15.4.&nbsp;LDAP Dependencies</b></p><div class="table-contents">

<table summary="LDAP Dependencies" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="col_1"><col class="col_2"><col class="col_3"></colgroup><thead><tr><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">Dependency</th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">Version</th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top">Description</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>spring-security-core</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>spring-ldap-core</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>1.3.0</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>LDAP support is based on Spring LDAP.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>spring-tx</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Data exception classes are required.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>apache-ds <a href="#ftn.d5e9673" class="footnote" name="d5e9673"><sup class="footnote">[1]</sup></a></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>1.5.5</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Required if you are using an embedded LDAP server (optional).</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>shared-ldap</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>0.9.15</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Required if you are using an embedded LDAP server (optional).</p></td></tr><tr><td style="border-right: 0.5pt solid ; " align="left" valign="top"><p>ldapsdk</p></td><td style="border-right: 0.5pt solid ; " align="left" valign="top"><p>4.1</p></td><td style="" align="left" valign="top"><p>Mozilla LdapSDK.
Used for decoding LDAP password policy controls if you are using password-policy functionality with OpenLDAP, for example.</p></td></tr></tbody><tbody class="footnotes"><tr><td colspan="3"><div id="ftn.d5e9673" class="footnote"><p><a href="#d5e9673" class="simpara"><sup class="simpara">[1] </sup></a>The modules <code class="literal">apacheds-core</code>, <code class="literal">apacheds-core-entry</code>, <code class="literal">apacheds-protocol-shared</code>, <code class="literal">apacheds-protocol-ldap</code> and <code class="literal">apacheds-server-jndi</code> are required.</p></div></td></tr></tbody></table>
</div></div><br class="table-break">
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="spring-security-config-2" href="#spring-security-config-2"></a>15.3.5&nbsp;spring-security-config</h3></div></div></div>

<p>This module is required if you are using Spring Security namespace configuration.</p>
<div class="table"><a name="d5e9701" href="#d5e9701"></a><p class="title"><b>Table&nbsp;15.5.&nbsp;Config Dependencies</b></p><div class="table-contents">

<table summary="Config Dependencies" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="col_1"><col class="col_2"><col class="col_3"></colgroup><thead><tr><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">Dependency</th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">Version</th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top">Description</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>spring-security-core</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>spring-security-web</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Required if you are using any web-related namespace configuration (optional).</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>spring-security-ldap</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Required if you are using the LDAP namespace options (optional).</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>spring-security-openid</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Required if you are using OpenID authentication (optional).</p></td></tr><tr><td style="border-right: 0.5pt solid ; " align="left" valign="top"><p>aspectjweaver</p></td><td style="border-right: 0.5pt solid ; " align="left" valign="top"><p>1.6.10</p></td><td style="" align="left" valign="top"><p>Required if using the protect-pointcut namespace syntax (optional).</p></td></tr></tbody></table>
</div></div><br class="table-break">
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="spring-security-acl-2" href="#spring-security-acl-2"></a>15.3.6&nbsp;spring-security-acl</h3></div></div></div>

<p>The ACL module.</p>
<div class="table"><a name="d5e9746" href="#d5e9746"></a><p class="title"><b>Table&nbsp;15.6.&nbsp;ACL Dependencies</b></p><div class="table-contents">

<table summary="ACL Dependencies" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="col_1"><col class="col_2"><col class="col_3"></colgroup><thead><tr><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">Dependency</th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">Version</th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top">Description</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>spring-security-core</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>ehcache</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>1.6.2</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Required if the Ehcache-based ACL cache implementation is used (optional if you are using your own implementation).</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>spring-jdbc</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Required if you are using the default JDBC-based AclService (optional if you implement your own).</p></td></tr><tr><td style="border-right: 0.5pt solid ; " align="left" valign="top"><p>spring-tx</p></td><td style="border-right: 0.5pt solid ; " align="left" valign="top">&nbsp;</td><td style="" align="left" valign="top"><p>Required if you are using the default JDBC-based AclService (optional if you implement your own).</p></td></tr></tbody></table>
</div></div><br class="table-break">
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="spring-security-cas-2" href="#spring-security-cas-2"></a>15.3.7&nbsp;spring-security-cas</h3></div></div></div>

<p>The CAS module provides integration with JA-SIG CAS.</p>
<div class="table"><a name="d5e9785" href="#d5e9785"></a><p class="title"><b>Table&nbsp;15.7.&nbsp;CAS Dependencies</b></p><div class="table-contents">

<table summary="CAS Dependencies" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="col_1"><col class="col_2"><col class="col_3"></colgroup><thead><tr><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">Dependency</th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">Version</th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top">Description</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>spring-security-core</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>spring-security-web</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>cas-client-core</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>3.1.12</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>The JA-SIG CAS Client.
This is the basis of the Spring Security integration.</p></td></tr><tr><td style="border-right: 0.5pt solid ; " align="left" valign="top"><p>ehcache</p></td><td style="border-right: 0.5pt solid ; " align="left" valign="top"><p>1.6.2</p></td><td style="" align="left" valign="top"><p>Required if you are using the Ehcache-based ticket cache (optional).</p></td></tr></tbody></table>
</div></div><br class="table-break">
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="spring-security-openid-2" href="#spring-security-openid-2"></a>15.3.8&nbsp;spring-security-openid</h3></div></div></div>

<p>The OpenID module.</p>
<div class="table"><a name="d5e9824" href="#d5e9824"></a><p class="title"><b>Table&nbsp;15.8.&nbsp;OpenID Dependencies</b></p><div class="table-contents">

<table summary="OpenID Dependencies" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="col_1"><col class="col_2"><col class="col_3"></colgroup><thead><tr><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">Dependency</th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">Version</th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top">Description</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>spring-security-core</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>spring-security-web</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>openid4java-nodeps</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>0.9.6</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Spring Security&#8217;s OpenID integration uses OpenID4Java.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>httpclient</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>4.1.1</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>openid4java-nodeps depends on HttpClient 4.</p></td></tr><tr><td style="border-right: 0.5pt solid ; " align="left" valign="top"><p>guice</p></td><td style="border-right: 0.5pt solid ; " align="left" valign="top"><p>2.0</p></td><td style="" align="left" valign="top"><p>openid4java-nodeps depends on Guice 2.</p></td></tr></tbody></table>
</div></div><br class="table-break">
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="spring-security-taglibs" href="#spring-security-taglibs"></a>15.3.9&nbsp;spring-security-taglibs</h3></div></div></div>

<p>Provides Spring Security&#8217;s JSP tag implementations.</p>
<div class="table"><a name="d5e9870" href="#d5e9870"></a><p class="title"><b>Table&nbsp;15.9.&nbsp;Taglib Dependencies</b></p><div class="table-contents">

<table summary="Taglib Dependencies" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="col_1"><col class="col_2"><col class="col_3"></colgroup><thead><tr><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">Dependency</th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">Version</th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top">Description</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>spring-security-core</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>spring-security-web</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>spring-security-acl</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Required if you are using the <code class="literal">accesscontrollist</code> tag or <code class="literal">hasPermission()</code> expressions with ACLs (optional).</p></td></tr><tr><td style="border-right: 0.5pt solid ; " align="left" valign="top"><p>spring-expression</p></td><td style="border-right: 0.5pt solid ; " align="left" valign="top">&nbsp;</td><td style="" align="left" valign="top"><p>Required if you are using SPEL expressions in your tag access constraints.</p></td></tr></tbody></table>
</div></div><br class="table-break">
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="appendix-proxy-server" href="#appendix-proxy-server"></a>15.4&nbsp;Proxy Server Configuration</h2></div></div></div>

<p>When using a proxy server it is important to ensure that you have configured your application properly.
For example, many applications will have a load balancer that responds to request for <a class="ulink" href="https://example.com/" target="_top">https://example.com/</a> by forwarding the request to an application server at <a class="ulink" href="http://192.168.1:8080" target="_top">http://192.168.1:8080</a>
Without proper configuration, the application server will not know that the load balancer exists and treat the request as though <a class="ulink" href="http://192.168.1:8080" target="_top">http://192.168.1:8080</a> was requested by the client.</p>
<p>To fix this you can use <a class="ulink" href="https://tools.ietf.org/html/rfc7239" target="_top">RFC 7239</a> to specify that a load balancer is being used.
To make the application aware of this, you need to either configure your application server aware of the X-Forwarded headers.
For example Tomcat uses the <a class="ulink" href="https://tomcat.apache.org/tomcat-8.0-doc/api/org/apache/catalina/valves/RemoteIpValve.html" target="_top">RemoteIpValve</a> and Jetty uses <a class="ulink" href="http://download.eclipse.org/jetty/stable-9/apidocs/org/eclipse/jetty/server/ForwardedRequestCustomizer.html" target="_top">ForwardedRequestCustomizer</a>.
Alternatively, Spring 4.3+ users can leverage <a class="ulink" href="https://github.com/spring-projects/spring-framework/blob/v4.3.3.RELEASE/spring-web/src/main/java/org/springframework/web/filter/ForwardedHeaderFilter.java" target="_top">ForwardedHeaderFilter</a>.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="appendix-faq" href="#appendix-faq"></a>15.5&nbsp;Spring Security FAQ</h2></div></div></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="xref" href="appendix.html#appendix-faq-general-questions" title="15.5.1&nbsp;General Questions">Section&nbsp;15.5.1, &#8220;General Questions&#8221;</a>
</li><li class="listitem">
<a class="xref" href="appendix.html#appendix-faq-common-problems" title="15.5.2&nbsp;Common Problems">Section&nbsp;15.5.2, &#8220;Common Problems&#8221;</a>
</li><li class="listitem">
<a class="xref" href="appendix.html#appendix-faq-architecture" title="15.5.3&nbsp;Spring Security Architecture Questions">Section&nbsp;15.5.3, &#8220;Spring Security Architecture Questions&#8221;</a>
</li><li class="listitem">
<a class="xref" href="appendix.html#appendix-faq-howto" title="15.5.4&nbsp;Common &#34;Howto&#34; Requests">Section&nbsp;15.5.4, &#8220;Common "Howto" Requests&#8221;</a>
</li></ul></div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="appendix-faq-general-questions" href="#appendix-faq-general-questions"></a>15.5.1&nbsp;General Questions</h3></div></div></div>

<div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
<a class="xref" href="appendix.html#appendix-faq-other-concerns" title="Will Spring Security take care of all my application security requirements?">the section called &#8220;Will Spring Security take care of all my application security requirements?&#8221;</a>
</li><li class="listitem">
<a class="xref" href="appendix.html#appendix-faq-web-xml" title="Why not just use web.xml security?">the section called &#8220;Why not just use web.xml security?&#8221;</a>
</li><li class="listitem">
<a class="xref" href="appendix.html#appendix-faq-requirements" title="What Java and Spring Framework versions are required?">the section called &#8220;What Java and Spring Framework versions are required?&#8221;</a>
</li><li class="listitem">
<a class="xref" href="appendix.html#appendix-faq-start-simple" title="I&#8217;m new to Spring Security and I need to build an application that supports CAS single sign-on over HTTPS, while allowing Basic authentication locally for certain URLs, authenticating against multiple back end user information sources (LDAP and JDBC). I&#8217;ve copied some configuration files I found but it doesn&#8217;t work.">the section called &#8220;I&#8217;m new to Spring Security and I need to build an application that supports CAS single sign-on over HTTPS, while allowing Basic authentication locally for certain URLs, authenticating against multiple back end user information sources (LDAP and JDBC). I&#8217;ve copied some configuration files I found but it doesn&#8217;t work.&#8221;</a>
</li></ol></div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="appendix-faq-other-concerns" href="#appendix-faq-other-concerns"></a>Will Spring Security take care of all my application security requirements?</h4></div></div></div>

<p>Spring Security provides you with a very flexible framework for your authentication and authorization requirements, but there are many other considerations for building a secure application that are outside its scope.
Web applications are vulnerable to all kinds of attacks which you should be familiar with, preferably before you start development so you can design and code with them in mind from the beginning.
Check out thehttp://www.owasp.org/[OWASP web site] for information on the major issues facing web application developers and the countermeasures you can use against them.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="appendix-faq-web-xml" href="#appendix-faq-web-xml"></a>Why not just use web.xml security?</h4></div></div></div>

<p>Let&#8217;s assume you&#8217;re developing an enterprise application based on Spring.
There are four security concerns you typically need to address: authentication, web request security, service layer security (i.e. your methods that implement business logic), and domain object instance security (i.e. different domain objects have different permissions). With these typical requirements in mind:</p>
<div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
<span class="emphasis"><em>Authentication</em></span>: The servlet specification provides an approach to authentication.
However, you will need to configure the container to perform authentication which typically requires editing of container-specific "realm" settings.
This makes a non-portable configuration, and if you need to write an actual Java class to implement the container&#8217;s authentication interface, it becomes even more non-portable.
With Spring Security you achieve complete portability - right down to the WAR level.
Also, Spring Security offers a choice of production-proven authentication providers and mechanisms, meaning you can switch your authentication approaches at deployment time.
This is particularly valuable for software vendors writing products that need to work in an unknown target environment.
</li><li class="listitem">
<span class="emphasis"><em>Web request security:</em></span> The servlet specification provides an approach to secure your request URIs.
However, these URIs can only be expressed in the servlet specification&#8217;s own limited URI path format.
Spring Security provides a far more comprehensive approach.
For instance, you can use Ant paths or regular expressions, you can consider parts of the URI other than simply the requested page (e.g.
you can consider HTTP GET parameters) and you can implement your own runtime source of configuration data.
This means your web request security can be dynamically changed during the actual execution of your webapp.
</li><li class="listitem">
<p class="simpara"><span class="emphasis"><em>Service layer and domain object security:</em></span> The absence of support in the servlet specification for services layer security or domain object instance security represent serious limitations for multi-tiered applications.
Typically developers either ignore these requirements, or implement security logic within their MVC controller code (or even worse, inside the views). There are serious disadvantages with this approach:</p>
<div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
<span class="emphasis"><em>Separation of concerns:</em></span> Authorization is a crosscutting concern and should be implemented as such.
MVC controllers or views implementing authorization code makes it more difficult to test both the controller and authorization logic, more difficult to debug, and will often lead to code duplication.
</li><li class="listitem">
<span class="emphasis"><em>Support for rich clients and web services:</em></span> If an additional client type must ultimately be supported, any authorization code embedded within the web layer is non-reusable.
It should be considered that Spring remoting exporters only export service layer beans (not MVC controllers). As such authorization logic needs to be located in the services layer to support a multitude of client types.
</li><li class="listitem">
<span class="emphasis"><em>Layering issues:</em></span> An MVC controller or view is simply the incorrect architectural layer to implement authorization decisions concerning services layer methods or domain object instances.
Whilst the Principal may be passed to the services layer to enable it to make the authorization decision, doing so would introduce an additional argument on every services layer method.
A more elegant approach is to use a ThreadLocal to hold the Principal, although this would likely increase development time to a point where it would become more economical (on a cost-benefit basis) to simply use a dedicated security framework.
</li><li class="listitem">
<span class="emphasis"><em>Authorisation code quality:</em></span> It is often said of web frameworks that they "make it easier to do the right things, and harder to do the wrong things". Security frameworks are the same, because they are designed in an abstract manner for a wide range of purposes.
Writing your own authorization code from scratch does not provide the "design check" a framework would offer, and in-house authorization code will typically lack the improvements that emerge from widespread deployment, peer review and new versions.
</li></ol></div>
</li></ol></div>
<p>For simple applications, servlet specification security may just be enough.
Although when considered within the context of web container portability, configuration requirements, limited web request security flexibility, and non-existent services layer and domain object instance security, it becomes clear why developers often look to alternative solutions.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="appendix-faq-requirements" href="#appendix-faq-requirements"></a>What Java and Spring Framework versions are required?</h4></div></div></div>

<p>Spring Security 3.0 and 3.1 require at least JDK 1.5 and also require Spring 3.0.3 as a minimum.
Ideally you should be using the latest release versions to avoid problems.</p>
<p>Spring Security 2.0.x requires a minimum JDK version of 1.4 and is built against Spring 2.0.x.
It should also be compatible with applications using Spring 2.5.x.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="appendix-faq-start-simple" href="#appendix-faq-start-simple"></a>I&#8217;m new to Spring Security and I need to build an application that supports CAS single sign-on over HTTPS, while allowing Basic authentication locally for certain URLs, authenticating against multiple back end user information sources (LDAP and JDBC). I&#8217;ve copied some configuration files I found but it doesn&#8217;t work.</h4></div></div></div>

<p>What could be wrong?</p>
<p>Or subsititute an alternative complex scenario&#8230;&#8203;</p>
<p>Realistically, you need an understanding of the technolgies you are intending to use before you can successfully build applications with them.
Security is complicated.
Setting up a simple configuration using a login form and some hard-coded users using Spring Security&#8217;s namespace is reasonably straightforward.
Moving to using a backed JDBC database is also easy enough.
But if you try and jump straight to a complicated deployment scenario like this you will almost certainly be frustrated.
There is a big jump in the learning curve required to set up systems like CAS, configure LDAP servers and install SSL certificates properly.
So you need to take things one step at a time.</p>
<p>From a Spring Security perspective, the first thing you should do is follow the "Getting Started" guide on the web site.
This will take you through a series of steps to get up and running and get some idea of how the framework operates.
If you are using other technologies which you aren&#8217;t familiar with then you should do some research and try to make sure you can use them in isolation before combining them in a complex system.</p>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="appendix-faq-common-problems" href="#appendix-faq-common-problems"></a>15.5.2&nbsp;Common Problems</h3></div></div></div>

<div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
<p class="simpara">Authentication</p>
<div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
<a class="xref" href="appendix.html#appendix-faq-bad-credentials" title="When I try to log in, I get an error message that says &#34;Bad Credentials&#34;. What&#8217;s wrong?">the section called &#8220;When I try to log in, I get an error message that says "Bad Credentials". What&#8217;s wrong?&#8221;</a>
</li><li class="listitem">
<a class="xref" href="appendix.html#appendix-faq-login-loop" title="My application goes into an &#34;endless loop&#34; when I try to login, what&#8217;s going on?">the section called &#8220;My application goes into an "endless loop" when I try to login, what&#8217;s going on?&#8221;</a>
</li><li class="listitem">
<a class="xref" href="appendix.html#appendix-faq-anon-access-denied" title="I get an exception with the message &#34;Access is denied (user is anonymous);&#34;. What&#8217;s wrong?">the section called &#8220;I get an exception with the message "Access is denied (user is anonymous);". What&#8217;s wrong?&#8221;</a>
</li><li class="listitem">
<a class="xref" href="appendix.html#appendix-faq-cached-secure-page" title="Why can I still see a secured page even after I&#8217;ve logged out of my application?">the section called &#8220;Why can I still see a secured page even after I&#8217;ve logged out of my application?&#8221;</a>
</li><li class="listitem">
<a class="xref" href="appendix.html#auth-exception-credentials-not-found" title="I get an exception with the message &#34;An Authentication object was not found in the SecurityContext&#34;. What&#8217;s wrong?">the section called &#8220;I get an exception with the message "An Authentication object was not found in the SecurityContext". What&#8217;s wrong?&#8221;</a>
</li><li class="listitem">
<a class="xref" href="appendix.html#appendix-faq-ldap-authentication" title="I can&#8217;t get LDAP authentication to work.">the section called &#8220;I can&#8217;t get LDAP authentication to work.&#8221;</a>
</li></ol></div>
</li><li class="listitem">
<p class="simpara">Session Management</p>
<div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
<a class="xref" href="appendix.html#appendix-faq-concurrent-session-same-browser" title="I&#8217;m using Spring Security&#8217;s concurrent session control to prevent users from logging in more than once at a time.">the section called &#8220;I&#8217;m using Spring Security&#8217;s concurrent session control to prevent users from logging in more than once at a time.&#8221;</a>
</li><li class="listitem">
<a class="xref" href="appendix.html#appendix-faq-new-session-on-authentication" title="Why does the session Id change when I authenticate through Spring Security?">the section called &#8220;Why does the session Id change when I authenticate through Spring Security?&#8221;</a>
</li><li class="listitem">
<a class="xref" href="appendix.html#appendix-faq-tomcat-https-session" title="I&#8217;m using Tomcat (or some other servlet container) and have enabled HTTPS for my login page, switching back to HTTP afterwards.">the section called &#8220;I&#8217;m using Tomcat (or some other servlet container) and have enabled HTTPS for my login page, switching back to HTTP afterwards.&#8221;</a>
</li><li class="listitem">
<a class="xref" href="appendix.html#appendix-faq-session-listener-missing" title="I&#8217;m trying to use the concurrent session-control support but it won&#8217;t let me log back in, even if I&#8217;m sure I&#8217;ve logged out and haven&#8217;t exceeded the allowed sessions.">the section called &#8220;I&#8217;m trying to use the concurrent session-control support but it won&#8217;t let me log back in, even if I&#8217;m sure I&#8217;ve logged out and haven&#8217;t exceeded the allowed sessions.&#8221;</a>
</li><li class="listitem">
<a class="xref" href="appendix.html#appendix-faq-unwanted-session-creation" title="Spring Security is creating a session somewhere, even though I&#8217;ve configured it not to, by setting the create-session attribute to never.">the section called &#8220;Spring Security is creating a session somewhere, even though I&#8217;ve configured it not to, by setting the create-session attribute to never.&#8221;</a>
</li></ol></div>
</li><li class="listitem">
<p class="simpara">Miscellaneous</p>
<div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
<a class="xref" href="appendix.html#appendix-faq-forbidden-csrf" title="I get a 403 Forbidden when performing a POST">the section called &#8220;I get a 403 Forbidden when performing a POST&#8221;</a>
</li><li class="listitem">
<a class="xref" href="appendix.html#appendix-faq-no-security-on-forward" title="I&#8217;m forwarding a request to another URL using the RequestDispatcher, but my security constraints aren&#8217;t being applied.">the section called &#8220;I&#8217;m forwarding a request to another URL using the RequestDispatcher, but my security constraints aren&#8217;t being applied.&#8221;</a>
</li><li class="listitem">
<a class="xref" href="appendix.html#appendix-faq-method-security-in-web-context" title="I have added Spring Security&#8217;s <global-method-security&gt; element to my application context but if I add security annotations to my Spring MVC controller beans (Struts actions etc.) then they don&#8217;t seem to have an effect.">the section called &#8220;I have added Spring Security&#8217;s &lt;global-method-security&gt; element to my application context but if I add security annotations to my Spring MVC controller beans (Struts actions etc.) then they don&#8217;t seem to have an effect.&#8221;</a>
</li><li class="listitem">
<a class="xref" href="appendix.html#appendix-faq-no-filters-no-context" title="I have a user who has definitely been authenticated, but when I try to access the SecurityContextHolder during some requests, the Authentication is null.">the section called &#8220;I have a user who has definitely been authenticated, but when I try to access the SecurityContextHolder during some requests, the Authentication is null.&#8221;</a>
</li><li class="listitem">
<a class="xref" href="appendix.html#appendix-faq-method-security-with-taglib" title="The authorize JSP Tag doesn&#8217;t respect my method security annotations when using the URL attribute.">the section called &#8220;The authorize JSP Tag doesn&#8217;t respect my method security annotations when using the URL attribute.&#8221;</a>
</li></ol></div>
</li></ol></div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="appendix-faq-bad-credentials" href="#appendix-faq-bad-credentials"></a>When I try to log in, I get an error message that says "Bad Credentials". What&#8217;s wrong?</h4></div></div></div>

<p>This means that authentication has failed.
It doesn&#8217;t say why, as it is good practice to avoid giving details which might help an attacker guess account names or passwords.</p>
<p>This also means that if you ask this question in the forum, you will not get an answer unless you provide additional information.
As with any issue you should check the output from the debug log, note any exception stacktraces and related messages.
Step through the code in a debugger to see where the authentication fails and why.
Write a test case which exercises your authentication configuration outside of the application.
More often than not, the failure is due to a difference in the password data stored in a database and that entered by the user.
If you are using hashed passwords, make sure the value stored in your database is <span class="emphasis"><em>exactly</em></span> the same as the value produced by the <code class="literal">PasswordEncoder</code> configured in your application.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="appendix-faq-login-loop" href="#appendix-faq-login-loop"></a>My application goes into an "endless loop" when I try to login, what&#8217;s going on?</h4></div></div></div>

<p>A common user problem with infinite loop and redirecting to the login page is caused by accidently configuring the login page as a "secured" resource.
Make sure your configuration allows anonymous access to the login page, either by excluding it from the security filter chain or marking it as requiring ROLE_ANONYMOUS.</p>
<p>If your AccessDecisionManager includes an AuthenticatedVoter, you can use the attribute "IS_AUTHENTICATED_ANONYMOUSLY". This is automatically available if you are using the standard namespace configuration setup.</p>
<p>From Spring Security 2.0.1 onwards, when you are using namespace-based configuration, a check will be made on loading the application context and a warning message logged if your login page appears to be protected.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="appendix-faq-anon-access-denied" href="#appendix-faq-anon-access-denied"></a>I get an exception with the message "Access is denied (user is anonymous);". What&#8217;s wrong?</h4></div></div></div>

<p>This is a debug level message which occurs the first time an anonymous user attempts to access a protected resource.</p>
<pre class="screen">DEBUG [ExceptionTranslationFilter] - Access is denied (user is anonymous); redirecting to authentication entry point
org.springframework.security.AccessDeniedException: Access is denied
at org.springframework.security.vote.AffirmativeBased.decide(AffirmativeBased.java:68)
at org.springframework.security.intercept.AbstractSecurityInterceptor.beforeInvocation(AbstractSecurityInterceptor.java:262)</pre>
<p>It is normal and shouldn&#8217;t be anything to worry about.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="appendix-faq-cached-secure-page" href="#appendix-faq-cached-secure-page"></a>Why can I still see a secured page even after I&#8217;ve logged out of my application?</h4></div></div></div>

<p>The most common reason for this is that your browser has cached the page and you are seeing a copy which is being retrieved from the browsers cache.
Verify this by checking whether the browser is actually sending the request (check your server access logs, the debug log or use a suitable browser debugging plugin such as "Tamper Data" for Firefox). This has nothing to do with Spring Security and you should configure your application or server to set the appropriate <code class="literal">Cache-Control</code> response headers.
Note that SSL requests are never cached.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="auth-exception-credentials-not-found" href="#auth-exception-credentials-not-found"></a>I get an exception with the message "An Authentication object was not found in the SecurityContext". What&#8217;s wrong?</h4></div></div></div>

<p>This is a another debug level message which occurs the first time an anonymous user attempts to access a protected resource, but when you do not have an <code class="literal">AnonymousAuthenticationFilter</code> in your filter chain configuration.</p>
<pre class="screen">DEBUG [ExceptionTranslationFilter] - Authentication exception occurred; redirecting to authentication entry point
org.springframework.security.AuthenticationCredentialsNotFoundException:
                            An Authentication object was not found in the SecurityContext
at org.springframework.security.intercept.AbstractSecurityInterceptor.credentialsNotFound(AbstractSecurityInterceptor.java:342)
at org.springframework.security.intercept.AbstractSecurityInterceptor.beforeInvocation(AbstractSecurityInterceptor.java:254)</pre>
<p>It is normal and shouldn&#8217;t be anything to worry about.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="appendix-faq-ldap-authentication" href="#appendix-faq-ldap-authentication"></a>I can&#8217;t get LDAP authentication to work.</h4></div></div></div>

<p>What&#8217;s wrong with my configuration?</p>
<p>Note that the permissions for an LDAP directory often do not allow you to read the password for a user.
Hence it is often not possible to use the <a class="xref" href="appendix.html#appendix-faq-what-is-userdetailservice" title="What is a UserDetailsService and do I need one?">the section called &#8220;What is a UserDetailsService and do I need one?&#8221;</a> where Spring Security compares the stored password with the one submitted by the user.
The most common approach is to use LDAP "bind", which is one of the operations supported by <a class="ulink" href="http://en.wikipedia.org/wiki/Lightweight_Directory_Access_Protocol" target="_top">the LDAP protocol</a>. With this approach, Spring Security validates the password by attempting to authenticate to the directory as the user.</p>
<p>The most common problem with LDAP authentication is a lack of knowledge of the directory server tree structure and configuration.
This will be different in different companies, so you have to find it out yourself.
Before adding a Spring Security LDAP configuration to an application, it&#8217;s a good idea to write a simple test using standard Java LDAP code (without Spring Security involved), and make sure you can get that to work first.
For example, to authenticate a user, you could use the following code:</p>
<pre class="programlisting"><em><span class="hl-annotation" style="color: gray">@Test</span></em>
<span class="hl-keyword">public</span> <span class="hl-keyword">void</span> ldapAuthenticationIsSuccessful() <span class="hl-keyword">throws</span> Exception {
        Hashtable&lt;String,String&gt; env = <span class="hl-keyword">new</span> Hashtable&lt;String,String&gt;();
        env.put(Context.SECURITY_AUTHENTICATION, <span class="hl-string">"simple"</span>);
        env.put(Context.SECURITY_PRINCIPAL, <span class="hl-string">"cn=joe,ou=users,dc=mycompany,dc=com"</span>);
        env.put(Context.PROVIDER_URL, <span class="hl-string">"ldap://mycompany.com:389/dc=mycompany,dc=com"</span>);
        env.put(Context.SECURITY_CREDENTIALS, <span class="hl-string">"joespassword"</span>);
        env.put(Context.INITIAL_CONTEXT_FACTORY, <span class="hl-string">"com.sun.jndi.ldap.LdapCtxFactory"</span>);

        InitialLdapContext ctx = <span class="hl-keyword">new</span> InitialLdapContext(env, null);

}</pre>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="session-management" href="#session-management"></a>Session Management</h4></div></div></div>

<p>Session management issues are a common source of forum questions.
If you are developing Java web applications, you should understand how the session is maintained between the servlet container and the user&#8217;s browser.
You should also understand the difference between secure and non-secure cookies and the implications of using HTTP/HTTPS and switching between the two.
Spring Security has nothing to do with maintaining the session or providing session identifiers.
This is entirely handled by the servlet container.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="appendix-faq-concurrent-session-same-browser" href="#appendix-faq-concurrent-session-same-browser"></a>I&#8217;m using Spring Security&#8217;s concurrent session control to prevent users from logging in more than once at a time.</h4></div></div></div>

<p>When I open another browser window after logging in, it doesn&#8217;t stop me from logging in again.
Why can I log in more than once?</p>
<p>Browsers generally maintain a single session per browser instance.
You cannot have two separate sessions at once.
So if you log in again in another window or tab you are just reauthenticating in the same session.
The server doesn&#8217;t know anything about tabs, windows or browser instances.
All it sees are HTTP requests and it ties those to a particular session according to the value of the JSESSIONID cookie that they contain.
When a user authenticates during a session, Spring Security&#8217;s concurrent session control checks the number of<span class="emphasis"><em>other authenticated sessions</em></span> that they have.
If they are already authenticated with the same session, then re-authenticating will have no effect.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="appendix-faq-new-session-on-authentication" href="#appendix-faq-new-session-on-authentication"></a>Why does the session Id change when I authenticate through Spring Security?</h4></div></div></div>

<p>With the default configuration, Spring Security changes the session ID when the user authenticates.
If you&#8217;re using a Servlet 3.1 or newer container, the session ID is simply changed.
If you&#8217;re using an older container, Spring Security invalidates the existing session, creates a new session, and transfers the session data to the new session.
Changing the session identifier in this manner prevents"session-fixation" attacks.
You can find more about this online and in the reference manual.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="appendix-faq-tomcat-https-session" href="#appendix-faq-tomcat-https-session"></a>I&#8217;m using Tomcat (or some other servlet container) and have enabled HTTPS for my login page, switching back to HTTP afterwards.</h4></div></div></div>

<p>It doesn&#8217;t work - I just end up back at the login page after authenticating.</p>
<p>This happens because sessions created under HTTPS, for which the session cookie is marked as "secure", cannot subsequently be used under HTTP. The browser will not send the cookie back to the server and any session state will be lost (including the security context information). Starting a session in HTTP first should work as the session cookie won&#8217;t be marked as secure.
However, Spring Security&#8217;s <a class="ulink" href="http://static.springsource.org/spring-security/site/docs/3.1.x/reference/springsecurity-single.html#ns-session-fixation" target="_top">Session Fixation Protection</a> can interfere with this because it results in a new session ID cookie being sent back to the user&#8217;s browser, usually with the secure flag.
To get around this, you can disable session fixation protection, but in newer Servlet containers you can also configure session cookies to never use the secure flag.
Note that switching between HTTP and HTTPS is not a good idea in general, as any application which uses HTTP at all is vulnerable to man-in-the-middle attacks.
To be truly secure, the user should begin accessing your site in HTTPS and continue using it until they log out.
Even clicking on an HTTPS link from a page accessed over HTTP is potentially risky.
If you need more convincing, check out a tool like <a class="ulink" href="http://www.thoughtcrime.org/software/sslstrip/" target="_top">sslstrip</a>.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="i-m-not-switching-between-http-and-https-but-my-session-is-still-getting-lost" href="#i-m-not-switching-between-http-and-https-but-my-session-is-still-getting-lost"></a>I&#8217;m not switching between HTTP and HTTPS but my session is still getting lost</h4></div></div></div>

<p>Sessions are maintained either by exchanging a session cookie or by adding a <code class="literal">jsessionid</code> parameter to URLs (this happens automatically if you are using JSTL to output URLs, or if you call <code class="literal">HttpServletResponse.encodeUrl</code> on URLs (before a redirect, for example). If clients have cookies disabled, and you are not rewriting URLs to include the <code class="literal">jsessionid</code>, then the session will be lost.
Note that the use of cookies is preferred for security reasons, as it does not expose the session information in the URL.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="appendix-faq-session-listener-missing" href="#appendix-faq-session-listener-missing"></a>I&#8217;m trying to use the concurrent session-control support but it won&#8217;t let me log back in, even if I&#8217;m sure I&#8217;ve logged out and haven&#8217;t exceeded the allowed sessions.</h4></div></div></div>

<p>Make sure you have added the listener to your web.xml file.
It is essential to make sure that the Spring Security session registry is notified when a session is destroyed.
Without it, the session information will not be removed from the registry.</p>
<pre class="programlisting"><span class="hl-tag">&lt;listener&gt;</span>
        <span class="hl-tag">&lt;listener-class&gt;</span>org.springframework.security.web.session.HttpSessionEventPublisher<span class="hl-tag">&lt;/listener-class&gt;</span>
<span class="hl-tag">&lt;/listener&gt;</span></pre>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="appendix-faq-unwanted-session-creation" href="#appendix-faq-unwanted-session-creation"></a>Spring Security is creating a session somewhere, even though I&#8217;ve configured it not to, by setting the create-session attribute to never.</h4></div></div></div>

<p>This usually means that the user&#8217;s application is creating a session somewhere, but that they aren&#8217;t aware of it.
The most common culprit is a JSP. Many people aren&#8217;t aware that JSPs create sessions by default.
To prevent a JSP from creating a session, add the directive <code class="literal">&lt;%@ page session="false" %&gt;</code> to the top of the page.</p>
<p>If you are having trouble working out where a session is being created, you can add some debugging code to track down the location(s). One way to do this would be to add a <code class="literal">javax.servlet.http.HttpSessionListener</code> to your application, which calls <code class="literal">Thread.dumpStack()</code> in the <code class="literal">sessionCreated</code> method.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="appendix-faq-forbidden-csrf" href="#appendix-faq-forbidden-csrf"></a>I get a 403 Forbidden when performing a POST</h4></div></div></div>

<p>If an HTTP 403 Forbidden is returned for HTTP POST, but works for HTTP GET then the issue is most likely related to <a class="ulink" href="http://docs.spring.io/spring-security/site/docs/3.2.x/reference/htmlsingle/#csrf" target="_top">CSRF</a>. Either provide the CSRF Token or disable CSRF protection (not recommended).</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="appendix-faq-no-security-on-forward" href="#appendix-faq-no-security-on-forward"></a>I&#8217;m forwarding a request to another URL using the RequestDispatcher, but my security constraints aren&#8217;t being applied.</h4></div></div></div>

<p>Filters are not applied by default to forwards or includes.
If you really want the security filters to be applied to forwards and/or includes, then you have to configure these explicitly in your web.xml using the &lt;dispatcher&gt; element, a child element of &lt;filter-mapping&gt;.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="appendix-faq-method-security-in-web-context" href="#appendix-faq-method-security-in-web-context"></a>I have added Spring Security&#8217;s &lt;global-method-security&gt; element to my application context but if I add security annotations to my Spring MVC controller beans (Struts actions etc.) then they don&#8217;t seem to have an effect.</h4></div></div></div>

<p>In a Spring web application, the application context which holds the Spring MVC beans for the dispatcher servlet is often separate from the main application context.
It is often defined in a file called <code class="literal">myapp-servlet.xml</code>, where "myapp" is the name assigned to the Spring <code class="literal">DispatcherServlet</code> in <code class="literal">web.xml</code>. An application can have multiple <code class="literal">DispatcherServlet</code>s, each with its own isolated application context.
The beans in these "child" contexts are not visible to the rest of the application.
The"parent" application context is loaded by the <code class="literal">ContextLoaderListener</code> you define in your <code class="literal">web.xml</code> and is visible to all the child contexts.
This parent context is usually where you define your security configuration, including the <code class="literal">&lt;global-method-security&gt;</code> element). As a result any security constraints applied to methods in these web beans will not be enforced, since the beans cannot be seen from the <code class="literal">DispatcherServlet</code> context.
You need to either move the <code class="literal">&lt;global-method-security&gt;</code> declaration to the web context or moved the beans you want secured into the main application context.</p>
<p>Generally we would recommend applying method security at the service layer rather than on individual web controllers.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="appendix-faq-no-filters-no-context" href="#appendix-faq-no-filters-no-context"></a>I have a user who has definitely been authenticated, but when I try to access the SecurityContextHolder during some requests, the Authentication is null.</h4></div></div></div>

<p>Why can&#8217;t I see the user information?</p>
<p>If you have excluded the request from the security filter chain using the attribute <code class="literal">filters='none'</code> in the <code class="literal">&lt;intercept-url&gt;</code> element that matches the URL pattern, then the <code class="literal">SecurityContextHolder</code> will not be populated for that request.
Check the debug log to see whether the request is passing through the filter chain.
(You are reading the debug log, right?).</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="appendix-faq-method-security-with-taglib" href="#appendix-faq-method-security-with-taglib"></a>The authorize JSP Tag doesn&#8217;t respect my method security annotations when using the URL attribute.</h4></div></div></div>

<p>Method security will not hide links when using the <code class="literal">url</code> attribute in <code class="literal">&lt;sec:authorize&gt;</code> because we cannot readily reverse engineer what URL is mapped to what controller endpoint as controllers can rely on headers, current user, etc to determine what method to invoke.</p>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="appendix-faq-architecture" href="#appendix-faq-architecture"></a>15.5.3&nbsp;Spring Security Architecture Questions</h3></div></div></div>

<div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
<a class="xref" href="appendix.html#appendix-faq-where-is-class-x" title="How do I know which package class X is in?">the section called &#8220;How do I know which package class X is in?&#8221;</a>
</li><li class="listitem">
<a class="xref" href="appendix.html#appendix-faq-namespace-to-bean-mapping" title="How do the namespace elements map to conventional bean configurations?">the section called &#8220;How do the namespace elements map to conventional bean configurations?&#8221;</a>
</li><li class="listitem">
<a class="xref" href="appendix.html#appendix-faq-role-prefix" title="What does &#34;ROLE_&#34; mean and why do I need it on my role names?">the section called &#8220;What does "ROLE_" mean and why do I need it on my role names?&#8221;</a>
</li><li class="listitem">
<a class="xref" href="appendix.html#appendix-faq-what-dependencies" title="How do I know which dependencies to add to my application to work with Spring Security?">the section called &#8220;How do I know which dependencies to add to my application to work with Spring Security?&#8221;</a>
</li><li class="listitem">
<a class="xref" href="appendix.html#appendix-faq-apacheds-deps" title="What dependencies are needed to run an embedded ApacheDS LDAP server?">the section called &#8220;What dependencies are needed to run an embedded ApacheDS LDAP server?&#8221;</a>
</li><li class="listitem">
<a class="xref" href="appendix.html#appendix-faq-what-is-userdetailservice" title="What is a UserDetailsService and do I need one?">the section called &#8220;What is a UserDetailsService and do I need one?&#8221;</a>
</li></ol></div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="appendix-faq-where-is-class-x" href="#appendix-faq-where-is-class-x"></a>How do I know which package class X is in?</h4></div></div></div>

<p>The best way of locating classes is by installing the Spring Security source in your IDE. The distribution includes source jars for each of the modules the project is divided up into.
Add these to your project source path and you can navigate directly to Spring Security classes (<code class="literal">Ctrl-Shift-T</code> in Eclipse). This also makes debugging easier and allows you to troubleshoot exceptions by looking directly at the code where they occur to see what&#8217;s going on there.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="appendix-faq-namespace-to-bean-mapping" href="#appendix-faq-namespace-to-bean-mapping"></a>How do the namespace elements map to conventional bean configurations?</h4></div></div></div>

<p>There is a general overview of what beans are created by the namespace in the namespace appendix of the reference guide.
There is also a detailed blog article called "Behind the Spring Security Namespace" on <a class="ulink" href="http://blog.springsource.com/2010/03/06/behind-the-spring-security-namespace/" target="_top">blog.springsource.com</a>. If want to know the full details then the code is in the <code class="literal">spring-security-config</code> module within the Spring Security 3.0 distribution.
You should probably read the chapters on namespace parsing in the standard Spring Framework reference documentation first.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="appendix-faq-role-prefix" href="#appendix-faq-role-prefix"></a>What does "ROLE_" mean and why do I need it on my role names?</h4></div></div></div>

<p>Spring Security has a voter-based architecture which means that an access decision is made by a series of <code class="literal">AccessDecisionVoter</code>s.
The voters act on the "configuration attributes" which are specified for a secured resource (such as a method invocation). With this approach, not all attributes may be relevant to all voters and a voter needs to know when it should ignore an attribute (abstain) and when it should vote to grant or deny access based on the attribute value.
The most common voter is the <code class="literal">RoleVoter</code> which by default votes whenever it finds an attribute with the "ROLE_" prefix.
It makes a simple comparison of the attribute (such as "ROLE_USER") with the names of the authorities which the current user has been assigned.
If it finds a match (they have an authority called "ROLE_USER"), it votes to grant access, otherwise it votes to deny access.</p>
<p>The prefix can be changed by setting the <code class="literal">rolePrefix</code> property of <code class="literal">RoleVoter</code>. If you only need to use roles in your application and have no need for other custom voters, then you can set the prefix to a blank string, in which case the <code class="literal">RoleVoter</code> will treat all attributes as roles.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="appendix-faq-what-dependencies" href="#appendix-faq-what-dependencies"></a>How do I know which dependencies to add to my application to work with Spring Security?</h4></div></div></div>

<p>It will depend on what features you are using and what type of application you are developing.
With Spring Security 3.0, the project jars are divided into clearly distinct areas of functionality, so it is straightforward to work out which Spring Security jars you need from your application requirements.
All applications will need the <code class="literal">spring-security-core</code> jar.
If you&#8217;re developing a web application, you need the <code class="literal">spring-security-web</code> jar.
If you&#8217;re using security namespace configuration you need the <code class="literal">spring-security-config</code> jar, for LDAP support you need the <code class="literal">spring-security-ldap</code> jar and so on.</p>
<p>For third-party jars the situation isn&#8217;t always quite so obvious.
A good starting point is to copy those from one of the pre-built sample applications WEB-INF/lib directories.
For a basic application, you can start with the tutorial sample.
If you want to use LDAP, with an embedded test server, then use the LDAP sample as a starting point.
The reference manual also includeshttp://static.springsource.org/spring-security/site/docs/3.1.x/reference/springsecurity-single.html#appendix-dependencies[an appendix] listing the first-level dependencies for each Spring Security module with some information on whether they are optional and what they are required for.</p>
<p>If you are building your project with maven, then adding the appropriate Spring Security modules as dependencies to your pom.xml will automatically pull in the core jars that the framework requires.
Any which are marked as "optional" in the Spring Security POM files will have to be added to your own pom.xml file if you need them.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="appendix-faq-apacheds-deps" href="#appendix-faq-apacheds-deps"></a>What dependencies are needed to run an embedded ApacheDS LDAP server?</h4></div></div></div>

<p>If you are using Maven, you need to add the folowing to your pom dependencies:</p>
<pre class="screen">&lt;dependency&gt;
        &lt;groupId&gt;org.apache.directory.server&lt;/groupId&gt;
        &lt;artifactId&gt;apacheds-core&lt;/artifactId&gt;
        &lt;version&gt;1.5.5&lt;/version&gt;
        &lt;scope&gt;runtime&lt;/scope&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
        &lt;groupId&gt;org.apache.directory.server&lt;/groupId&gt;
        &lt;artifactId&gt;apacheds-server-jndi&lt;/artifactId&gt;
        &lt;version&gt;1.5.5&lt;/version&gt;
        &lt;scope&gt;runtime&lt;/scope&gt;
&lt;/dependency&gt;</pre>
<p>The other required jars should be pulled in transitively.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="appendix-faq-what-is-userdetailservice" href="#appendix-faq-what-is-userdetailservice"></a>What is a UserDetailsService and do I need one?</h4></div></div></div>

<p><code class="literal">UserDetailsService</code> is a DAO interface for loading data that is specific to a user account.
It has no other function other to load that data for use by other components within the framework.
It is not responsible for authenticating the user.
Authenticating a user with a username/password combination is most commonly performed by the <code class="literal">DaoAuthenticationProvider</code>, which is injected with a <code class="literal">UserDetailsService</code> to allow it to load the password (and other data) for a user in order to compare it with the submitted value.
Note that if you are using LDAP, <a class="link" href="appendix.html#appendix-faq-ldap-authentication" title="I can&#8217;t get LDAP authentication to work.">this approach may not work</a>.</p>
<p>If you want to customize the authentication process then you should implement <code class="literal">AuthenticationProvider</code> yourself.
See this <a class="ulink" href="http://blog.springsource.com/2010/08/02/spring-security-in-google-app-engine/" target="_top"> blog article</a> for an example integrating Spring Security authentication with Google App Engine.</p>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="appendix-faq-howto" href="#appendix-faq-howto"></a>15.5.4&nbsp;Common "Howto" Requests</h3></div></div></div>

<div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
<a class="xref" href="appendix.html#appendix-faq-extra-login-fields" title="I need to login in with more information than just the username.">the section called &#8220;I need to login in with more information than just the username.&#8221;</a>
</li><li class="listitem">
<a class="xref" href="appendix.html#appendix-faq-matching-url-fragments" title="How do I apply different intercept-url constraints where only the fragment value of the requested URLs differs (e.g./foo#bar and /foo#blah?">the section called &#8220;How do I apply different intercept-url constraints where only the fragment value of the requested URLs differs (e.g./foo#bar and /foo#blah?&#8221;</a>
</li><li class="listitem">
<a class="xref" href="appendix.html#appendix-faq-request-details-in-user-service" title="How do I access the user&#8217;s IP Address (or other web-request data) in a UserDetailsService?">the section called &#8220;How do I access the user&#8217;s IP Address (or other web-request data) in a UserDetailsService?&#8221;</a>
</li><li class="listitem">
<a class="xref" href="appendix.html#appendix-faq-access-session-from-user-service" title="How do I access the HttpSession from a UserDetailsService?">the section called &#8220;How do I access the HttpSession from a UserDetailsService?&#8221;</a>
</li><li class="listitem">
<a class="xref" href="appendix.html#appendix-faq-password-in-user-service" title="How do I access the user&#8217;s password in a UserDetailsService?">the section called &#8220;How do I access the user&#8217;s password in a UserDetailsService?&#8221;</a>
</li><li class="listitem">
<a class="xref" href="appendix.html#appendix-faq-dynamic-url-metadata" title="How do I define the secured URLs within an application dynamically?">the section called &#8220;How do I define the secured URLs within an application dynamically?&#8221;</a>
</li><li class="listitem">
<a class="xref" href="appendix.html#appendix-faq-ldap-authorities" title="How do I authenticate against LDAP but load user roles from a database?">the section called &#8220;How do I authenticate against LDAP but load user roles from a database?&#8221;</a>
</li><li class="listitem">
<a class="xref" href="appendix.html#appendix-faq-namespace-post-processor" title="I want to modify the property of a bean that is created by the namespace, but there is nothing in the schema to support it.">the section called &#8220;I want to modify the property of a bean that is created by the namespace, but there is nothing in the schema to support it.&#8221;</a>
</li></ol></div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="appendix-faq-extra-login-fields" href="#appendix-faq-extra-login-fields"></a>I need to login in with more information than just the username.</h4></div></div></div>

<p>How do I add support for extra login fields (e.g.
a company name)?</p>
<p>This question comes up repeatedly in the Spring Security forum so you                           will find more information there by searching the archives (or through google).</p>
<p>The submitted login information is processed by an instance of <code class="literal">UsernamePasswordAuthenticationFilter</code>. You will need to customize this class to handle the extra data field(s). One option is to use your own customized authentication token class (rather than the standard <code class="literal">UsernamePasswordAuthenticationToken</code>), another is simply to concatenate the extra fields with the username (for example, using a ":" as the separator) and pass them in the username property of <code class="literal">UsernamePasswordAuthenticationToken</code>.</p>
<p>You will also need to customize the actual authentication process.
If you are using a custom authentication token class, for example, you will have to write an <code class="literal">AuthenticationProvider</code> to handle it (or extend the standard <code class="literal">DaoAuthenticationProvider</code>). If you have concatenated the fields, you can implement your own <code class="literal">UserDetailsService</code> which splits them up and loads the appropriate user data for authentication.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="appendix-faq-matching-url-fragments" href="#appendix-faq-matching-url-fragments"></a>How do I apply different intercept-url constraints where only the fragment value of the requested URLs differs (e.g./foo#bar and /foo#blah?</h4></div></div></div>

<p>You can&#8217;t do this, since the fragment is not transmitted from the browser to the server.
The URLs above are identical from the server&#8217;s perspective.
This is a common question from GWT users.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="appendix-faq-request-details-in-user-service" href="#appendix-faq-request-details-in-user-service"></a>How do I access the user&#8217;s IP Address (or other web-request data) in a UserDetailsService?</h4></div></div></div>

<p>Obviously you can&#8217;t (without resorting to something like thread-local variables) since the only information supplied to the interface is the username.
Instead of implementing <code class="literal">UserDetailsService</code>, you should implement <code class="literal">AuthenticationProvider</code> directly and extract the information from the supplied <code class="literal">Authentication</code> token.</p>
<p>In a standard web setup, the <code class="literal">getDetails()</code> method on the <code class="literal">Authentication</code> object will return an instance of <code class="literal">WebAuthenticationDetails</code>. If you need additional information, you can inject a custom <code class="literal">AuthenticationDetailsSource</code> into the authentication filter you are using.
If you are using the namespace, for example with the <code class="literal">&lt;form-login&gt;</code> element, then you should remove this element and replace it with a <code class="literal">&lt;custom-filter&gt;</code> declaration pointing to an explicitly configured <code class="literal">UsernamePasswordAuthenticationFilter</code>.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="appendix-faq-access-session-from-user-service" href="#appendix-faq-access-session-from-user-service"></a>How do I access the HttpSession from a UserDetailsService?</h4></div></div></div>

<p>You can&#8217;t, since the <code class="literal">UserDetailsService</code> has no awareness of the servlet API. If you want to store custom user data, then you should customize the <code class="literal">UserDetails</code> object which is returned.
This can then be accessed at any point, via the thread-local <code class="literal">SecurityContextHolder</code>. A call to <code class="literal">SecurityContextHolder.getContext().getAuthentication().getPrincipal()</code> will return this custom object.</p>
<p>If you really need to access the session, then it must be done by customizing the web tier.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="appendix-faq-password-in-user-service" href="#appendix-faq-password-in-user-service"></a>How do I access the user&#8217;s password in a UserDetailsService?</h4></div></div></div>

<p>You can&#8217;t (and shouldn&#8217;t). You are probably misunderstanding its purpose.
See "<a class="link" href="appendix.html#appendix-faq-what-is-userdetailservice" title="What is a UserDetailsService and do I need one?">What is a UserDetailsService?</a>" above.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="appendix-faq-dynamic-url-metadata" href="#appendix-faq-dynamic-url-metadata"></a>How do I define the secured URLs within an application dynamically?</h4></div></div></div>

<p>People often ask about how to store the mapping between secured URLs and security metadata attributes in a database, rather than in the application context.</p>
<p>The first thing you should ask yourself is if you really need to do this.
If an application requires securing, then it also requires that the security be tested thoroughly based on a defined policy.
It may require auditing and acceptance testing before being rolled out into a production environment.
A security-conscious organization should be aware that the benefits of their diligent testing process could be wiped out instantly by allowing the security settings to be modified at runtime by changing a row or two in a configuration database.
If you have taken this into account (perhaps using multiple layers of security within your application) then Spring Security allows you to fully customize the source of security metadata.
You can make it fully dynamic if you choose.</p>
<p>Both method and web security are protected by subclasses of <code class="literal">AbstractSecurityInterceptor</code> which is configured with a <code class="literal">SecurityMetadataSource</code> from which it obtains the metadata for a particular method or filter invocation.
For web security, the interceptor class is <code class="literal">FilterSecurityInterceptor</code> and it uses the marker interface <code class="literal">FilterInvocationSecurityMetadataSource</code>. The "secured object" type it operates on is a <code class="literal">FilterInvocation</code>. The default implementation which is used (both in the namespace <code class="literal">&lt;http&gt;</code> and when configuring the interceptor explicitly, stores the list of URL patterns and their corresponding list of "configuration attributes" (instances of <code class="literal">ConfigAttribute</code>) in an in-memory map.</p>
<p>To load the data from an alternative source, you must be using an explicitly declared security filter chain (typically Spring Security&#8217;s <code class="literal">FilterChainProxy</code>) in order to customize the <code class="literal">FilterSecurityInterceptor</code> bean.
You can&#8217;t use the namespace.
You would then implement <code class="literal">FilterInvocationSecurityMetadataSource</code> to load the data as you please for a particular <code class="literal">FilterInvocation</code> <a href="#ftn.d5e10296" class="footnote" name="d5e10296"><sup class="footnote">[25]</sup></a>. A very basic outline would look something like this:</p>
<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> MyFilterSecurityMetadataSource <span class="hl-keyword">implements</span> FilterInvocationSecurityMetadataSource {

    <span class="hl-keyword">public</span> List&lt;ConfigAttribute&gt; getAttributes(Object object) {
        FilterInvocation fi = (FilterInvocation) object;
            String url = fi.getRequestUrl();
            String httpMethod = fi.getRequest().getMethod();
            List&lt;ConfigAttribute&gt; attributes = <span class="hl-keyword">new</span> ArrayList&lt;ConfigAttribute&gt;();

            <span class="hl-comment">// Lookup your database (or other source) using this information and populate the</span>
            <span class="hl-comment">// list of attributes</span>

            <span class="hl-keyword">return</span> attributes;
    }

    <span class="hl-keyword">public</span> Collection&lt;ConfigAttribute&gt; getAllConfigAttributes() {
        <span class="hl-keyword">return</span> null;
    }

    <span class="hl-keyword">public</span> <span class="hl-keyword">boolean</span> supports(Class&lt;?&gt; clazz) {
        <span class="hl-keyword">return</span> FilterInvocation.<span class="hl-keyword">class</span>.isAssignableFrom(clazz);
    }
}</pre>
<p>For more information, look at the code for <code class="literal">DefaultFilterInvocationSecurityMetadataSource</code>.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="appendix-faq-ldap-authorities" href="#appendix-faq-ldap-authorities"></a>How do I authenticate against LDAP but load user roles from a database?</h4></div></div></div>

<p>The <code class="literal">LdapAuthenticationProvider</code> bean (which handles normal LDAP authentication in Spring Security) is configured with two separate strategy interfaces, one which performs the authentication and one which loads the user authorities, called <code class="literal">LdapAuthenticator</code> and <code class="literal">LdapAuthoritiesPopulator</code> respectively.
The <code class="literal">DefaultLdapAuthoritiesPopulator</code> loads the user authorities from the LDAP directory and has various configuration parameters to allow you to specify how these should be retrieved.</p>
<p>To use JDBC instead, you can implement the interface yourself, using whatever SQL is appropriate for your schema:</p>
<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> MyAuthoritiesPopulator <span class="hl-keyword">implements</span> LdapAuthoritiesPopulator {
    <em><span class="hl-annotation" style="color: gray">@Autowired</span></em>
    JdbcTemplate template;

    List&lt;GrantedAuthority&gt; getGrantedAuthorities(DirContextOperations userData, String username) {
        List&lt;GrantedAuthority&gt; = template.query(<span class="hl-string">"select role from roles where username = ?"</span>,
                                                                                                <span class="hl-keyword">new</span> String[] {username},
                                                                                                <span class="hl-keyword">new</span> RowMapper&lt;GrantedAuthority&gt;() {
            <strong class="hl-tag" style="color: blue">/**
             *  We're assuming here that you're using the standard convention of using the role
             *  prefix "ROLE_" to mark attributes which are supported by Spring Security's RoleVoter.
             */</strong>
            <span class="hl-keyword">public</span> GrantedAuthority mapRow(ResultSet rs, <span class="hl-keyword">int</span> rowNum) <span class="hl-keyword">throws</span> SQLException {
                <span class="hl-keyword">return</span> <span class="hl-keyword">new</span> SimpleGrantedAuthority(<span class="hl-string">"ROLE_"</span> + rs.getString(<span class="hl-number">1</span>);
            }
        }
    }
}</pre>
<p>You would then add a bean of this type to your application context and inject it into the <code class="literal">LdapAuthenticationProvider</code>. This is covered in the section on configuring LDAP using explicit Spring beans in the LDAP chapter of the reference manual.
Note that you can&#8217;t use the namespace for configuration in this case.
You should also consult the Javadoc for the relevant classes and interfaces.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="appendix-faq-namespace-post-processor" href="#appendix-faq-namespace-post-processor"></a>I want to modify the property of a bean that is created by the namespace, but there is nothing in the schema to support it.</h4></div></div></div>

<p>What can I do short of abandoning namespace use?</p>
<p>The namespace functionality is intentionally limited, so it doesn&#8217;t cover everything that you can do with plain beans.
If you want to do something simple, like modify a bean, or inject a different dependency, you can do this by adding a <code class="literal">BeanPostProcessor</code> to your configuration.
More information can be found in the <a class="ulink" href="http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/htmlsingle/spring-framework-reference.html#beans-factory-extension-bpp" target="_top">Spring Reference Manual</a>. In order to do this, you need to know a bit about which beans are created, so you should also read the blog article in the above question on <a class="link" href="appendix.html#appendix-faq-namespace-to-bean-mapping" title="How do the namespace elements map to conventional bean configurations?">how the namespace maps to Spring beans</a>.</p>
<p>Normally, you would add the functionality you require to the <code class="literal">postProcessBeforeInitialization</code> method of <code class="literal">BeanPostProcessor</code>. Let&#8217;s say that you want to customize the <code class="literal">AuthenticationDetailsSource</code> used by the <code class="literal">UsernamePasswordAuthenticationFilter</code>, (created by the <code class="literal">form-login</code> element). You want to extract a particular header called <code class="literal">CUSTOM_HEADER</code> from the request and make use of it while authenticating the user.
The processor class would look like this:</p>
<pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> BeanPostProcessor <span class="hl-keyword">implements</span> BeanPostProcessor {

        <span class="hl-keyword">public</span> Object postProcessAfterInitialization(Object bean, String name) {
                <span class="hl-keyword">if</span> (bean <span class="hl-keyword">instanceof</span> UsernamePasswordAuthenticationFilter) {
                        System.out.println(<span class="hl-string">"********* Post-processing "</span> + name);
                        ((UsernamePasswordAuthenticationFilter)bean).setAuthenticationDetailsSource(
                                        <span class="hl-keyword">new</span> AuthenticationDetailsSource() {
                                                <span class="hl-keyword">public</span> Object buildDetails(Object context) {
                                                        <span class="hl-keyword">return</span> ((HttpServletRequest)context).getHeader(<span class="hl-string">"CUSTOM_HEADER"</span>);
                                                }
                                        });
                }
                <span class="hl-keyword">return</span> bean;
        }

        <span class="hl-keyword">public</span> Object postProcessBeforeInitialization(Object bean, String name) {
                <span class="hl-keyword">return</span> bean;
        }
}</pre>
<p>You would then register this bean in your application context.
Spring will automatically invoke it on the beans defined in the application context.</p>
</div>
</div>
</div>
<div class="footnotes"><br><hr style="width:100; text-align:left;margin-left: 0"><div id="ftn.d5e7286" class="footnote"><p><a href="#d5e7286" class="simpara"><sup class="simpara">[22] </sup></a>See the <a class="link" href="ns-config.html#ns-web-xml" title="7.2.1&nbsp;web.xml Configuration">introductory chapter</a> for how to set up the mapping from your <code class="literal">web.xml</code></p></div><div id="ftn.d5e8055" class="footnote"><p><a href="#d5e8055" class="simpara"><sup class="simpara">[23] </sup></a>This feature is really just provided for convenience and is not intended for production (where a view technology will have been chosen and can be used to render a customized login page). The class <code class="literal">DefaultLoginPageGeneratingFilter</code> is responsible for rendering the login page and will provide login forms for both normal form login and/or OpenID if required.</p></div><div id="ftn.d5e8528" class="footnote"><p><a href="#d5e8528" class="simpara"><sup class="simpara">[24] </sup></a>This doesn&#8217;t affect the use of <code class="literal">PersistentTokenBasedRememberMeServices</code>, where the tokens are stored on the server side.</p></div><div id="ftn.d5e10296" class="footnote"><p><a href="#d5e10296" class="simpara"><sup class="simpara">[25] </sup></a>The <code class="literal">FilterInvocation</code> object contains the <code class="literal">HttpServletRequest</code>, so you can obtain the URL or any other relevant information on which to base your decision on what the list of returned attributes will contain.</p></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="data.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="servlet-applications.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="reactive-applications.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">14.&nbsp;Spring Data Integration&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;Part&nbsp;III.&nbsp;Reactive Applications</td></tr></table></div></body></html>