
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Exception Testing Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.2">
        
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="Matchers-and-assertThat.html" />
    
    
    <link rel="prev" href="Test-Execution-Order.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="Download-and-Install.html">
            
                <a href="Download-and-Install.html">
            
                    
                    Download and Install
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="Getting-Started.html">
            
                <a href="Getting-Started.html">
            
                    
                    Getting Started
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="Maintainer-Documentation.html">
            
                <a href="Maintainer-Documentation.html">
            
                    
                    Maintainer Documentation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="Deprecation-Policy.html">
            
                <a href="Deprecation-Policy.html">
            
                    
                    Deprecation Policy
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="I-want-to-help!.html">
            
                <a href="I-want-to-help!.html">
            
                    
                    I want to help!
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">JUnit Usage and Idioms</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="Assertions.html">
            
                <a href="Assertions.html">
            
                    
                    Assertions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="Test-Runners.html">
            
                <a href="Test-Runners.html">
            
                    
                    Test Runners
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="Aggregating-tests-in-Suites.html">
            
                <a href="Aggregating-tests-in-Suites.html">
            
                    
                    Aggregating tests in Suites
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="Test-Execution-Order.html">
            
                <a href="Test-Execution-Order.html">
            
                    
                    Test Execution Order
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="2.5" data-path="Exception-Testing.html">
            
                <a href="Exception-Testing.html">
            
                    
                    Exception Testing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.6" data-path="Matchers-and-assertThat.html">
            
                <a href="Matchers-and-assertThat.html">
            
                    
                    Matchers and assertThat
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.7" data-path="Ignoring-Tests.html">
            
                <a href="Ignoring-Tests.html">
            
                    
                    Ignoring Tests
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.8" data-path="Timeout-for-Tests.html">
            
                <a href="Timeout-for-Tests.html">
            
                    
                    Timeout for Tests
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.9" data-path="Parameterized-Tests.html">
            
                <a href="Parameterized-Tests.html">
            
                    
                    Parameterized Tests
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.10" data-path="Assumptions-with-Assume.html">
            
                <a href="Assumptions-with-Assume.html">
            
                    
                    Assumptions with Assume
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.11" data-path="Rules.html">
            
                <a href="Rules.html">
            
                    
                    Rules
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.12" data-path="Theories.html">
            
                <a href="Theories.html">
            
                    
                    Theories
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.13" data-path="Test-Fixtures.html">
            
                <a href="Test-Fixtures.html">
            
                    
                    Test Fixtures
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.14" data-path="Categories.html">
            
                <a href="Categories.html">
            
                    
                    Categories
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.15" data-path="Use-with-Maven.html">
            
                <a href="Use-with-Maven.html">
            
                    
                    Use with Maven
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.16" data-path="Use-with-Gradle.html">
            
                <a href="Use-with-Gradle.html">
            
                    
                    Use with Gradle
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.17" data-path="Multithreaded-code-and-Concurrency.html">
            
                <a href="Multithreaded-code-and-Concurrency.html">
            
                    
                    Multithreaded code and Concurrency
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.18" data-path="Java-contract-test-helpers.html">
            
                <a href="Java-contract-test-helpers.html">
            
                    
                    Java contract test helpers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.19" data-path="Continuous-Testing.html">
            
                <a href="Continuous-Testing.html">
            
                    
                    Continuous Testing
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Third-party extensions</li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="Custom-Runners.html">
            
                <a href="Custom-Runners.html">
            
                    
                    Custom Runners
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >Exception Testing</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="expected-exceptions">Expected Exceptions</h1>
<p>How do you verify that code throws exceptions as expected?
Verifying that code completes normally is important, but making sure the code behaves as expected in exceptional situations is vital too. For example:</p>
<pre><code class="lang-java"><span class="hljs-keyword">new</span> ArrayList&lt;Object&gt;().get(<span class="hljs-number">0</span>);
</code></pre>
<p>This code should throw an IndexOutOfBoundsException. The <code>@Test</code> annotation has an optional parameter &quot;<code>expected</code>&quot; that takes as values subclasses of <code>Throwable</code>. If we wanted to verify that <code>ArrayList</code> throws the correct exception, we would write:</p>
<pre><code class="lang-java"><span class="hljs-meta">@Test</span>(expected = IndexOutOfBoundsException.class) 
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">empty</span><span class="hljs-params">()</span> </span>{ 
     <span class="hljs-keyword">new</span> ArrayList&lt;Object&gt;().get(<span class="hljs-number">0</span>); 
}
</code></pre>
<p>The <code>expected</code> parameter should be used with care. The above test will pass if <em>any</em> code in the method throws <code>IndexOutOfBoundsException</code>. For longer tests, it&apos;s recommended to use the <code>ExpectedException</code> rule, which is described below.</p>
<h2 id="deeper-testing-of-the-exception">Deeper Testing of the Exception</h2>
<p>The above approach is useful for simple cases, but it has its limits. For example, you can&apos;t test the value of the message in the exception, or the state of a domain object after the exception has been thrown.  </p>
<h3 id="trycatch-idiom">Try/Catch Idiom</h3>
<p>To address this you can use the try/catch idiom which prevailed in JUnit 3.x:</p>
<pre><code class="lang-java"><span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testExceptionMessage</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">new</span> ArrayList&lt;Object&gt;().get(<span class="hljs-number">0</span>);
        fail(<span class="hljs-string">&quot;Expected an IndexOutOfBoundsException to be thrown&quot;</span>);
    } <span class="hljs-keyword">catch</span> (IndexOutOfBoundsException anIndexOutOfBoundsException) {
        assertThat(anIndexOutOfBoundsException.getMessage(), is(<span class="hljs-string">&quot;Index: 0, Size: 0&quot;</span>));
    }
}
</code></pre>
<h3 id="expectedexception-rule">ExpectedException Rule</h3>
<p>Alternatively, use the <code>ExpectedException</code> rule. This rule lets you indicate not only what exception you are expecting, but also the exception message you are expecting:</p>
<pre><code class="lang-java"><span class="hljs-meta">@Rule</span>
<span class="hljs-keyword">public</span> ExpectedException thrown = ExpectedException.none();

<span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">shouldTestExceptionMessage</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IndexOutOfBoundsException </span>{
    List&lt;Object&gt; list = <span class="hljs-keyword">new</span> ArrayList&lt;Object&gt;();

    thrown.expect(IndexOutOfBoundsException.class);
    thrown.expectMessage(<span class="hljs-string">&quot;Index: 0, Size: 0&quot;</span>);
    list.get(<span class="hljs-number">0</span>); <span class="hljs-comment">// execution will never get past this line</span>
}
</code></pre>
<p>The expectMessage also lets you use Matchers, which gives you a bit more flexibility in your tests. An example:</p>
<pre><code class="lang-java">thrown.expectMessage(CoreMatchers.containsString(<span class="hljs-string">&quot;Size: 0&quot;</span>));
</code></pre>
<p>Moreover, you can use Matchers to inspect the Exception, useful if it has embedded state you wish to verify.  For example</p>
<pre><code class="lang-java"><span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> org.hamcrest.Matchers.hasProperty;
<span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> org.hamcrest.Matchers.is;
<span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> org.hamcrest.Matchers.startsWith;

<span class="hljs-keyword">import</span> javax.ws.rs.NotFoundException;
<span class="hljs-keyword">import</span> javax.ws.rs.core.Response;
<span class="hljs-keyword">import</span> javax.ws.rs.core.Response.Status;

<span class="hljs-keyword">import</span> org.junit.Rule;
<span class="hljs-keyword">import</span> org.junit.Test;
<span class="hljs-keyword">import</span> org.junit.rules.ExpectedException;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestExy</span> </span>{
    <span class="hljs-meta">@Rule</span>
    <span class="hljs-keyword">public</span> ExpectedException thrown = ExpectedException.none();

    <span class="hljs-meta">@Test</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">shouldThrow</span><span class="hljs-params">()</span> </span>{
        TestThing testThing = <span class="hljs-keyword">new</span> TestThing();
        thrown.expect(NotFoundException.class);
        thrown.expectMessage(startsWith(<span class="hljs-string">&quot;some Message&quot;</span>));
        thrown.expect(hasProperty(<span class="hljs-string">&quot;response&quot;</span>, hasProperty(<span class="hljs-string">&quot;status&quot;</span>, is(<span class="hljs-number">404</span>))));
        testThing.chuck();
    }

    <span class="hljs-keyword">private</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestThing</span> </span>{
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">chuck</span><span class="hljs-params">()</span> </span>{
            Response response = Response.status(Status.NOT_FOUND).entity(<span class="hljs-string">&quot;Resource not found&quot;</span>).build();
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> NotFoundException(<span class="hljs-string">&quot;some Message&quot;</span>, response);
        }
    }
}
</code></pre>
<p>For an expanded discussion of the <code>ExpectedException</code> rule, see this <a href="http://baddotrobot.com/blog/2012/03/27/expecting-exception-with-junit-rule/index.html" target="_blank">blog post</a>.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="Test-Execution-Order.html" class="navigation navigation-prev " aria-label="Previous page: Test Execution Order">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="Matchers-and-assertThat.html" class="navigation navigation-next " aria-label="Next page: Matchers and assertThat">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Exception Testing","level":"2.5","depth":1,"next":{"title":"Matchers and assertThat","level":"2.6","depth":1,"path":"Matchers-and-assertThat.md","ref":"Matchers-and-assertThat.md","articles":[]},"previous":{"title":"Test Execution Order","level":"2.4","depth":1,"path":"Test-Execution-Order.md","ref":"Test-Execution-Order.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"Exception-Testing.md","mtime":"2018-07-25T18:16:39.429Z","type":"markdown"},"gitbook":{"version":"3.2.2","time":"2018-07-25T19:06:52.738Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

