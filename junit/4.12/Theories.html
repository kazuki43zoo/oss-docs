
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Theories Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.2">
        
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="Test-Fixtures.html" />
    
    
    <link rel="prev" href="Rules.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="Download-and-Install.html">
            
                <a href="Download-and-Install.html">
            
                    
                    Download and Install
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="Getting-Started.html">
            
                <a href="Getting-Started.html">
            
                    
                    Getting Started
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="Maintainer-Documentation.html">
            
                <a href="Maintainer-Documentation.html">
            
                    
                    Maintainer Documentation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="Deprecation-Policy.html">
            
                <a href="Deprecation-Policy.html">
            
                    
                    Deprecation Policy
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="I-want-to-help!.html">
            
                <a href="I-want-to-help!.html">
            
                    
                    I want to help!
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">JUnit Usage and Idioms</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="Assertions.html">
            
                <a href="Assertions.html">
            
                    
                    Assertions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="Test-Runners.html">
            
                <a href="Test-Runners.html">
            
                    
                    Test Runners
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="Aggregating-tests-in-Suites.html">
            
                <a href="Aggregating-tests-in-Suites.html">
            
                    
                    Aggregating tests in Suites
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="Test-Execution-Order.html">
            
                <a href="Test-Execution-Order.html">
            
                    
                    Test Execution Order
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.5" data-path="Exception-Testing.html">
            
                <a href="Exception-Testing.html">
            
                    
                    Exception Testing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.6" data-path="Matchers-and-assertThat.html">
            
                <a href="Matchers-and-assertThat.html">
            
                    
                    Matchers and assertThat
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.7" data-path="Ignoring-Tests.html">
            
                <a href="Ignoring-Tests.html">
            
                    
                    Ignoring Tests
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.8" data-path="Timeout-for-Tests.html">
            
                <a href="Timeout-for-Tests.html">
            
                    
                    Timeout for Tests
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.9" data-path="Parameterized-Tests.html">
            
                <a href="Parameterized-Tests.html">
            
                    
                    Parameterized Tests
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.10" data-path="Assumptions-with-Assume.html">
            
                <a href="Assumptions-with-Assume.html">
            
                    
                    Assumptions with Assume
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.11" data-path="Rules.html">
            
                <a href="Rules.html">
            
                    
                    Rules
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="2.12" data-path="Theories.html">
            
                <a href="Theories.html">
            
                    
                    Theories
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.13" data-path="Test-Fixtures.html">
            
                <a href="Test-Fixtures.html">
            
                    
                    Test Fixtures
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.14" data-path="Categories.html">
            
                <a href="Categories.html">
            
                    
                    Categories
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.15" data-path="Use-with-Maven.html">
            
                <a href="Use-with-Maven.html">
            
                    
                    Use with Maven
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.16" data-path="Use-with-Gradle.html">
            
                <a href="Use-with-Gradle.html">
            
                    
                    Use with Gradle
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.17" data-path="Multithreaded-code-and-Concurrency.html">
            
                <a href="Multithreaded-code-and-Concurrency.html">
            
                    
                    Multithreaded code and Concurrency
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.18" data-path="Java-contract-test-helpers.html">
            
                <a href="Java-contract-test-helpers.html">
            
                    
                    Java contract test helpers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.19" data-path="Continuous-Testing.html">
            
                <a href="Continuous-Testing.html">
            
                    
                    Continuous Testing
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Third-party extensions</li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="Custom-Runners.html">
            
                <a href="Custom-Runners.html">
            
                    
                    Custom Runners
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >Theories</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <p>More flexible and expressive assertions, combined with the ability to state assumptions clearly, lead to a new kind of statement of intent, which we call a &quot;Theory&quot;. A test captures the intended behavior in one particular scenario. A theory captures some aspect of the intended behavior in possibly infinite numbers of potential scenarios. For example:</p>
<pre><code class="lang-java"><span class="hljs-meta">@RunWith</span>(Theories.class)
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserTest</span> </span>{
    <span class="hljs-meta">@DataPoint</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String GOOD_USERNAME = <span class="hljs-string">&quot;optimus&quot;</span>;
    <span class="hljs-meta">@DataPoint</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String USERNAME_WITH_SLASH = <span class="hljs-string">&quot;optimus/prime&quot;</span>;

    <span class="hljs-meta">@Theory</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">filenameIncludesUsername</span><span class="hljs-params">(String username)</span> </span>{
        assumeThat(username, not(containsString(<span class="hljs-string">&quot;/&quot;</span>)));
        assertThat(<span class="hljs-keyword">new</span> User(username).configFileName(), containsString(username));
    }
}
</code></pre>
<p>This makes it clear that the user&apos;s username should be included in the config file name, only if it doesn&apos;t contain a slash. Another test or theory might define what happens when a username does contain a slash.</p>
<p>UserTest will attempt to run filenameIncludesUsername on every compatible DataPoint defined in the class. If any of the assumptions fail, the data point is silently ignored. If all of the assumptions pass, but an assertion fails, the test fails.</p>
<p>The support for Theories has been absorbed from the Popper project, and more complete documentation can be found from that projects documentation archived here: <a href="http://web.archive.org/web/20071012143326/popper.tigris.org/tutorial.html" target="_blank">http://web.archive.org/web/20071012143326/popper.tigris.org/tutorial.html</a>
(also reproduced below).</p>
<p>A paper written on theories is here <a href="http://web.archive.org/web/20110608210825/http://shareandenjoy.saff.net/tdd-specifications.pdf" target="_blank">http://web.archive.org/web/20110608210825/http://shareandenjoy.saff.net/tdd-specifications.pdf</a></p>
<p>Defining general statements in this way can jog the developer&apos;s memory about other potential data points and tests, also allows automated tools to search for new, unexpected data points that expose bugs.</p>
<h2 id="documentation-from-defunct-popper-project">Documentation from defunct Popper project</h2>
<p>Popper extends JUnit to allow you to specify theories, general statements about your code&apos;s behavior that may be true over infinite sets of input values. For a detailed description of why you might want to do this, see our paper. If you just want to try it out and get started, here&apos;s the place.</p>
<p>First, if you haven&apos;t already, download the latest Popper. Popper should work with any version of JUnit between 4.0 and 4.3, and Java 5 and above.</p>
<p>Put Popper and JUnit on your classpath.</p>
<p>Now, let&apos;s start with a simple test class for a type that performs arithmetic on numbers of dollars:</p>
<pre><code class="lang-java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DollarTest</span> </span>{
    <span class="hljs-meta">@Test</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">multiplyByAnInteger</span><span class="hljs-params">()</span> </span>{
        assertThat(<span class="hljs-keyword">new</span> Dollar(<span class="hljs-number">5</span>).times(<span class="hljs-number">2</span>).getAmount(), is(<span class="hljs-number">10</span>));
    }
}
</code></pre>
<p>This demonstrates the syntax of JUnit 4 tests written with Popper&apos;s <code>assertThat</code> syntax, which is lovingly stolen from Hamcrest. If the <code>@Test</code> syntax is new to you, you may want to quickly get up to speed on JUnit 4. If the convenient <code>assertThat</code> assertion syntax is new, you may want to get up to speed on Hamcrest. (You&apos;ll need to add some imports. Eclipse can take care of most of them for you, but here&apos;s the whole list)</p>
<p>Go ahead and get the test above to pass. I especially suggest that you cheat by always returning 10 from getAmount.</p>
<p>Now, we&apos;ll see how Popper extends JUnit to allow the specification and verification of general properties. First, give Dollar test a new superclass:</p>
<pre><code class="lang-java"><span class="hljs-keyword">import</span> net.saff.theories.api.TheoryContainer;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DollarTest</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">TheoryContainer</span> </span>{
    <span class="hljs-comment">// ...</span>
    <span class="hljs-comment">// Next, add a theory to the test class:</span>

    <span class="hljs-meta">@Theory</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">multiplyIsInverseOfDivide</span><span class="hljs-params">(<span class="hljs-keyword">int</span> amount, <span class="hljs-keyword">int</span> m)</span> </span>{
        assumeThat(m, not(<span class="hljs-number">0</span>));
        assertThat(<span class="hljs-keyword">new</span> Dollar(amount).times(m).divideBy(m).getAmount(), is(amount));
    }
</code></pre>
<p>You&apos;ll have to add a divideBy method to Dollar in order to get the class to compile. This theory expresses a general truth about currency multiplication and division: one is the inverse of the other. By adding two parameters to the method, and adding the assumption that m is not zero, you&apos;ve specified that this theory should hold true for any value of amount and all non-zero values of m.</p>
<p>Go ahead and run the tests, and you&apos;ll notice two things:</p>
<ul>
<li>Your multiplyByAnInteger test passes as before.</li>
<li>multiplyIsInverseOfDivide fails, with the message &quot;Never found parameters that satisfied method.&quot;</li>
</ul>
<p>The Popper runner does not automatically provide potential values for a theory. It can take a long time between being able to assert a general principle, and actually making it work with any conceivable input. Because of this, Popper expects to only run theories on a set of accepted data points, which allows you to incrementally build up a set of inputs for which you know the theory passes, until you feel confident that the theory is universally true.</p>
<p>By default, Popper assumes that all public fields of a test class are accepted data points. For example, add the following constants to <code>DollarTest</code>:</p>
<pre><code class="lang-java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> TWO = <span class="hljs-number">2</span>;
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> FIVE = <span class="hljs-number">5</span>;
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> TEN = <span class="hljs-number">10</span>;
</code></pre>
<p>Now the theory will probably fail, telling you which inputs caused the failure. Fix your implementations of times and divideBy, and the theory should pass.</p>
<p>To customize how Popper finds accepted data points, you can use parameter suppliers. One parameter supplier comes with Popper by default, which allows you to specify inline a set of acceptable integer inputs to a theory:</p>
<pre><code class="lang-java"><span class="hljs-meta">@Theory</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">multiplyIsInverseOfDivideWithInlineDataPoints</span><span class="hljs-params">(
        @TestedOn(ints = {<span class="hljs-number">0</span>, <span class="hljs-number">5</span>, <span class="hljs-number">10</span>})</span> <span class="hljs-keyword">int</span> amount,
        @<span class="hljs-title">TestedOn</span><span class="hljs-params">(ints = {<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>})</span> <span class="hljs-keyword">int</span> m
) </span>{
    assumeThat(m, not(<span class="hljs-number">0</span>));
    assertThat(<span class="hljs-keyword">new</span> Dollar(amount).times(m).divideBy(m).getAmount(), is(amount));
}
</code></pre>
<p>This theory ignores the public fields of DollarTest, and tests with every combination of 0, 5, and 10 for amount, and 0, 1, and 2 for m. Notice that even though 0 is tried as a value for m, it does not trigger an arithmetic exception or failure: values that violate assumptions are quietly ignored.</p>
<p>You can extend Popper by providing your own parameter supplier. For example, here is a supplier for values between two integers, and an annotation that references it:</p>
<pre><code class="lang-java"><span class="hljs-meta">@Retention</span>(RetentionPolicy.RUNTIME)
<span class="hljs-meta">@ParametersSuppliedBy</span>(BetweenSupplier.class)
<span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> Between {
    <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">first</span><span class="hljs-params">()</span></span>;

    <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">last</span><span class="hljs-params">()</span></span>;
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BetweenSupplier</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ParameterSupplier</span> </span>{
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> List <span class="hljs-title">getValues</span><span class="hljs-params">(Object test, ParameterSignature sig)</span> </span>{
        Between annotation = (Between) sig.getSupplierAnnotation();

        ArrayList list = <span class="hljs-keyword">new</span> ArrayList();
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = annotation.first(); i &lt;= annotation.last(); i++)
            list.add(i);
        <span class="hljs-keyword">return</span> list;
    }
}
</code></pre>
<p>With this supplier defined, you can accept data points as ranges:</p>
<pre><code class="lang-java"><span class="hljs-meta">@Theory</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">multiplyIsInverseOfDivideWithInlineDataPoints</span><span class="hljs-params">(
        @Between(first = <span class="hljs-number">-100</span>, last = <span class="hljs-number">100</span>)</span> <span class="hljs-keyword">int</span> amount,
        @<span class="hljs-title">Between</span><span class="hljs-params">(first = <span class="hljs-number">-100</span>, last = <span class="hljs-number">100</span>)</span> <span class="hljs-keyword">int</span> m
) </span>{
    assumeThat(m, not(<span class="hljs-number">0</span>));
    assertThat(<span class="hljs-keyword">new</span> Dollar(amount).times(m).divideBy(m).getAmount(), is(amount));
}
</code></pre>
<p>The paper refers to a capacity for automatically generating stubs to pass as object parameters to theories.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="Rules.html" class="navigation navigation-prev " aria-label="Previous page: Rules">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="Test-Fixtures.html" class="navigation navigation-next " aria-label="Next page: Test Fixtures">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Theories","level":"2.12","depth":1,"next":{"title":"Test Fixtures","level":"2.13","depth":1,"path":"Test-Fixtures.md","ref":"Test-Fixtures.md","articles":[]},"previous":{"title":"Rules","level":"2.11","depth":1,"path":"Rules.md","ref":"Rules.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"Theories.md","mtime":"2018-07-25T18:16:39.452Z","type":"markdown"},"gitbook":{"version":"3.2.2","time":"2018-07-25T19:06:52.738Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

