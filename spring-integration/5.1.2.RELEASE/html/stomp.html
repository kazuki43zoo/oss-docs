<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>31.&nbsp;STOMP Support</title><link rel="stylesheet" type="text/css" href="css/manual-multipage.css"><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><link rel="home" href="index.html" title="Spring Integration Reference Manual"><link rel="up" href="spring-integration-endpoints.html" title="Part&nbsp;V.&nbsp;Integration Endpoints"><link rel="prev" href="sftp.html" title="30.&nbsp;SFTP Adapters"><link rel="next" href="stream.html" title="32.&nbsp;Stream Support"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">31.&nbsp;STOMP Support</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="sftp.html">Prev</a>&nbsp;</td><th width="60%" align="center">Part&nbsp;V.&nbsp;Integration Endpoints</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="stream.html">Next</a></td></tr></table><hr></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a name="stomp" href="#stomp"></a>31.&nbsp;STOMP Support</h2></div></div></div>

<p>Spring Integration version 4.2 introduced STOMP (Simple Text Orientated Messaging Protocol) client support.
It is based on the architecture, infrastructure, and API from the Spring Framework&#8217;s messaging module, stomp package.
Spring Integration uses many of Spring STOMP components (such as <code class="literal">StompSession</code> and <code class="literal">StompClientSupport</code>).
For more information, see the <a class="ulink" href="http://docs.spring.io/spring/docs/current/spring-framework-reference/html/websocket.html#websocket-stomp-client" target="_top">Spring Framework STOMP Support</a> chapter in the Spring Framework reference manual.</p>
<p>You need to include this dependency into your project:</p>
<div class="informalexample">
<p>
<b>Maven.&nbsp;</b>

</p><pre class="programlisting"><span class="hl-tag">&lt;dependency&gt;</span>
    <span class="hl-tag">&lt;groupId&gt;</span>org.springframework.integration<span class="hl-tag">&lt;/groupId&gt;</span>
    <span class="hl-tag">&lt;artifactId&gt;</span>spring-integration-stomp<span class="hl-tag">&lt;/artifactId&gt;</span>
    <span class="hl-tag">&lt;version&gt;</span>5.1.2.RELEASE<span class="hl-tag">&lt;/version&gt;</span>
<span class="hl-tag">&lt;/dependency&gt;</span></pre><p>

</p>
<p>
<b>Gradle.&nbsp;</b>

</p><pre class="programlisting">compile <span class="hl-string">"org.springframework.integration:spring-integration-stomp:5.1.2.RELEASE"</span></pre><p>

</p>
</div>
<p>For server side components you need to add a <code class="literal">org.springframework:spring-websocket</code> and/or <code class="literal">io.projectreactor.netty:reactor-netty</code> dependencies.</p>
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="stomp-overview" href="#stomp-overview"></a>31.1&nbsp;Overview</h2></div></div></div>

<p>To configure STOMP, you should start with the STOMP client object.
The Spring Framework provides the following implementations:</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<code class="literal">WebSocketStompClient</code>: Built on the Spring WebSocket API with support for standard JSR-356 WebSocket, Jetty 9, and SockJS for HTTP-based WebSocket emulation with SockJS Client.
</li><li class="listitem">
<code class="literal">ReactorNettyTcpStompClient</code>: Built on <code class="literal">ReactorNettyTcpClient</code> from the <code class="literal">reactor-netty</code> project.
</li></ul></div>
<p>You can provide any other <code class="literal">StompClientSupport</code> implementation.
See the <a class="ulink" href="https://docs.spring.io/spring-integration/api/" target="_top">Javadoc</a> of those classes.</p>
<p>The <code class="literal">StompClientSupport</code> class is designed as a <span class="emphasis"><em>factory</em></span> to produce a <code class="literal">StompSession</code> for the provided <code class="literal">StompSessionHandler</code> and all the remaining work is done through the <span class="emphasis"><em>callbacks</em></span> to that <code class="literal">StompSessionHandler</code> and <code class="literal">StompSession</code> abstraction.
With the Spring Integration <span class="emphasis"><em>adapter</em></span> abstraction, we need to provide some managed shared object to represent our application as a STOMP client with its unique session.
For this purpose, Spring Integration provides the <code class="literal">StompSessionManager</code> abstraction to manage the <span class="emphasis"><em>single</em></span> <code class="literal">StompSession</code> between any provided <code class="literal">StompSessionHandler</code>.
This allows the use of <span class="emphasis"><em>inbound</em></span> or <span class="emphasis"><em>outbound</em></span> channel adapters (or both) for the particular STOMP Broker.
See <code class="literal">StompSessionManager</code> (and its implementations) JavaDocs for more information.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="stomp-inbound-adapter" href="#stomp-inbound-adapter"></a>31.2&nbsp;STOMP Inbound Channel Adapter</h2></div></div></div>

<p>The <code class="literal">StompInboundChannelAdapter</code> is a one-stop <code class="literal">MessageProducer</code> component that subscribes your Spring Integration application to the provided STOMP destinations and receives messages from them (converted from the STOMP frames by using the provided <code class="literal">MessageConverter</code> on the connected <code class="literal">StompSession</code>).
You can change the destinations (and therefore STOMP subscriptions) at runtime by using appropriate <code class="literal">@ManagedOperation</code> annotations on the <code class="literal">StompInboundChannelAdapter</code>.</p>
<p>For more configuration options, see <a class="xref" href="stomp.html#stomp-namespace" title="31.7&nbsp;STOMP Namespace Support">Section&nbsp;31.7, &#8220;STOMP Namespace Support&#8221;</a> and the <code class="literal">StompInboundChannelAdapter</code> <a class="ulink" href="https://docs.spring.io/spring-integration/api/org/springframework/integration/stomp/inbound/StompInboundChannelAdapter.html" target="_top">Javadoc</a>.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="stomp-outbound-adapter" href="#stomp-outbound-adapter"></a>31.3&nbsp;STOMP Outbound Channel Adapter</h2></div></div></div>

<p>The <code class="literal">StompMessageHandler</code> is the <code class="literal">MessageHandler</code> for the <code class="literal">&lt;int-stomp:outbound-channel-adapter&gt;</code> and is used to send the outgoing <code class="literal">Message&lt;?&gt;</code> instances to the STOMP <code class="literal">destination</code> (pre-configured or determined at runtime with a SpEL expression) through the <code class="literal">StompSession</code> (which is provided by the shared <code class="literal">StompSessionManager</code>).</p>
<p>For more configuration options see <a class="xref" href="stomp.html#stomp-namespace" title="31.7&nbsp;STOMP Namespace Support">Section&nbsp;31.7, &#8220;STOMP Namespace Support&#8221;</a> and the <code class="literal">StompMessageHandler</code> <a class="ulink" href="https://docs.spring.io/spring-integration/api/org/springframework/integration/stomp/outbound/StompMessageHandler.html" target="_top">Javadoc</a>.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="stomp-headers" href="#stomp-headers"></a>31.4&nbsp;STOMP Headers Mapping</h2></div></div></div>

<p>The STOMP protocol provides headers as part of its frame.
The entire structure of the STOMP frame has the following format:</p>
<div class="informalexample">
<pre class="screen">....
COMMAND
header1:value1
header2:value2

Body^@
....</pre>
</div>
<p>Spring Framework provides <code class="literal">StompHeaders</code> to represent these headers.
See the <a class="ulink" href="https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/messaging/simp/stomp/StompHeaders.html" target="_top">Javadoc</a> for more details.
STOMP frames are converted to and from <code class="literal">Message&lt;?&gt;</code> instances and these headers are mapped to and from <code class="literal">MessageHeaders</code> instances.
Spring Integration provides a default <code class="literal">HeaderMapper</code> implementation for the STOMP adapters.
The implementation is <code class="literal">StompHeaderMapper</code>.
It provides <code class="literal">fromHeaders()</code> and <code class="literal">toHeaders()</code> operations for the inbound and outbound adapters, respectively.</p>
<p>As with many other Spring Integration modules, the <code class="literal">IntegrationStompHeaders</code> class has been introduced to map standard STOMP headers to <code class="literal">MessageHeaders</code>, with <code class="literal">stomp_</code> as the header name prefix.
In addition, all <code class="literal">MessageHeaders</code> instances with that prefix are mapped to the <code class="literal">StompHeaders</code> when sending to a destination.</p>
<p>For more information, see the <a class="ulink" href="https://docs.spring.io/spring-integration/api/" target="_top">Javadoc</a> for those classes and the <code class="literal">mapped-headers</code> attribute description in the <a class="xref" href="stomp.html#stomp-namespace" title="31.7&nbsp;STOMP Namespace Support">Section&nbsp;31.7, &#8220;STOMP Namespace Support&#8221;</a>.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="stomp-events" href="#stomp-events"></a>31.5&nbsp;STOMP Integration Events</h2></div></div></div>

<p>Many STOMP operations are asynchronous, including error handling.
For example, STOMP has a <code class="literal">RECEIPT</code> server frame that it returns when a client frame has requested one by adding the <code class="literal">RECEIPT</code> header.
To provide access to these asynchronous events, Spring Integration emits <code class="literal">StompIntegrationEvent</code> instances, which you can obtain by implementing an <code class="literal">ApplicationListener</code> or by using an <code class="literal">&lt;int-event:inbound-channel-adapter&gt;</code> (see <a class="xref" href="applicationevent.html#appevent-inbound" title="15.1&nbsp;Receiving Spring Application Events">Section&nbsp;15.1, &#8220;Receiving Spring Application Events&#8221;</a>).</p>
<p>Specifically, a <code class="literal">StompExceptionEvent</code> is emitted from the <code class="literal">AbstractStompSessionManager</code> when a <code class="literal">stompSessionListenableFuture</code> receives <code class="literal">onFailure()</code> due to failure to connect to STOMP broker.
Another example is the <code class="literal">StompMessageHandler</code>.
It processes <code class="literal">ERROR</code> STOMP frames, which are server responses to improper (unaccepted) messages sent by this <code class="literal">StompMessageHandler</code>.</p>
<p>The <code class="literal">StompMessageHandler</code> emits <code class="literal">StompReceiptEvent</code> as a part of <code class="literal">StompSession.Receiptable</code> callbacks in the asynchronous answers for the messages sent to the <code class="literal">StompSession</code>.
The <code class="literal">StompReceiptEvent</code> can be positive or negative, depending on whether or not the <code class="literal">RECEIPT</code> frame was received from the server within the <code class="literal">receiptTimeLimit</code> period, which you can configure on the <code class="literal">StompClientSupport</code> instance.
It defaults to <code class="literal">15 * 1000</code> (in milliseconds, so 15 seconds).</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
<p>The <code class="literal">StompSession.Receiptable</code> callbacks are added only if the <code class="literal">RECEIPT</code> STOMP header of the message to send is not <code class="literal">null</code>.
You can enable automatic <code class="literal">RECEIPT</code> header generation on the <code class="literal">StompSession</code> through its <code class="literal">autoReceipt</code> option and on the <code class="literal">StompSessionManager</code> respectively.</p>
</td></tr></table></div>
<p>See <a class="xref" href="stomp.html#stomp-java-config" title="31.6&nbsp;STOMP Adapters Java Configuration">Section&nbsp;31.6, &#8220;STOMP Adapters Java Configuration&#8221;</a> for more information how to configure Spring Integration to accept those <code class="literal">ApplicationEvent</code> instances.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="stomp-java-config" href="#stomp-java-config"></a>31.6&nbsp;STOMP Adapters Java Configuration</h2></div></div></div>

<p>The following example shows a comprehensive Java configuration for STOMP adapters:</p>
<div class="informalexample">
<pre class="programlisting"><em><span class="hl-annotation" style="color: gray">@Configuration</span></em>
<em><span class="hl-annotation" style="color: gray">@EnableIntegration</span></em>
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> StompConfiguration {

    <em><span class="hl-annotation" style="color: gray">@Bean</span></em>
    <span class="hl-keyword">public</span> ReactorNettyTcpStompClient stompClient() {
        ReactorNettyTcpStompClient stompClient = <span class="hl-keyword">new</span> ReactorNettyTcpStompClient(<span class="hl-string">"127.0.0.1"</span>, <span class="hl-number">61613</span>);
        stompClient.setMessageConverter(<span class="hl-keyword">new</span> PassThruMessageConverter());
        ThreadPoolTaskScheduler taskScheduler = <span class="hl-keyword">new</span> ThreadPoolTaskScheduler();
        taskScheduler.afterPropertiesSet();
        stompClient.setTaskScheduler(taskScheduler);
        stompClient.setReceiptTimeLimit(<span class="hl-number">5000</span>);
        <span class="hl-keyword">return</span> stompClient;
    }

    <em><span class="hl-annotation" style="color: gray">@Bean</span></em>
    <span class="hl-keyword">public</span> StompSessionManager stompSessionManager() {
        ReactorNettyTcpStompSessionManager stompSessionManager = <span class="hl-keyword">new</span> ReactorNettyTcpStompSessionManager(stompClient());
        stompSessionManager.setAutoReceipt(true);
        <span class="hl-keyword">return</span> stompSessionManager;
    }

    <em><span class="hl-annotation" style="color: gray">@Bean</span></em>
    <span class="hl-keyword">public</span> PollableChannel stompInputChannel() {
        <span class="hl-keyword">return</span> <span class="hl-keyword">new</span> QueueChannel();
    }

    <em><span class="hl-annotation" style="color: gray">@Bean</span></em>
    <span class="hl-keyword">public</span> StompInboundChannelAdapter stompInboundChannelAdapter() {
        StompInboundChannelAdapter adapter =
        		<span class="hl-keyword">new</span> StompInboundChannelAdapter(stompSessionManager(), <span class="hl-string">"/topic/myTopic"</span>);
        adapter.setOutputChannel(stompInputChannel());
        <span class="hl-keyword">return</span> adapter;
    }

    <em><span class="hl-annotation" style="color: gray">@Bean</span></em>
    <em><span class="hl-annotation" style="color: gray">@ServiceActivator(inputChannel = "stompOutputChannel")</span></em>
    <span class="hl-keyword">public</span> MessageHandler stompMessageHandler() {
        StompMessageHandler handler = <span class="hl-keyword">new</span> StompMessageHandler(stompSessionManager());
        handler.setDestination(<span class="hl-string">"/topic/myTopic"</span>);
        <span class="hl-keyword">return</span> handler;
    }

    <em><span class="hl-annotation" style="color: gray">@Bean</span></em>
    <span class="hl-keyword">public</span> PollableChannel stompEvents() {
        <span class="hl-keyword">return</span> <span class="hl-keyword">new</span> QueueChannel();
    }

    <em><span class="hl-annotation" style="color: gray">@Bean</span></em>
    <span class="hl-keyword">public</span> ApplicationListener&lt;ApplicationEvent&gt; stompEventListener() {
        ApplicationEventListeningMessageProducer producer = <span class="hl-keyword">new</span> ApplicationEventListeningMessageProducer();
        producer.setEventTypes(StompIntegrationEvent.<span class="hl-keyword">class</span>);
        producer.setOutputChannel(stompEvents());
        <span class="hl-keyword">return</span> producer;
    }

}</pre>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="stomp-namespace" href="#stomp-namespace"></a>31.7&nbsp;STOMP Namespace Support</h2></div></div></div>

<p>The Spring Integration STOMP namespace implements the inbound and outbound channel adapter components.
To include it in your configuration, provide the following namespace declaration in your application context configuration file:</p>
<pre class="programlisting"><span class="hl-directive" style="color: maroon">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="hl-tag">&lt;beans</span> <span class="hl-attribute">xmlns</span>=<span class="hl-value">"http://www.springframework.org/schema/beans"</span>
  <span class="hl-attribute">xmlns:xsi</span>=<span class="hl-value">"http://www.w3.org/2001/XMLSchema-instance"</span>
  <span class="hl-attribute">xmlns:int</span>=<span class="hl-value">"http://www.springframework.org/schema/integration"</span>
  <span class="hl-attribute">xmlns:int-stomp</span>=<span class="hl-value">"http://www.springframework.org/schema/integration/stomp"</span>
  <span class="hl-attribute">xsi:schemaLocation</span>=<span class="hl-value">"
    http://www.springframework.org/schema/beans
    http://www.springframework.org/schema/beans/spring-beans.xsd
    http://www.springframework.org/schema/integration
    http://www.springframework.org/schema/integration/spring-integration.xsd
    http://www.springframework.org/schema/integration/stomp
    http://www.springframework.org/schema/integration/stomp/spring-integration-stomp.xsd"</span><span class="hl-tag">&gt;</span>
    ...
<span class="hl-tag">&lt;/beans&gt;</span></pre>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="stomp-outbound-channel-adapter" href="#stomp-outbound-channel-adapter"></a>31.7.1&nbsp;Understanding the <code class="literal">&lt;int-stomp:outbound-channel-adapter&gt;</code> Element</h3></div></div></div>

<p>The following listing shows the available attributes for the STOMP outbound channel adapter:</p>
<div class="informalexample">
<pre class="programlisting"><span class="hl-tag">&lt;int-stomp:outbound-channel-adapter</span>
                           <span class="hl-attribute">id</span>=<span class="hl-value">""</span>                      <a name="CO48-1" href="#CO48-1"></a><span><img src="images/callouts/1.png" alt="1" border="0"></span>
                           channel=""                 <a name="CO48-2" href="#CO48-2"></a><span><img src="images/callouts/2.png" alt="2" border="0"></span>
                           stomp-session-manager=""   <a name="CO48-3" href="#CO48-3"></a><span><img src="images/callouts/3.png" alt="3" border="0"></span>
                           header-mapper=""           <a name="CO48-4" href="#CO48-4"></a><span><img src="images/callouts/4.png" alt="4" border="0"></span>
                           mapped-headers=""          <a name="CO48-5" href="#CO48-5"></a><span><img src="images/callouts/5.png" alt="5" border="0"></span>
                           destination=""             <a name="CO48-6" href="#CO48-6"></a><span><img src="images/callouts/6.png" alt="6" border="0"></span>
                           destination-expression=""  <a name="CO48-7" href="#CO48-7"></a><span><img src="images/callouts/7.png" alt="7" border="0"></span>
                           auto-startup=""            <a name="CO48-8" href="#CO48-8"></a><span><img src="images/callouts/8.png" alt="8" border="0"></span>
                           phase=""/&gt;                 <a name="CO48-9" href="#CO48-9"></a><span><img src="images/callouts/9.png" alt="9" border="0"></span></pre>
<div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO48-1"><span><img src="images/callouts/1.png" alt="1" border="0"></span></a> </p></td><td valign="top" align="left">
<p>The component bean name.
The <code class="literal">MessageHandler</code> is registered with a bean alias of <code class="literal">id</code> plus <code class="literal">.handler</code>.
If you do not set the <code class="literal">channel</code> attribute, a <code class="literal">DirectChannel</code> is created and registered in the application context with the value of this <code class="literal">id</code> attribute as the bean name.
In this case, the endpoint is registered with a bean name <code class="literal">id</code> plus <code class="literal">.adapter</code>.</p>
</td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO48-2"><span><img src="images/callouts/2.png" alt="2" border="0"></span></a> </p></td><td valign="top" align="left">
<p>Identifies the channel attached to this adapter if <code class="literal">id</code> is present.
See <code class="literal">id</code>.
Optional.</p>
</td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO48-3"><span><img src="images/callouts/3.png" alt="3" border="0"></span></a> </p></td><td valign="top" align="left">
<p>Reference to a <code class="literal">StompSessionManager</code> bean, which encapsulates the low-level connection and <code class="literal">StompSession</code> handling operations.
Required.</p>
</td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO48-4"><span><img src="images/callouts/4.png" alt="4" border="0"></span></a> </p></td><td valign="top" align="left">
<p>Reference to a bean that implements <code class="literal">HeaderMapper&lt;StompHeaders&gt;</code>, which maps Spring Integration <code class="literal">MessageHeaders</code> to and from
STOMP frame headers.
It is mutually exclusive with <code class="literal">mapped-headers</code>.
It defaults to <code class="literal">StompHeaderMapper</code>.</p>
</td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO48-5"><span><img src="images/callouts/5.png" alt="5" border="0"></span></a> </p></td><td valign="top" align="left">
<p>Comma-separated list of names of STOMP Headers to be mapped to the STOMP frame headers.
It can be provided only if the <code class="literal">header-mapper</code> reference is not set.
The values in this list can also be simple patterns to be matched against the header names (such as <code class="literal">myheader*</code> or <code class="literal">*myheader</code>).
A special token (<code class="literal">STOMP_OUTBOUND_HEADERS</code>) represents all the standard STOMP headers (content-length, receipt, heart-beat, and so on).
They are included by default.
If you want to add your own headers and want the standard headers to also be mapped, you must include this token or provide your own <code class="literal">HeaderMapper</code> implementation by using <code class="literal">header-mapper</code>.</p>
</td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO48-6"><span><img src="images/callouts/6.png" alt="6" border="0"></span></a> </p></td><td valign="top" align="left">
<p>Name of the destination to which STOMP Messages are sent.
It is mutually exclusive with the <code class="literal">destination-expression</code>.</p>
</td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO48-7"><span><img src="images/callouts/7.png" alt="7" border="0"></span></a> </p></td><td valign="top" align="left">
<p>A SpEL expression to be evaluated at runtime against each Spring Integration <code class="literal">Message</code> as the root object.
It is mutually exclusive with the <code class="literal">destination</code>.</p>
</td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO48-8"><span><img src="images/callouts/8.png" alt="8" border="0"></span></a> </p></td><td valign="top" align="left">
<p>Boolean value indicating whether this endpoint should start automatically.
It defaults to <code class="literal">true</code>.</p>
</td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO48-9"><span><img src="images/callouts/9.png" alt="9" border="0"></span></a> </p></td><td valign="top" align="left">
<p>The lifecycle phase within which this endpoint should start and stop.
The lower the value, the earlier this endpoint starts and the later it stops.
The default is <code class="literal">Integer.MIN_VALUE</code>.
Values can be negative.
See <a class="ulink" href="https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/context/SmartLifecycle.html" target="_top"><code class="literal">SmartLifeCycle</code></a>.</p>
</td></tr></table></div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_understanding_the_literal_int_stomp_inbound_channel_adapter_literal_element" href="#_understanding_the_literal_int_stomp_inbound_channel_adapter_literal_element"></a>31.7.2&nbsp;Understanding the <code class="literal">&lt;int-stomp:inbound-channel-adapter&gt;</code> Element</h3></div></div></div>

<p>The following listing shows the available attributes for the STOMP inbound channel adapter:</p>
<div class="informalexample">
<pre class="programlisting"><span class="hl-tag">&lt;int-stomp:inbound-channel-adapter</span>
                           <span class="hl-attribute">id</span>=<span class="hl-value">""</span>                     <a name="CO49-1" href="#CO49-1"></a><span><img src="images/callouts/1.png" alt="1" border="0"></span>
                           channel=""                <a name="CO49-2" href="#CO49-2"></a><span><img src="images/callouts/2.png" alt="2" border="0"></span>
                           error-channel=""          <a name="CO49-3" href="#CO49-3"></a><span><img src="images/callouts/3.png" alt="3" border="0"></span>
                           stomp-session-manager=""  <a name="CO49-4" href="#CO49-4"></a><span><img src="images/callouts/4.png" alt="4" border="0"></span>
                           header-mapper=""          <a name="CO49-5" href="#CO49-5"></a><span><img src="images/callouts/5.png" alt="5" border="0"></span>
                           mapped-headers=""         <a name="CO49-6" href="#CO49-6"></a><span><img src="images/callouts/6.png" alt="6" border="0"></span>
                           destinations=""           <a name="CO49-7" href="#CO49-7"></a><span><img src="images/callouts/7.png" alt="7" border="0"></span>
                           send-timeout=""           <a name="CO49-8" href="#CO49-8"></a><span><img src="images/callouts/8.png" alt="8" border="0"></span>
                           payload-type=""           <a name="CO49-9" href="#CO49-9"></a><span><img src="images/callouts/9.png" alt="9" border="0"></span>
                           auto-startup=""           <a name="CO49-10" href="#CO49-10"></a><span><img src="images/callouts/10.png" alt="10" border="0"></span>
                           phase=""/&gt;                <a name="CO49-11" href="#CO49-11"></a><span><img src="images/callouts/11.png" alt="11" border="0"></span></pre>
<div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO49-1"><span><img src="images/callouts/1.png" alt="1" border="0"></span></a> </p></td><td valign="top" align="left">
<p>The component bean name.
If you do not set the <code class="literal">channel</code> attribute, a <code class="literal">DirectChannel</code> is created and registered in the application context with the value of this <code class="literal">id</code> attribute as the bean name.
In this case, the endpoint is registered with the bean name <code class="literal">id</code> plus <code class="literal">.adapter</code>.</p>
</td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO49-2"><span><img src="images/callouts/2.png" alt="2" border="0"></span></a> </p></td><td valign="top" align="left">
<p>Identifies the channel attached to this adapter.</p>
</td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO49-3"><span><img src="images/callouts/3.png" alt="3" border="0"></span></a> </p></td><td valign="top" align="left">
<p>The <code class="literal">MessageChannel</code> bean reference to which <code class="literal">ErrorMessage</code> instances should be sent.</p>
</td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO49-4"><span><img src="images/callouts/4.png" alt="4" border="0"></span></a> </p></td><td valign="top" align="left">
<p>See the same option on the <a class="link" href="stomp.html#stomp-outbound-channel-adapter" title="31.7.1&nbsp;Understanding the <int-stomp:outbound-channel-adapter&gt; Element"><code class="literal">&lt;int-stomp:outbound-channel-adapter&gt;</code></a>.</p>
</td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO49-5"><span><img src="images/callouts/5.png" alt="5" border="0"></span></a> </p></td><td valign="top" align="left">
<p>Comma-separated list of names of STOMP Headers to be mapped from the STOMP frame headers.
You can only provide this if the <code class="literal">header-mapper</code> reference is not set.
The values in this list can also be simple patterns to be matched against the header names (for example, <code class="literal">myheader*</code> or <code class="literal">*myheader</code>).
A special token (<code class="literal">STOMP_INBOUND_HEADERS</code>) represents all the standard STOMP headers (content-length, receipt, heart-beat, and so on).
They are included by default.
If you want to add your own headers and want the standard headers to also be mapped, you must also include this token or provide your own <code class="literal">HeaderMapper</code> implementation using <code class="literal">header-mapper</code>.</p>
</td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO49-6"><span><img src="images/callouts/6.png" alt="6" border="0"></span></a> </p></td><td valign="top" align="left">
<p>See the same option on the <a class="link" href="stomp.html#stomp-outbound-channel-adapter" title="31.7.1&nbsp;Understanding the <int-stomp:outbound-channel-adapter&gt; Element"><code class="literal">&lt;int-stomp:outbound-channel-adapter&gt;</code></a>.</p>
</td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO49-7"><span><img src="images/callouts/7.png" alt="7" border="0"></span></a> </p></td><td valign="top" align="left">
<p>Comma-separated list of STOMP destination names to subscribe.
The list of destinations (and therefore subscriptions) can be modified at runtime through the <code class="literal">addDestination()</code> and <code class="literal">removeDestination()</code> <code class="literal">@ManagedOperation</code> annotations.</p>
</td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO49-8"><span><img src="images/callouts/8.png" alt="8" border="0"></span></a> </p></td><td valign="top" align="left">
<p>Maximum amount of time (in milliseconds) to wait when sending a message to the channel if the channel can block.
For example, a <code class="literal">QueueChannel</code> can block until space is available if its maximum capacity has been reached.</p>
</td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO49-9"><span><img src="images/callouts/9.png" alt="9" border="0"></span></a> </p></td><td valign="top" align="left">
<p>Fully qualified name of the Java type for the target <code class="literal">payload</code> to convert from the incoming STOMP frame.
It defaults to <code class="literal">String.class</code>.</p>
</td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO49-10"><span><img src="images/callouts/10.png" alt="10" border="0"></span></a> </p></td><td valign="top" align="left">
<p>See the same option on the <a class="link" href="stomp.html#stomp-outbound-channel-adapter" title="31.7.1&nbsp;Understanding the <int-stomp:outbound-channel-adapter&gt; Element"><code class="literal">&lt;int-stomp:outbound-channel-adapter&gt;</code></a>.</p>
</td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO49-11"><span><img src="images/callouts/11.png" alt="11" border="0"></span></a> </p></td><td valign="top" align="left">
<p>See the same option on the <a class="link" href="stomp.html#stomp-outbound-channel-adapter" title="31.7.1&nbsp;Understanding the <int-stomp:outbound-channel-adapter&gt; Element"><code class="literal">&lt;int-stomp:outbound-channel-adapter&gt;</code></a>.</p>
</td></tr></table></div>
</div>
</div>
</div>
</div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="sftp.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="spring-integration-endpoints.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="stream.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">30.&nbsp;SFTP Adapters&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;32.&nbsp;Stream Support</td></tr></table></div></body></html>